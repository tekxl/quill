/*! Quill Editor v0.20.0
 *  https://quilljs.com/
 *  Copyright (c) 2014, Jason Chen
 *  Copyright (c) 2013, salesforce.com
 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Quill=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(b){(function(){function e(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function f(a,b,c){if(b!==b)return i(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function g(a){return"function"==typeof a||!1}function h(a){return"string"==typeof a?a:null==a?"":a+""}function i(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function j(a){return!!a&&"object"==typeof a}function k(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]=yb,f[++e]=c);return f}function l(){}function m(){}function n(a){this.__wrapped__=a,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=Ic,this.__views__=null}function o(a){var b=a?a.length:0;for(this.data={hash:Cc(null),set:new yc};b--;)this.push(a[b])}function p(a,b){var c=a.data,d="string"==typeof b||Wa(b)?c.set.has(b):c.hash[b];return d?0:-1}function q(a){var b=this.data;"string"==typeof a||Wa(a)?b.set.add(a):b.hash[a]=!0}function r(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function s(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function t(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function u(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function v(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function w(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function x(a,b){return a===kb?b:a}function y(a,b,c){for(var d=-1,e=md(b),f=e.length;++d<f;){var g=e[d],h=a[g],i=c(h,b[g],g,a,b);(i===i?i===h:h!==h)&&(h!==kb||g in a)||(a[g]=i)}return a}function z(a,b){return null==b?a:A(b,md(b),a)}function A(a,b,c){c||(c={});for(var d=-1,e=b.length;++d<e;){var f=b[d];c[f]=a[f]}return c}function B(a,b,c){var d=typeof a;return"function"==d?b===kb?a:Y(a,b,c):null==a?fb:"object"==d?P(a):b===kb?ib(a):Q(a,b)}function C(a,b,c,d,e,f,g){var h;if(c&&(h=e?c(a,d,e):c(a)),h!==kb)return h;if(!Wa(a))return a;var i=hd(a);if(i){if(h=ua(a),!b)return r(a,h)}else{var j=sc.call(a),k=j==Eb;if(j!=Hb&&j!=zb&&(!k||e))return ec[j]?wa(a,j,b):e?a:{};if(h=va(k?{}:a),!b)return z(h,a)}f||(f=[]),g||(g=[]);for(var l=f.length;l--;)if(f[l]==a)return g[l];return f.push(a),g.push(h),(i?s:J)(a,function(d,e){h[e]=C(d,b,c,e,a,f,g)}),h}function D(a,b,c){if("function"!=typeof a)throw new TypeError(xb);return setTimeout(function(){a.apply(kb,c)},b)}function E(a,b){var c=a?a.length:0,d=[];if(!c)return d;var e=-1,g=ra(),h=g==f,i=h&&b.length>=200?Vc(b):null,j=b.length;i&&(g=p,h=!1,b=i);a:for(;++e<c;){var k=a[e];if(h&&k===k){for(var l=j;l--;)if(b[l]===k)continue a;d.push(k)}else g(b,k,0)<0&&d.push(k)}return d}function F(a,b){var c=!0;return Sc(a,function(a,d,e){return c=!!b(a,d,e)}),c}function G(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function H(a,b,c){for(var d=-1,e=a.length,f=-1,g=[];++d<e;){var h=a[d];if(j(h)&&ya(h)&&(c||hd(h)||Ta(h))){b&&(h=H(h,b,c));for(var i=-1,k=h.length;++i<k;)g[++f]=h[i]}else c||(g[++f]=h)}return g}function I(a,b){return Tc(a,b,_a)}function J(a,b){return Tc(a,b,md)}function K(a,b,c){if(null!=a){c!==kb&&c in La(a)&&(b=[c]);for(var d=0,e=b.length;null!=a&&e>d;)a=a[b[d++]];return d&&d==e?a:kb}}function L(a,b,c,d,e,f){return a===b?!0:null==a||null==b||!Wa(a)&&!j(b)?a!==a&&b!==b:M(a,b,L,c,d,e,f)}function M(a,b,c,d,e,f,g){var h=hd(a),i=hd(b),j=Ab,k=Ab;h||(j=sc.call(a),j==zb?j=Hb:j!=Hb&&(h=$a(a))),i||(k=sc.call(b),k==zb?k=Hb:k!=Hb&&(i=$a(b)));var l=j==Hb,m=k==Hb,n=j==k;if(n&&!h&&!l)return na(a,b,j);if(!e){var o=l&&qc.call(a,"__wrapped__"),p=m&&qc.call(b,"__wrapped__");if(o||p)return c(o?a.value():a,p?b.value():b,d,e,f,g)}if(!n)return!1;f||(f=[]),g||(g=[]);for(var q=f.length;q--;)if(f[q]==a)return g[q]==b;f.push(a),g.push(b);var r=(h?ma:oa)(a,b,c,d,e,f,g);return f.pop(),g.pop(),r}function N(a,b,c){var d=b.length,e=d,f=!c;if(null==a)return!e;for(a=La(a);d--;){var g=b[d];if(f&&g[2]?g[1]!==a[g[0]]:!(g[0]in a))return!1}for(;++d<e;){g=b[d];var h=g[0],i=a[h],j=g[1];if(f&&g[2]){if(i===kb&&!(h in a))return!1}else{var k=c?c(i,j,h):kb;if(!(k===kb?L(j,i,c,!0):k))return!1}}return!0}function O(a,b){var c=-1,d=ya(a)?Array(a.length):[];return Sc(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function P(a){var b=sa(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(d!==kb||c in La(a))}}return function(a){return N(a,b)}}function Q(a,b){var c=hd(a),d=Ba(a)&&Ea(b),e=a+"";return a=Ma(a),function(f){if(null==f)return!1;var g=e;if(f=La(f),(c||!d)&&!(g in f)){if(f=1==a.length?f:K(f,U(a,0,-1)),null==f)return!1;g=Oa(a),f=La(f)}return f[g]===b?b!==kb||g in f:L(b,f[g],kb,!0)}}function R(a){return function(b){return null==b?kb:b[a]}}function S(a){var b=a+"";return a=Ma(a),function(c){return K(c,a,b)}}function T(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function U(a,b,c){var d=-1,e=a.length;b=null==b?0:+b||0,0>b&&(b=-b>e?0:e+b),c=c===kb||c>e?e:+c||0,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function V(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}function W(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&Lc>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)&&null!==g?d=f+1:e=f}return e}return X(a,b,fb,c)}function X(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===kb;f>e;){var j=wc((e+f)/2),k=c(a[j]),l=k!==kb,m=k===k;if(g)var n=m||d;else n=h?m&&l&&(d||null!=k):i?m&&(d||l):null==k?!1:d?b>=k:b>k;n?e=j+1:f=j}return Gc(f,Kc)}function Y(a,b,c){if("function"!=typeof a)return fb;if(b===kb)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function Z(a){return vc.call(a,0)}function $(a,b,c){for(var d=c.length,e=-1,f=Fc(a.length-d,0),g=-1,h=b.length,i=Array(f+h);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function _(a,b,c){for(var d=-1,e=c.length,f=-1,g=Fc(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(var k=f;++h<i;)j[k+h]=b[h];for(;++d<e;)j[k+c[d]]=a[f++];return j}function aa(a){return Ra(function(b,c){var d=-1,e=null==b?0:c.length,f=e>2?c[e-2]:kb,g=e>2?c[2]:kb,h=e>1?c[e-1]:kb;for("function"==typeof f?(f=Y(f,h,5),e-=2):(f="function"==typeof h?h:kb,e-=f?1:0),g&&Aa(c[0],c[1],g)&&(f=3>e?kb:f,e=1);++d<e;){var i=c[d];i&&a(b,i,f)}return b})}function ba(a,b){return function(c,d){var e=c?Xc(c):0;if(!Da(e))return a(c,d);for(var f=b?e:-1,g=La(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function ca(a){return function(b,c,d){for(var e=La(b),f=d(b),g=f.length,h=a?g:-1;a?h--:++h<g;){var i=f[h];if(c(e[i],i,e)===!1)break}return b}}function da(a,b){function c(){var e=this&&this!==mc&&this instanceof c?d:a;return e.apply(b,arguments)}var d=ea(a);return c}function ea(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4])}var c=Rc(a.prototype),d=a.apply(c,b);return Wa(d)?d:c}}function fa(a,b){return function(c,d,f){if(d=pa(d,f,3),hd(c)){var g=e(c,d,b);return g>-1?c[g]:kb}return G(c,d,a)}}function ga(a,b){return function(c,d,e){return"function"==typeof d&&e===kb&&hd(c)?a(c,d):b(c,Y(d,e,3))}}function ha(a){var b=Ra(function(c,d){var e=k(d,b.placeholder);return la(c,a,null,d,e)});return b}function ia(a,b){return function(c,d,e,f){var g=arguments.length<3;return"function"==typeof d&&f===kb&&hd(c)?a(c,d,e,g):T(c,pa(d,f,4),e,g,b)}}function ja(a,b,c,d,e,f,g,h,i,j){function l(){for(var u=arguments.length,v=u,w=Array(u);v--;)w[v]=arguments[v];if(d&&(w=$(w,d,e)),f&&(w=_(w,f,g)),p||s){var x=l.placeholder,y=k(w,x);if(u-=y.length,j>u){var z=h?r(h):null,A=Fc(j-u,0),B=p?y:null,C=p?null:y,D=p?w:null,E=p?null:w;b|=p?rb:sb,b&=~(p?sb:rb),q||(b&=~(mb|nb));var F=[a,b,c,D,B,E,C,z,i,A],G=ja.apply(kb,F);return Ca(a)&&Yc(G,F),G.placeholder=x,G}}var H=n?c:this,I=o?H[a]:a;return h&&(w=Ia(w,h)),m&&i<w.length&&(w.length=i),this&&this!==mc&&this instanceof l&&(I=t||ea(a)),I.apply(H,w)}var m=b&tb,n=b&mb,o=b&nb,p=b&pb,q=b&ob,s=b&qb,t=o?null:ea(a);return l}function ka(a,b,c,d){function e(){for(var b=-1,h=arguments.length,i=-1,j=d.length,k=Array(h+j);++i<j;)k[i]=d[i];for(;h--;)k[i++]=arguments[++b];var l=this&&this!==mc&&this instanceof e?g:a;return l.apply(f?c:this,k)}var f=b&mb,g=ea(a);return e}function la(a,b,c,d,e,f,g,h){var i=b&nb;if(!i&&"function"!=typeof a)throw new TypeError(xb);var j=d?d.length:0;if(j||(b&=~(rb|sb),d=e=null),j-=e?e.length:0,b&sb){var k=d,l=e;d=e=null}var m=i?null:Wc(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&(Fa(n,m),b=n[1],h=n[9]),n[9]=null==h?i?0:a.length:Fc(h-j,0)||0,b==mb)var o=da(n[0],n[2]);else o=b!=rb&&b!=(mb|rb)||n[4].length?ja.apply(kb,n):ka.apply(kb,n);var p=m?Uc:Yc;return p(o,n)}function ma(a,b,c,d,e,f,g){var h=-1,i=a.length,j=b.length;if(i!=j&&!(e&&j>i))return!1;for(;++h<i;){var k=a[h],l=b[h],m=d?d(e?l:k,e?k:l,h):kb;if(m!==kb){if(m)continue;return!1}if(e){if(!w(b,function(a){return k===a||c(k,a,d,e,f,g)}))return!1}else if(k!==l&&!c(k,l,d,e,f,g))return!1}return!0}function na(a,b,c){switch(c){case Bb:case Cb:return+a==+b;case Db:return a.name==b.name&&a.message==b.message;case Gb:return a!=+a?b!=+b:a==+b;case Ib:case Kb:return a==b+""}return!1}function oa(a,b,c,d,e,f,g){var h=md(a),i=h.length,j=md(b),k=j.length;if(i!=k&&!e)return!1;for(var l=i;l--;){var m=h[l];if(!(e?m in b:qc.call(b,m)))return!1}for(var n=e;++l<i;){m=h[l];var o=a[m],p=b[m],q=d?d(e?p:o,e?o:p,m):kb;if(!(q===kb?c(o,p,d,e,f,g):q))return!1;n||(n="constructor"==m)}if(!n){var r=a.constructor,s=b.constructor;if(r!=s&&"constructor"in a&&"constructor"in b&&!("function"==typeof r&&r instanceof r&&"function"==typeof s&&s instanceof s))return!1}return!0}function pa(a,b,c){var d=l.callback||db;return d=d===db?B:d,c?d(a,b,c):d}function qa(a){for(var b=a.name,c=Pc[b],d=c?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function ra(a,b,c){var d=l.indexOf||Na;return d=d===Na?f:d,a?d(a,b,c):d}function sa(a){for(var b=ab(a),c=b.length;c--;)b[c][2]=Ea(b[c][1]);return b}function ta(a,b){var c=null==a?kb:a[b];return Xa(c)?c:kb}function ua(a){var b=a.length,c=new a.constructor(b);return b&&"string"==typeof a[0]&&qc.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function va(a){var b=a.constructor;return"function"==typeof b&&b instanceof b||(b=Object),new b}function wa(a,b,c){var d=a.constructor;switch(b){case Mb:return Z(a);case Bb:case Cb:return new d(+a);case Nb:case Ob:case Pb:case Qb:case Rb:case Sb:case Tb:case Ub:case Vb:var e=a.buffer;return new d(c?Z(e):e,a.byteOffset,a.length);case Gb:case Kb:return new d(a);case Ib:var f=new d(a.source,ac.exec(a));f.lastIndex=a.lastIndex}return f}function xa(a,b,c){null==a||Ba(b,a)||(b=Ma(b),a=1==b.length?a:K(a,U(b,0,-1)),b=Oa(b));var d=null==a?a:a[b];return null==d?kb:d.apply(a,c)}function ya(a){return null!=a&&Da(Xc(a))}function za(a,b){return a="number"==typeof a||cc.test(a)?+a:-1,b=null==b?Nc:b,a>-1&&a%1==0&&b>a}function Aa(a,b,c){if(!Wa(c))return!1;var d=typeof b;if("number"==d?ya(c)&&za(b,c.length):"string"==d&&b in c){var e=c[b];return a===a?a===e:e!==e}return!1}function Ba(a,b){var c=typeof a;if("string"==c&&Xb.test(a)||"number"==c)return!0;if(hd(a))return!1;var d=!Wb.test(a);return d||null!=b&&a in La(b)}function Ca(a){var b=qa(a);if(!(b in n.prototype))return!1;var c=l[b];if(a===c)return!0;var d=Wc(c);return!!d&&a===d[0]}function Da(a){return"number"==typeof a&&a>-1&&a%1==0&&Nc>=a}function Ea(a){return a===a&&!Wa(a)}function Fa(a,b){var c=a[1],d=b[1],e=c|d,f=tb>e,g=d==tb&&c==pb||d==tb&&c==ub&&a[7].length<=b[8]||d==(tb|ub)&&c==pb;if(!f&&!g)return a;d&mb&&(a[2]=b[2],e|=c&mb?0:ob);var h=b[3];if(h){var i=a[3];a[3]=i?$(i,h,b[4]):r(h),a[4]=i?k(a[3],yb):r(b[4])}return h=b[5],h&&(i=a[5],a[5]=i?_(i,h,b[6]):r(h),a[6]=i?k(a[5],yb):r(b[6])),h=b[7],h&&(a[7]=r(h)),d&tb&&(a[8]=null==a[8]?b[8]:Gc(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function Ga(a,b){a=La(a);for(var c=-1,d=b.length,e={};++c<d;){var f=b[c];f in a&&(e[f]=a[f])}return e}function Ha(a,b){var c={};return I(a,function(a,d,e){b(a,d,e)&&(c[d]=a)}),c}function Ia(a,b){for(var c=a.length,d=Gc(b.length,c),e=r(a);d--;){var f=b[d];a[d]=za(f,c)?e[f]:kb}return a}function Ja(a){var b;l.support;if(!j(a)||sc.call(a)!=Hb||!qc.call(a,"constructor")&&(b=a.constructor,"function"==typeof b&&!(b instanceof b)))return!1;var c;return I(a,function(a,b){c=b}),c===kb||qc.call(a,c)}function Ka(a){for(var b=_a(a),c=b.length,d=c&&a.length,e=!!d&&Da(d)&&(hd(a)||Ta(a)),f=-1,g=[];++f<c;){var h=b[f];(e&&za(h,d)||qc.call(a,h))&&g.push(h)}return g}function La(a){return Wa(a)?a:Object(a)}function Ma(a){if(hd(a))return a;var b=[];return h(a).replace(Yb,function(a,c,d,e){b.push(d?e.replace(_b,"$1"):c||a)}),b}function Na(a,b,c){var d=a?a.length:0;if(!d)return-1;if("number"==typeof c)c=0>c?Fc(d+c,0):c;else if(c){var e=W(a,b),g=a[e];return(b===b?b===g:g!==g)?e:-1}return f(a,b,c||0)}function Oa(a){var b=a?a.length:0;return b?a[b-1]:kb}function Pa(a,b,c){var d=hd(a)?t:F;return c&&Aa(a,b,c)&&(b=null),("function"!=typeof b||c!==kb)&&(b=pa(b,c,3)),d(a,b)}function Qa(a,b,c){var d=hd(a)?u:O;return b=pa(b,c,3),d(a,b)}function Ra(a,b){if("function"!=typeof a)throw new TypeError(xb);return b=Fc(b===kb?a.length-1:+b||0,0),function(){for(var c=arguments,d=-1,e=Fc(c.length-b,0),f=Array(e);++d<e;)f[d]=c[b+d];switch(b){case 0:return a.call(this,f);case 1:return a.call(this,c[0],f);case 2:return a.call(this,c[0],c[1],f)}var g=Array(b+1);for(d=-1;++d<b;)g[d]=c[d];return g[b]=f,a.apply(this,g)}}function Sa(a,b,c,d){return b&&"boolean"!=typeof b&&Aa(a,b,c)?b=!1:"function"==typeof b&&(d=c,c=b,b=!1),"function"==typeof c?C(a,b,Y(c,d,1)):C(a,b)}function Ta(a){return j(a)&&ya(a)&&sc.call(a)==zb}function Ua(a){return!!a&&1===a.nodeType&&j(a)&&sc.call(a).indexOf("Element")>-1}function Va(a,b,c,d){c="function"==typeof c?Y(c,d,3):kb;var e=c?c(a,b):kb;return e===kb?L(a,b,c):!!e}function Wa(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Xa(a){return null==a?!1:sc.call(a)==Eb?tc.test(pc.call(a)):j(a)&&bc.test(a)}function Ya(a){return"number"==typeof a||j(a)&&sc.call(a)==Gb}function Za(a){return"string"==typeof a||j(a)&&sc.call(a)==Kb}function $a(a){return j(a)&&Da(a.length)&&!!dc[sc.call(a)]}function _a(a){if(null==a)return[];Wa(a)||(a=Object(a));var b=a.length;b=b&&Da(b)&&(hd(a)||Ta(a))&&b||0;for(var c=a.constructor,d=-1,e="function"==typeof c&&c.prototype===a,f=Array(b),g=b>0;++d<b;)f[d]=d+"";for(var h in a)g&&za(h,b)||"constructor"==h&&(e||!qc.call(a,h))||f.push(h);return f}function ab(a){a=La(a);for(var b=-1,c=md(a),d=c.length,e=Array(d);++b<d;){var f=c[b];e[b]=[f,a[f]]}return e}function bb(a){return V(a,md(a))}function cb(a){return a=h(a),a&&$b.test(a)?a.replace(Zb,"\\$&"):a}function db(a,b,c){return c&&Aa(a,b,c)&&(b=null),j(a)?gb(a):B(a,b)}function eb(a){return function(){return a}}function fb(a){return a}function gb(a){return P(C(a,!0))}function hb(){}function ib(a){return Ba(a)?R(a):S(a)}function jb(a){var b=++rc;return h(a)+b}var kb,lb="3.9.3",mb=1,nb=2,ob=4,pb=8,qb=16,rb=32,sb=64,tb=128,ub=256,vb=150,wb=16,xb="Expected a function",yb="__lodash_placeholder__",zb="[object Arguments]",Ab="[object Array]",Bb="[object Boolean]",Cb="[object Date]",Db="[object Error]",Eb="[object Function]",Fb="[object Map]",Gb="[object Number]",Hb="[object Object]",Ib="[object RegExp]",Jb="[object Set]",Kb="[object String]",Lb="[object WeakMap]",Mb="[object ArrayBuffer]",Nb="[object Float32Array]",Ob="[object Float64Array]",Pb="[object Int8Array]",Qb="[object Int16Array]",Rb="[object Int32Array]",Sb="[object Uint8Array]",Tb="[object Uint8ClampedArray]",Ub="[object Uint16Array]",Vb="[object Uint32Array]",Wb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Xb=/^\w*$/,Yb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Zb=/[.*+?^${}()|[\]\/\\]/g,$b=RegExp(Zb.source),_b=/\\(\\)?/g,ac=/\w*$/,bc=/^\[object .+?Constructor\]$/,cc=/^\d+$/,dc={};dc[Nb]=dc[Ob]=dc[Pb]=dc[Qb]=dc[Rb]=dc[Sb]=dc[Tb]=dc[Ub]=dc[Vb]=!0,dc[zb]=dc[Ab]=dc[Mb]=dc[Bb]=dc[Cb]=dc[Db]=dc[Eb]=dc[Fb]=dc[Gb]=dc[Hb]=dc[Ib]=dc[Jb]=dc[Kb]=dc[Lb]=!1;var ec={};ec[zb]=ec[Ab]=ec[Mb]=ec[Bb]=ec[Cb]=ec[Nb]=ec[Ob]=ec[Pb]=ec[Qb]=ec[Rb]=ec[Gb]=ec[Hb]=ec[Ib]=ec[Kb]=ec[Sb]=ec[Tb]=ec[Ub]=ec[Vb]=!0,ec[Db]=ec[Eb]=ec[Fb]=ec[Jb]=ec[Lb]=!1;var fc={"function":!0,object:!0},gc=fc[typeof d]&&d&&!d.nodeType&&d,hc=fc[typeof c]&&c&&!c.nodeType&&c,ic=gc&&hc&&"object"==typeof b&&b&&b.Object&&b,jc=fc[typeof self]&&self&&self.Object&&self,kc=fc[typeof window]&&window&&window.Object&&window,lc=hc&&hc.exports===gc&&gc,mc=ic||kc!==(this&&this.window)&&kc||jc||this,nc=Object.prototype,oc=(oc=mc.window)?oc.document:null,pc=Function.prototype.toString,qc=nc.hasOwnProperty,rc=0,sc=nc.toString,tc=RegExp("^"+cb(pc.call(qc)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),uc=ta(mc,"ArrayBuffer"),vc=ta(uc&&new uc(0),"slice"),wc=Math.floor,xc=ta(Object,"getPrototypeOf"),yc=ta(mc,"Set"),zc=ta(mc,"Uint8Array"),Ac=ta(mc,"WeakMap"),Bc=function(){try{var a=ta(mc,"Float64Array"),b=new a(new uc(10),0,1)&&a}catch(c){}return b||null}(),Cc=ta(Object,"create"),Dc=ta(Array,"isArray"),Ec=ta(Object,"keys"),Fc=Math.max,Gc=Math.min,Hc=ta(Date,"now"),Ic=Number.POSITIVE_INFINITY,Jc=4294967295,Kc=Jc-1,Lc=Jc>>>1,Mc=Bc?Bc.BYTES_PER_ELEMENT:0,Nc=9007199254740991,Oc=Ac&&new Ac,Pc={},Qc=l.support={};!function(a){var b=function(){this.x=a},c=[];b.prototype={valueOf:a,y:a};for(var d in new b)c.push(d);try{Qc.dom=11===oc.createDocumentFragment().nodeType}catch(e){Qc.dom=!1}}(1,0);var Rc=function(){function a(){}return function(b){if(Wa(b)){a.prototype=b;var c=new a;a.prototype=null}return c||{}}}(),Sc=ba(J),Tc=ca(),Uc=Oc?function(a,b){return Oc.set(a,b),a}:fb;vc||(Z=uc&&zc?function(a){var b=a.byteLength,c=Bc?wc(b/Mc):0,d=c*Mc,e=new uc(b);if(c){var f=new Bc(e,0,c);f.set(new Bc(a,0,c))}return b!=d&&(f=new zc(e,d),f.set(new zc(a,d))),e}:eb(null));var Vc=Cc&&yc?function(a){return new o(a)}:eb(null),Wc=Oc?function(a){return Oc.get(a)}:hb,Xc=R("length"),Yc=function(){var a=0,b=0;return function(c,d){var e=dd(),f=wb-(e-b);if(b=e,f>0){if(++a>=vb)return c}else a=0;return Uc(c,d)}}(),Zc=Ra(function(a,b){return ya(a)?E(a,H(b,!1,!0)):[]}),$c=Ra(function(a){for(var b=a.length,c=b,d=Array(l),e=ra(),g=e==f,h=[];c--;){var i=a[c]=ya(i=a[c])?i:[];d[c]=g&&i.length>=120?Vc(c&&i):null}var j=a[0],k=-1,l=j?j.length:0,m=d[0];a:for(;++k<l;)if(i=j[k],(m?p(m,i):e(h,i,0))<0){for(var c=b;--c;){var n=d[c];if((n?p(n,i):e(a[c],i,0))<0)continue a}m&&m.push(i),h.push(i)}return h}),_c=fa(Sc),ad=ga(s,Sc),bd=Ra(function(a,b,c){var d=-1,e="function"==typeof b,f=Ba(b),g=ya(a)?Array(a.length):[];return Sc(a,function(a){var h=e?b:f&&null!=a?a[b]:null;g[++d]=h?h.apply(a,c):xa(a,b,c)}),g}),cd=ia(v,Sc),dd=Hc||function(){return(new Date).getTime()},ed=Ra(function(a,b,c){var d=mb;if(c.length){var e=k(c,ed.placeholder);d|=rb}return la(a,d,b,c,e)}),fd=Ra(function(a,b){return D(a,1,b)}),gd=ha(rb),hd=Dc||function(a){return j(a)&&Da(a.length)&&sc.call(a)==Ab};Qc.dom||(Ua=function(a){return!!a&&1===a.nodeType&&j(a)&&!jd(a)});var id=g(/x/)||zc&&!g(zc)?function(a){return sc.call(a)==Eb}:g,jd=xc?function(a){if(!a||sc.call(a)!=Hb)return!1;var b=ta(a,"valueOf"),c=b&&(c=xc(b))&&xc(c);return c?a==c||xc(a)==c:Ja(a)}:Ja,kd=aa(function(a,b,c){return c?y(a,b,c):z(a,b)}),ld=Ra(function(a){var b=a[0];return null==b?b:(a.push(x),kd.apply(kb,a))}),md=Ec?function(a){var b=null==a?null:a.constructor;return"function"==typeof b&&b.prototype===a||"function"!=typeof a&&ya(a)?Ka(a):Wa(a)?Ec(a):[]}:Ka,nd=Ra(function(a,b){if(null==a)return{};if("function"!=typeof b[0]){var b=u(H(b),String);return Ga(a,E(_a(a),b))}var c=Y(b[0],b[1],3);return Ha(a,function(a,b,d){return!c(a,b,d)})});n.prototype=Rc(m.prototype),n.prototype.constructor=n,o.prototype.push=q,l.assign=kd,l.bind=ed,l.callback=db,l.constant=eb,l.defaults=ld,l.defer=fd,l.difference=Zc,l.forEach=ad,l.intersection=$c,l.invoke=bd,l.keys=md,l.keysIn=_a,l.map=Qa,l.matches=gb,l.omit=nd,l.pairs=ab,l.partial=gd,l.property=ib,l.restParam=Ra,l.values=bb,l.collect=Qa,l.each=ad,l.extend=kd,l.iteratee=db,l.clone=Sa,l.escapeRegExp=cb,l.every=Pa,l.find=_c,l.identity=fb,l.indexOf=Na,l.isArguments=Ta,l.isArray=hd,l.isElement=Ua,l.isEqual=Va,l.isFunction=id,l.isNative=Xa,l.isNumber=Ya,l.isObject=Wa,l.isPlainObject=jd,l.isString=Za,l.isTypedArray=$a,l.last=Oa,l.noop=hb,l.now=dd,l.reduce=cd,l.uniqueId=jb,l.all=Pa,l.eq=Va,l.detect=_c,l.foldl=cd,l.inject=cd,l.VERSION=lb,s(["bind","partial"],function(a){l[a].placeholder=l}),"function"==typeof a&&"object"==typeof a.amd&&a.amd?(mc._=l,a(function(){return l})):gc&&hc?lc?(hc.exports=l)._=l:gc._=l:mc._=l}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(b,c,d){!function(b,e){"object"==typeof d&&"object"==typeof c?c.exports=e():"function"==typeof a&&a.amd?a(e):"object"==typeof d?d.Microm=e():b.Microm=e()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="http://localhost:8090/assets",b(0)}([function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=(c(4),c(5)),g=c(6).Promise,h=c(1),i=c(2),j=c(3);j.setup();var k=function(){function a(){d(this,a),this.isRecording=!1,this.recordRTC=null,this.player=null,this.mp3=null,this.eventListeners={},this.converter=new h}return e(a,[{key:"record",value:function(){this.isRecording=!0;var a=navigator.mediaDevices.getUserMedia({audio:!0});return a.then(this.startUserMedia.bind(this))["catch"](this.onUserMediaError.bind(this)),a}},{key:"stopRecording",value:function(){var a=this;return this.isRecording=!1,new g(function(b,c){a.recordRTC.stopRecording(function(){a.getMp3().then(function(c){a.mp3=c,a.player=new i(c.url,a),b(c)})})})}},{key:"play",value:function(){this.player.play()}},{key:"pause",value:function(){this.player.pause()}},{key:"stop",value:function(){var a=this;return this.isRecording?this.stopRecording():new g(function(b,c){a.player.stop(),b(a.mp3)})}},{key:"getMp3",value:function(){var a=this.recordRTC.getBlob();return this.converter.toMp3(a)}},{key:"getWav",value:function(){}},{key:"getUrl",value:function(){return this.mp3.url}},{key:"getBlob",value:function(){return this.mp3.blob}},{key:"getBuffer",value:function(){return this.mp3.buffer}},{key:"getBase64",value:function(){return this.converter.toBase64(this.getBlob())}},{key:"download",value:function(){var a=arguments.length<=0||void 0===arguments[0]?"micro_record":arguments[0],b=document.createElement("a"),c=document.createEvent("Event");b.href=this.getUrl(),b.download=a+".mp3",c.initEvent("click",!0,!0),b.dispatchEvent(c)}},{key:"startUserMedia",value:function(a){var b=f(a,{type:"audio"});b.startRecording(),this.recordRTC=b,this.isRecording=!0}},{key:"onUserMediaError",value:function(){}},{key:"on",value:function(a,b){this.eventListeners[a]=b}},{key:"off",value:function(a){delete this.eventListeners[a]}}]),a}();a.exports=k},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(8),g=c(6).Promise,h=c(10),i={channels:1,sampleRate:44100,kbps:128,maxSamples:1152},j={mono:1,stereo:2},k=function(){function a(){d(this,a),this.lame=new f}return e(a,[{key:"toBase64",value:function(a){var b=new FileReader;return b.readAsDataURL(a),new g(function(a,c){b.onload=function(){a(b.result)}})}},{key:"toMp3",value:function(a){var b=this,c=new FileReader;return c.readAsArrayBuffer(a),new g(function(a,d){b.mp3Resolver=a,c.onload=b.onBlobReady.bind(c,b)})}},{key:"onBlobReady",value:function(a){var b=this.result,c=new Int16Array(b),d=a.lame.WavHeader.readHeader(new DataView(b));if(d.channels===j.stereo){for(var e=[],f=[],g=0;g<c.length;)e.push(c[g]),f.push(c[g+1]),g+=j.stereo;c=[e,f]}else c=[c];a.encodeSamplesToMp3(c,{channels:d.channels,sampleRate:d.sampleRate})}},{key:"encodeSamplesToMp3",value:function(a,b){b=h(i,b);for(var c,d,e,f,g,j,k=a[0],l=a[1],m=b.maxSamples,n=k.length,o=new this.lame.Mp3Encoder(b.channels,b.sampleRate,b.kbps),p=[],q=0;n>=m;)q+=m,d=k.splice(q,q+m),e=l?l.splice(q,q+m):null,c=o.encodeBuffer(d,e),c.length>0&&p.push(new Int8Array(c)),n-=m;f=o.flush(),f.length>0&&p.push(new Int8Array(f)),g=new Blob(p,{type:"audio/mp3"}),j=URL.createObjectURL(g),this.mp3Resolver({buffer:p,blob:g,url:j})}}]),a}();a.exports=k},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(7),g=["loadedmetadata","timeupdate","play","pause","ended"],h=function(){function a(b,c){d(this,a);var e=document.createElement("audio");e.src=b,this.microm=c,this.isLoaded=!1,this.isPlaying=!1,this.isStoped=!0,this.duration=0,this.currentTime=0,this.audio=e,this.addEvents()}return e(a,[{key:"play",value:function(){this.audio.play()}},{key:"pause",value:function(){this.pauseAudio()}},{key:"stop",value:function(){this.pauseAudio(0)}},{key:"pauseAudio",value:function(a){this.audio.pause(),"undefined"!=typeof a&&(this.audio.currentTime=a,this.currentTime=a)}},{key:"addEvents",value:function(){var a=this,b=this.audio;this.pauseAudio(0),g.forEach(function(c){var d="on"+(0,f.capitalize)(c);b.addEventListener(c,a[d].bind(a))})}},{key:"fireEvent",value:function(a,b){var c=this.microm.eventListeners[a];c&&c(b)}},{key:"onLoadedmetadata",value:function(){this.isLoaded=!0,this.duration=this.audio.duration,this.fireEvent("loadedmetadata",this.duration)}},{key:"onTimeupdate",value:function(){this.currentTime=this.audio.currentTime,this.fireEvent("timeupdate",this.currentTime)}},{key:"onPlay",value:function(){this.isPlaying=!0,this.isStoped=!1,this.fireEvent("play")}},{key:"onPause",value:function(){this.isPlaying=!1,this.fireEvent("pause",this.currentTime)}},{key:"onEnded",value:function(){this.isPlaying=!1,this.isStoped=!0,this.fireEvent("ended")}}]),a}();a.exports=h},function(a,b,c){"use strict";var d=c(6);a.exports=function(){function a(){d.on("error",function(a){console.assert(!1,a)})}return{setup:a}}()},function(a,b,c){"use strict";function d(a){return new Promise(function(b,c){e(a,b,c)})}var e=null,f=null,g=null,h=null,i=null,j=null,k={log:function(){},extractVersion:function(a,b,c){var d=a.match(b);return d&&d.length>=c&&parseInt(d[c])}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(a){"mozSrcObject"in this?this.mozSrcObject=a:(this._srcObject=a,this.src=URL.createObjectURL(a))}}),e=window.navigator&&window.navigator.getUserMedia),f=function(a,b){a.srcObject=b},g=function(a,b){a.srcObject=b.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){if(k.log("This appears to be Firefox"),h="firefox",i=k.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),j=31,window.RTCPeerConnection=function(a,b){if(38>i&&a&&a.iceServers){for(var c=[],d=0;d<a.iceServers.length;d++){var e=a.iceServers[d];if(e.hasOwnProperty("urls"))for(var f=0;f<e.urls.length;f++){var g={url:e.urls[f]};0===e.urls[f].indexOf("turn")&&(g.username=e.username,g.credential=e.credential),c.push(g)}else c.push(a.iceServers[d])}a.iceServers=c}return new mozRTCPeerConnection(a,b)},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),e=function(a,b,c){var d=function(a){if("object"!=typeof a||a.require)return a;var b=[];return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"==typeof a[c]?a[c]:{ideal:a[c]};if((void 0!==d.min||void 0!==d.max||void 0!==d.exact)&&b.push(c),void 0!==d.exact&&("number"==typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact),void 0!==d.ideal){a.advanced=a.advanced||[];var e={};"number"==typeof d.ideal?e[c]={min:d.ideal,max:d.ideal}:e[c]=d.ideal,a.advanced.push(e),delete d.ideal,Object.keys(d).length||delete a[c]}}}),b.length&&(a.require=b),a};return 38>i&&(k.log("spec: "+JSON.stringify(a)),a.audio&&(a.audio=d(a.audio)),a.video&&(a.video=d(a.video)),k.log("ff37: "+JSON.stringify(a))),navigator.mozGetUserMedia(a,b,c)},navigator.getUserMedia=e,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:d,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(a){var b=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];a(b)})},41>i){var l=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return l().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){k.log("This appears to be Chrome"),h="chrome",i=k.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),j=38,window.RTCPeerConnection=function(a,b){a&&a.iceTransportPolicy&&(a.iceTransports=a.iceTransportPolicy);var c=new webkitRTCPeerConnection(a,b),d=c.getStats.bind(c);return c.getStats=function(a,b,c){var e=this,f=arguments;if(arguments.length>0&&"function"==typeof a)return d(a,b);var g=function(a){var b={},c=a.result();return c.forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:a.type};a.names().forEach(function(b){c[b]=a.stat(b)}),b[c.id]=c}),b};if(arguments.length>=2){var h=function(a){f[1](g(a))};return d.apply(this,[h,arguments[0]])}return new Promise(function(b,c){1===f.length&&null===a?d.apply(e,[function(a){b.apply(null,[g(a)])},c]):d.apply(e,[b,c])})},c},["createOffer","createAnswer"].forEach(function(a){var b=webkitRTCPeerConnection.prototype[a];webkitRTCPeerConnection.prototype[a]=function(){var a=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var c=1===arguments.length?arguments[0]:void 0;return new Promise(function(d,e){
b.apply(a,[d,e,c])})}return b.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var b=webkitRTCPeerConnection.prototype[a];webkitRTCPeerConnection.prototype[a]=function(){var a=arguments,c=this;return new Promise(function(d,e){b.apply(c,[a[0],function(){d(),a.length>=2&&a[1].apply(null,[])},function(b){e(b),a.length>=3&&a[2].apply(null,[b])}])})}});var m=function(a){if("object"!=typeof a||a.mandatory||a.optional)return a;var b={};return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"==typeof a[c]?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var f={};"number"==typeof d.ideal?(f[e("min",c)]=d.ideal,b.optional.push(f),f={},f[e("max",c)]=d.ideal,b.optional.push(f)):(f[e("",c)]=d.ideal,b.optional.push(f))}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),b};if(e=function(a,b,c){return a.audio&&(a.audio=m(a.audio)),a.video&&(a.video=m(a.video)),k.log("chrome: "+JSON.stringify(a)),navigator.webkitGetUserMedia(a,b,c)},navigator.getUserMedia=e,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:d,enumerateDevices:function(){return new Promise(function(a){var b={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(c){a(c.map(function(a){return{label:a.label,kind:b[a.kind],deviceId:a.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var n=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(a){return k.log("spec:   "+JSON.stringify(a)),a.audio=m(a.audio),a.video=m(a.video),k.log("chrome: "+JSON.stringify(a)),n(a)}}else navigator.mediaDevices.getUserMedia=function(a){return d(a)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){k.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){k.log("Dummy mediaDevices.removeEventListener called.")}),f=function(a,b){i>=43?a.srcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):k.log("Error attaching stream to element.")},g=function(a,b){i>=43?a.srcObject=b.srcObject:a.src=b.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(k.log("This appears to be Edge"),h="edge",i=k.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),j=12):k.log("Browser does not appear to be WebRTC-capable");else k.log("This does not appear to be a browser"),h="not a browser";var o={};try{Object.defineProperty(o,"version",{set:function(a){i=a}})}catch(p){}var q;"undefined"!=typeof window&&(q=window.RTCPeerConnection),a.exports={RTCPeerConnection:q,getUserMedia:e,attachMediaStream:f,reattachMediaStream:g,webrtcDetectedBrowser:h,webrtcDetectedVersion:i,webrtcMinimumVersion:j,webrtcTesting:o,webrtcUtils:k}},function(a,b,c){function d(a,b){function c(){return b.disableLogs||console.debug("started recording "+b.type+" stream."),o?(o.clearRecordedData(),o.resume(),p.recordingDuration&&n(),p):(g(function(){p.recordingDuration&&n()}),p)}function g(c){b.disableLogs||console.debug("initializing "+b.type+" stream recorder."),c&&(b.initCallback=function(){c(),c=b.initCallback=null});var d=new f(a,b);o=new d(a,b),o.record()}function j(a){function c(){for(var c in o)p&&(p[c]=o[c]),d&&(d[c]=o[c]);var e=o.blob;if(a){var f=t.createObjectURL(e);a(f)}e&&!b.disableLogs&&console.debug(e.type,"->",h(e.size)),b.autoWriteToDisk&&m(function(a){var c={};c[b.type+"Blob"]=a,A.Store(c)})}if(!o)return console.warn(q);var d=this;b.disableLogs||console.warn("Stopped recording "+b.type+" stream."),"gif"!==b.type?o.stop(c):(o.stop(),c())}function k(){return o?(o.pause(),void(b.disableLogs||console.debug("Paused recording."))):console.warn(q)}function l(){return o?(o.resume(),void(b.disableLogs||console.debug("Resumed recording."))):console.warn(q)}function m(a,c){function d(a){var b=t.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return t.revokeObjectURL(b),c}if(!a)throw"Pass a callback function over getDataURL.";var e=c?c.blob:o.blob;if(!e)return b.disableLogs||console.warn("Blob encoder did not yet finished its job."),void setTimeout(function(){m(a,c)},1e3);if("undefined"!=typeof Worker){var f=d(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});f.onmessage=function(b){a(b.data)},f.postMessage(e)}else{var g=new FileReader;g.readAsDataURL(e),g.onload=function(b){a(b.target.result)}}}function n(){setTimeout(function(){j(p.onRecordingStopped)},p.recordingDuration)}if(!a)throw"MediaStream is mandatory.";b=new e(a,b);var o,p=this,q='It seems that "startRecording" is not invoked for '+b.type+" recorder.",r={startRecording:c,stopRecording:j,pauseRecording:k,resumeRecording:l,initRecorder:g,setRecordingDuration:function(a,b){if("undefined"==typeof a)throw"milliseconds is required.";if("number"!=typeof a)throw"milliseconds must be a number.";return p.recordingDuration=a,p.onRecordingStopped=b||function(){},{onRecordingStopped:function(a){p.onRecordingStopped=a}}},clearRecordedData:function(){return o?(o.clearRecordedData(),void(b.disableLogs||console.debug("Cleared old recorded data."))):console.warn(q)},getBlob:function(){return o?o.blob:console.warn(q)},getDataURL:m,toURL:function(){return o?t.createObjectURL(o.blob):console.warn(q)},save:function(a){return o?void i(o.blob,a):console.warn(q)},getFromDisk:function(a){return o?void d.getFromDisk(b.type,a):console.warn(q)},setAdvertisementArray:function(a){b.advertisement=[];for(var c=a.length,d=0;c>d;d++)b.advertisement.push({duration:d,image:a[d]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return p=r,r;for(var s in r)this[s]=r[s];return p=this,r}function e(a,b){return b.recorderType&&!b.type&&(b.recorderType===m||b.recorderType===l?b.type="video":b.recorderType===n?b.type="gif":b.recorderType===k?b.type="audio":b.recorderType===j&&(a.getAudioTracks().length&&a.getVideoTracks().length?b.type="video":a.getAudioTracks().length&&!a.getVideoTracks().length?b.type="audio":!a.getAudioTracks().length&&a.getVideoTracks().length&&(b.type="audio"))),"undefined"!=typeof j&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(b.mimeType||(b.mimeType="video/webm"),b.type||(b.type=b.mimeType.split("/")[0]),b.bitsPerSecond||(b.bitsPerSecond=128e3)),b.type||(b.mimeType&&(b.type=b.mimeType.split("/")[0]),b.type||(b.type="audio")),b}function f(a,b){var c;return(w||u||v)&&(c=k),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!w&&(c=j),"video"===b.type&&(w||v)&&(c=m),"gif"===b.type&&(c=n),"canvas"===b.type&&(c=l),b.recorderType&&(c=b.recorderType),c}function g(a){this.addStream=function(b){b&&(a=b)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){!w&&a&&a.getAudioTracks&&a.getAudioTracks().length&&a.getVideoTracks().length&&(this.mediaType.audio=!1),this.mediaType.audio&&(this.audioRecorder=new d(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate}),this.audioRecorder.startRecording()),this.mediaType.video&&(this.videoRecorder=new d(a,{type:"video",video:this.video,canvas:this.canvas}),this.videoRecorder.startRecording()),this.mediaType.gif&&(this.gifRecorder=new d(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10}),this.gifRecorder.startRecording())},this.stopRecording=function(a){a=a||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(b){a(b,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(b){a(b,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(b){a(b,"gif")})},this.getBlob=function(a){var b={};return this.audioRecorder&&(b.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(b.video=this.videoRecorder.getBlob()),this.gifRecorder&&(b.gif=this.gifRecorder.getBlob()),a&&a(b),b},this.getDataURL=function(a){function b(a,b){if("undefined"!=typeof Worker){var d=c(function(a){postMessage((new FileReaderSync).readAsDataURL(a))});d.onmessage=function(a){b(a.data)},d.postMessage(a)}else{var e=new FileReader;e.readAsDataURL(a),e.onload=function(a){b(a.target.result)}}}function c(a){var b,c=t.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),d=new Worker(c);if("undefined"!=typeof t)b=t;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";b=webkitURL}return b.revokeObjectURL(c),d}this.getBlob(function(c){b(c.audio,function(d){b(c.video,function(b){a({audio:d,video:b})})})})},this.writeToDisk=function(){d.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(a){a=a||{audio:!0,video:!0,gif:!0},a.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof a.audio?a.audio:""),a.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof a.video?a.video:""),a.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof a.gif?a.gif:"")}}function h(a){var b=1e3,c=["Bytes","KB","MB","GB","TB"];if(0===a)return"0 Bytes";var d=parseInt(Math.floor(Math.log(a)/Math.log(b)),10);return(a/Math.pow(b,d)).toPrecision(3)+" "+c[d]}function i(a,b){if(!a)throw"Blob object is required.";a.type||(a.type="video/webm");var c=a.type.split("/")[1];if(b&&-1!==b.indexOf(".")){var d=b.split(".");b=d[0],c=d[1]}var e=(b||Math.round(9999999999*Math.random())+888888888)+"."+c;if("undefined"!=typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(a,e);if("undefined"!=typeof navigator.msSaveBlob)return navigator.msSaveBlob(a,e);var f=document.createElement("a");f.href=t.createObjectURL(a),f.target="_blank",f.download=e,navigator.mozGetUserMedia&&(f.onclick=function(){(document.body||document.documentElement).removeChild(f)},(document.body||document.documentElement).appendChild(f));var g=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});f.dispatchEvent(g),navigator.mozGetUserMedia||t.revokeObjectURL(f.href)}function j(a,b){function c(){if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1}if(b=b||{bitsPerSecond:128e3,mimeType:"video/webm"},!w&&b.type&&"audio"===b.type){if(a.getVideoTracks&&a.getVideoTracks().length){var d=new s,e=d.createMediaStreamSource(a),f=d.createMediaStreamDestination();e.connect(f),a=f.stream}b.mimeType&&-1!==b.mimeType.indexOf("audio")||(b.mimeType="audio/ogg")}var g=[];this.record=function(){var c=b;w&&(c&&"string"==typeof c||(c="video/vp8",a=new x(a.getVideoTracks()))),b.disableLogs||console.log("Passing following config over MediaRecorder API.",c),h&&(h=null),h=new MediaRecorder(a,c),"canRecordMimeType"in h&&h.canRecordMimeType(b.mimeType)===!1&&(b.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",b.mimeType)),h.ignoreMutedMedia=b.ignoreMutedMedia||!1,h.ondataavailable=function(a){this.dontFireOnDataAvailableEvent||(!w||!a.data||"size"in a.data||(a.data.size=a.data.length||a.data.byteLength||0),a.data&&a.data.size&&g.push(a.data))},h.onerror=function(a){b.disableLogs||("InvalidState"===a.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===a.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===a.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===a.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===a.name?console.error("The UA cannot provide the codec or recording option that has been requested.",a):console.error("MediaRecorder Error",a)),"inactive"!==h.state&&"stopped"!==h.state&&h.stop()},h.start(1),b.onAudioProcessStarted&&b.onAudioProcessStarted(),b.initCallback&&b.initCallback()},this.stop=function(a){h&&(this.recordingCallback=a||function(){},"recording"===h.state&&(h.requestData(),h.stop()),g.length&&this.onRecordingFinished())},this.onRecordingFinished=function(){this.blob=new Blob(g,{type:b.mimeType||"video/webm"}),this.recordingCallback(),g=[]},this.pause=function(){h&&"recording"===h.state&&h.pause()},this.resume=function(){return this.dontFireOnDataAvailableEvent?(this.dontFireOnDataAvailableEvent=!1,void this.record()):void(h&&"paused"===h.state&&h.resume())},this.clearRecordedData=function(){h&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())};var h,i=this;!function j(){return h?c()===!1?void i.stop():void setTimeout(j,1e3):void 0}()}function k(a,b){function c(){if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1}function d(a,b){function c(a,b){function c(a,b){for(var c=new Float64Array(b),d=0,e=a.length,f=0;e>f;f++){var g=a[f];c.set(g,d),d+=g.length}return c}function d(a,b){for(var c=a.length+b.length,d=new Float64Array(c),e=0,f=0;c>f;)d[f++]=a[e],d[f++]=b[e],e++;return d}function e(a,b,c){for(var d=c.length,e=0;d>e;e++)a.setUint8(b+e,c.charCodeAt(e))}var f=a.numberOfAudioChannels,g=a.leftBuffers.slice(0),h=a.rightBuffers.slice(0),i=a.sampleRate,j=a.internalInterleavedLength;2===f&&(g=c(g,j),h=c(h,j)),1===f&&(g=c(g,j));var k;2===f&&(k=d(g,h)),1===f&&(k=g);var l=k.length,m=44+2*l,n=new ArrayBuffer(m),o=new DataView(n);e(o,0,"RIFF"),o.setUint32(4,44+2*l,!0),e(o,8,"WAVE"),e(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,f,!0),o.setUint32(24,i,!0),o.setUint32(28,4*i,!0),o.setUint16(32,2*f,!0),o.setUint16(34,16,!0),e(o,36,"data"),o.setUint32(40,2*l,!0);for(var p=l,q=44,r=1,s=0;p>s;s++)o.setInt16(q,k[s]*(32767*r),!0),q+=2;return b?b({buffer:n,view:o}):void postMessage({buffer:n,view:o})}if(!w)return void c(a,function(a){b(a.buffer,a.view)});var d=e(c);d.onmessage=function(a){b(a.data.buffer,a.data.view),t.revokeObjectURL(d.workerURL)},d.postMessage(a)}function e(a){var b=t.createObjectURL(new Blob([a.toString(),";this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return c.workerURL=b,c}function f(a){if(!s){if(c()===!1&&(b.disableLogs||console.error("MediaStream seems stopped."),g.disconnect(),k=!1),!k)return void o.disconnect();u||(u=!0,b.onAudioProcessStarted&&b.onAudioProcessStarted(),b.initCallback&&b.initCallback());var d=a.inputBuffer.getChannelData(0);if(i.push(new Float32Array(d)),2===m){var e=a.inputBuffer.getChannelData(1);j.push(new Float32Array(e))}l+=q}}if(!a.getAudioTracks().length)throw"Your stream has no audio tracks.";b=b||{};var g,h=this,i=[],j=[],k=!1,l=0,m=2;b.leftChannel===!0&&(m=1),1===b.numberOfAudioChannels&&(m=1),b.disableLogs||console.debug("StereoAudioRecorder is set to record number of channels: ",m),this.record=function(){if(c()===!1)throw"Please make sure MediaStream is active.";i.length=j.length=0,l=0,o&&o.connect(g),u=s=!1,k=!0},this.stop=function(a){k=!1,d({sampleRate:r,numberOfAudioChannels:m,internalInterleavedLength:l,leftBuffers:i,rightBuffers:1===m?[]:j},function(b,c){h.blob=new Blob([c],{type:"audio/wav"}),h.buffer=new ArrayBuffer(c),h.view=c,h.sampleRate=r,h.bufferSize=q,h.length=l,a&&a(),u=!1})},y.AudioContextConstructor||(y.AudioContextConstructor=new y.AudioContext);var n=y.AudioContextConstructor,o=n.createMediaStreamSource(a),p=[0,256,512,1024,2048,4096,8192,16384],q="undefined"==typeof b.bufferSize?4096:b.bufferSize;if(-1===p.indexOf(q)&&(b.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(p,null,"	"))),n.createJavaScriptNode)g=n.createJavaScriptNode(q,m,m);else{if(!n.createScriptProcessor)throw"WebAudio API has no support on this browser.";g=n.createScriptProcessor(q,m,m)}o.connect(g),b.bufferSize||(q=g.bufferSize);var r="undefined"!=typeof b.sampleRate?b.sampleRate:n.sampleRate||44100;(22050>r||r>96e3)&&(b.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),b.disableLogs||(console.log("sample-rate",r),console.log("buffer-size",q));var s=!1;this.pause=function(){s=!0},this.resume=function(){if(c()===!1)throw"Please make sure MediaStream is active.";return k?void(s=!1):(b.disableLogs||console.info("Seems recording has been restarted."),void this.record())},this.clearRecordedData=function(){this.pause(),i.length=j.length=0,l=0};var u=!1;g.onaudioprocess=f,g.connect(n.destination)}function l(a,b){function c(){return i?(k=(new Date).getTime(),setTimeout(c,100)):void html2canvas(a,{onrendered:function(a){if(d){var b=document.createElement("img");b.src=a.toDataURL("image/png"),b.onload=function(){f.drawImage(b,0,0,b.clientWidth,b.clientHeight),(document.body||document.documentElement).removeChild(b)},b.style.opacity=0,(document.body||document.documentElement).appendChild(b)}else{var e=(new Date).getTime()-k;if(!e)return c();k=(new Date).getTime(),l.frames.push({duration:e,image:a.toDataURL("image/webp")})}h&&setTimeout(c,0)}})}if("undefined"==typeof html2canvas)throw"Please link: //cdn.webrtc-experiment.com/screenshot.js";b=b||{};var d=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(a){a in document.createElement("canvas")&&(d=!0)});var e,f,g;d?(b.disableLogs||console.debug("Your browser supports both MediRecorder API and canvas.captureStream!"),e=document.createElement("canvas"),e.width=a.clientWidth||window.innerWidth,e.height=a.clientHeight||window.innerHeight,e.style="top: -9999999; left: -99999999; visibility:hidden; position:absoluted; display: none;",(document.body||document.documentElement).appendChild(e),f=e.getContext("2d")):navigator.mozGetUserMedia&&(b.disableLogs||alert("Canvas recording is NOT supported in Firefox."));var h;this.record=function(){if(d){var a;if("captureStream"in e?a=e.captureStream(25):"mozCaptureStream"in e?a=e.captureStream(25):"webkitCaptureStream"in e&&(a=e.captureStream(25)),!a)throw"captureStream API are NOT available.";g=new j(a,{mimeType:"video/webm"}),g.record()}h=!0,l.frames=[],c(),b.initCallback&&b.initCallback()},this.stop=function(a){if(h=!1,d&&g){return void g.stop(function(){for(var c in g)self[c]=g[c];a&&a(b.blob)})}var b=this;l.compile(function(c){b.blob=c,b.blob.forEach&&(b.blob=new Blob([],{type:"video/webm"})),a&&a(b.blob),l.frames=[]})};var i=!1;this.pause=function(){i=!0},this.resume=function(){i=!1},this.clearRecordedData=function(){this.pause(),l.frames=[]};var k=(new Date).getTime(),l=new z.Video(100)}function m(a,b){function c(a){a="undefined"!=typeof a?a:10;var b=(new Date).getTime()-i;return b?g?(i=(new Date).getTime(),setTimeout(c,100)):(i=(new Date).getTime(),h.paused&&h.play(),l.drawImage(h,0,0,k.width,k.height),j.frames.push({duration:b,image:k.toDataURL("image/webp")}),void(f||setTimeout(c,a,a))):setTimeout(c,a,a)}function d(a){var b=-1,c=a.length,d=function(){return b++,b===c?void a.callback():void a.functionToLoop(d,b)};d()}function e(a,b,c,e,f){var g=document.createElement("canvas");g.width=k.width,g.height=k.height;var h=g.getContext("2d"),i=[],j=-1===b,l=b&&b>0&&b<=a.length?b:a.length,m={r:0,g:0,b:0},n=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),o=c&&c>=0&&1>=c?c:0,p=e&&e>=0&&1>=e?e:0,q=!1;d({length:l,functionToLoop:function(b,c){var d,e,f,g=function(){!q&&f*p>=f-d||(j&&(q=!0),i.push(a[c])),b()};if(q)g();else{var l=new Image;l.onload=function(){h.drawImage(l,0,0,k.width,k.height);var a=h.getImageData(0,0,k.width,k.height);d=0,e=a.data.length,f=a.data.length/4;for(var b=0;e>b;b+=4){var c={r:a.data[b],g:a.data[b+1],b:a.data[b+2]},i=Math.sqrt(Math.pow(c.r-m.r,2)+Math.pow(c.g-m.g,2)+Math.pow(c.b-m.b,2));n*o>=i&&d++}g()},l.src=a[c].image}},callback:function(){i=i.concat(a.slice(l)),i.length<=0&&i.push(a[a.length-1]),f(i)}})}b=b||{},b.frameInterval||(b.frameInterval=10),b.disableLogs||console.log("Using frames-interval:",b.frameInterval),this.record=function(){b.width||(b.width=320),b.height||(b.height=240),b.video||(b.video={width:b.width,height:b.height}),b.canvas||(b.canvas={width:b.width,height:b.height}),k.width=b.canvas.width,k.height=b.canvas.height,l=k.getContext("2d"),b.video&&b.video instanceof HTMLVideoElement?(h=b.video.cloneNode(),b.initCallback&&b.initCallback()):(h=document.createElement("video"),"undefined"!=typeof h.srcObject?h.srcObject=a:h.src=t.createObjectURL(a),h.onloadedmetadata=function(){b.initCallback&&b.initCallback()},h.width=b.video.width,h.height=b.video.height),h.muted=!0,h.play(),i=(new Date).getTime(),j=new z.Video,b.disableLogs||(console.log("canvas resolutions",k.width,"*",k.height),console.log("video width/height",h.width||k.width,"*",h.height||k.height)),c(b.frameInterval)};var f=!1;this.stop=function(a){f=!0;var c=this;setTimeout(function(){e(j.frames,-1,null,null,function(d){j.frames=d,b.advertisement&&b.advertisement.length&&(j.frames=b.advertisement.concat(j.frames)),j.compile(function(b){c.blob=b,c.blob.forEach&&(c.blob=new Blob([],{type:"video/webm"})),a&&a(c.blob)})})},10)};var g=!1;this.pause=function(){g=!0},this.resume=function(){g=!1},this.clearRecordedData=function(){this.pause(),j.frames=[]};var h,i,j,k=document.createElement("canvas"),l=k.getContext("2d")}function n(a,b){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";b=b||{};var c=a instanceof CanvasRenderingContext2D||a instanceof HTMLCanvasElement;this.record=function(){function a(h){return d?setTimeout(function(){a(h)},100):(l=q(a),void 0===typeof j&&(j=h),void(90>h-j||(!c&&g.paused&&g.play(),f.drawImage(g,0,0,e.width,e.height),b.onGifPreview&&b.onGifPreview(e.toDataURL("image/png")),k.addFrame(f),j=h)))}c||(b.width||(b.width=g.offsetWidth||320),this.height||(b.height=g.offsetHeight||240),b.video||(b.video={width:b.width,height:b.height}),b.canvas||(b.canvas={width:b.width,height:b.height}),e.width=b.canvas.width,e.height=b.canvas.height,g.width=b.video.width,g.height=b.video.height),k=new GIFEncoder,k.setRepeat(0),k.setDelay(b.frameRate||200),k.setQuality(b.quality||10),k.start(),h=Date.now();l=q(a),b.initCallback&&b.initCallback()},this.stop=function(){l&&r(l),i=Date.now(),this.blob=new Blob([new Uint8Array(k.stream().bin)],{type:"image/gif"}),k.stream().bin=[]};var d=!1;this.pause=function(){d=!0},this.resume=function(){d=!1},this.clearRecordedData=function(){k&&(this.pause(),k.stream().bin=[])};var e=document.createElement("canvas"),f=e.getContext("2d");if(c&&(a instanceof CanvasRenderingContext2D?f=a:a instanceof HTMLCanvasElement&&(f=a.getContext("2d"))),!c){var g=document.createElement("video");g.muted=!0,g.autoplay=!0,"undefined"!=typeof g.srcObject?g.srcObject=a:g.src=t.createObjectURL(a),g.play()}var h,i,j,k,l=null}var o,p;d.getFromDisk=function(a,b){if(!b)throw"callback is mandatory.";console.log("Getting recorded "+("all"===a?"blobs":a+" blob ")+" from disk!"),A.Fetch(function(c,d){"all"!==a&&d===a+"Blob"&&b&&b(c),"all"===a&&b&&b(c,d.replace("Blob",""))})},d.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(b){a.video.getDataURL(function(c){a.gif.getDataURL(function(a){A.Store({audioBlob:b,videoBlob:c,gifBlob:a})})})}):a.audio&&a.video?a.audio.getDataURL(function(b){a.video.getDataURL(function(a){A.Store({audioBlob:b,videoBlob:a})})}):a.audio&&a.gif?a.audio.getDataURL(function(b){a.gif.getDataURL(function(a){A.Store({audioBlob:b,gifBlob:a})})}):a.video&&a.gif?a.video.getDataURL(function(b){a.gif.getDataURL(function(a){A.Store({videoBlob:b,gifBlob:a})})}):a.audio?a.audio.getDataURL(function(a){A.Store({audioBlob:a})}):a.video?a.video.getDataURL(function(a){A.Store({videoBlob:a})}):a.gif&&a.gif.getDataURL(function(a){A.Store({gifBlob:a})})},a.exports=d,o=[],p=function(){return d}.apply(b,o),!(void 0!==p&&(a.exports=p)),g.getFromDisk=d.getFromDisk,g.writeToDisk=d.writeToDisk;var q=window.requestAnimationFrame;"undefined"==typeof q&&("undefined"!=typeof webkitRequestAnimationFrame&&(q=webkitRequestAnimationFrame),"undefined"!=typeof mozRequestAnimationFrame&&(q=mozRequestAnimationFrame));var r=window.cancelAnimationFrame;"undefined"==typeof r&&("undefined"!=typeof webkitCancelAnimationFrame&&(r=webkitCancelAnimationFrame),"undefined"!=typeof mozCancelAnimationFrame&&(r=mozCancelAnimationFrame));var s=window.AudioContext;"undefined"==typeof s&&("undefined"!=typeof webkitAudioContext&&(s=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(s=mozAudioContext));var t=window.URL;if("undefined"==typeof t&&"undefined"!=typeof webkitURL&&(t=webkitURL),"undefined"==typeof navigator)throw'Please make sure to define a global variable named as "navigator"';"undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia);var u=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),v=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),w=!v&&!u&&!!navigator.webkitGetUserMedia,x=window.MediaStream;"undefined"==typeof x&&"undefined"!=typeof webkitMediaStream&&(x=webkitMediaStream),"undefined"==typeof x||"stop"in x.prototype||(x.prototype.stop=function(){this.getAudioTracks().forEach(function(a){a.stop()}),this.getVideoTracks().forEach(function(a){a.stop()})}),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var y={};"undefined"!=typeof s?y.AudioContext=s:"undefined"!=typeof webkitAudioContext&&(y.AudioContext=webkitAudioContext);var z=function(){function a(a){this.frames=[],this.duration=a||1,this.quality=.8}function b(a){var b=t.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return t.revokeObjectURL(b),c}function c(a){function b(a){var b=d(a);if(!b)return[];for(var e=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(b.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:b.width,id:176},{data:b.height,id:186}]}]}]}]}],g=0,i=0;g<a.length;){var j=[],k=0;do j.push(a[g]),k+=a[g].duration,g++;while(g<a.length&&e>k);var l=0,n={id:524531317,data:c(i,l,j)};f[1].data.push(n),i+=k}return h(f)}function c(a,b,c){return[{data:a,id:231}].concat(c.map(function(a){var c=i({discardable:0,frame:a.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(b)});return b+=a.duration,{data:c,id:163}}))}function d(a){if(!a[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var b=a[0].width,c=a[0].height,d=a[0].duration,e=1;e<a.length;e++)d+=a[e].duration;return{duration:d,width:b,height:c}}function e(a){for(var b=[];a>0;)b.push(255&a),a>>=8;return new Uint8Array(b.reverse())}function f(a){return new Uint8Array(a.split("").map(function(a){return a.charCodeAt(0)}))}function g(a){var b=[],c=a.length%8?new Array(9-a.length%8).join("0"):"";a=c+a;for(var d=0;d<a.length;d+=8)b.push(parseInt(a.substr(d,8),2));return new Uint8Array(b)}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].data;"object"==typeof d&&(d=h(d)),"number"==typeof d&&(d=g(d.toString(2))),"string"==typeof d&&(d=f(d));var i=d.size||d.byteLength||d.length,j=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),k=i.toString(2),l=new Array(7*j+7+1-k.length).join("0")+k,m=new Array(j).join("0")+"1"+l;b.push(e(a[c].id)),b.push(g(m)),b.push(d)}return new Blob(b,{type:"video/webm"})}function i(a){var b=0;if(a.keyframe&&(b|=128),a.invisible&&(b|=8),a.lacing&&(b|=a.lacing<<1),a.discardable&&(b|=1),a.trackNum>127)throw"TrackNumber > 127 not supported";var c=[128|a.trackNum,a.timecode>>8,255&a.timecode,b].map(function(a){return String.fromCharCode(a)}).join("")+a.frame;return c}function j(a){for(var b=a.RIFF[0].WEBP[0],c=b.indexOf("*"),d=0,e=[];4>d;d++)e[d]=b.charCodeAt(c+3+d);var f,g,h;return h=e[1]<<8|e[0],f=16383&h,h=e[3]<<8|e[2],g=16383&h,{width:f,height:g,data:b,riff:a}}function k(a,b){return parseInt(a.substr(b+4,4).split("").map(function(a){var b=a.charCodeAt(0).toString(2);return new Array(8-b.length+1).join("0")+b}).join(""),2)}function l(a){for(var b=0,c={};b<a.length;){var d=a.substr(b,4),e=k(a,b),f=a.substr(b+4+4,e);b+=8+e,c[d]=c[d]||[],"RIFF"===d||"LIST"===d?c[d].push(l(f)):c[d].push(f)}return c}function m(a){return[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map(function(a){return String.fromCharCode(a)}).reverse().join("")}var n=new b(a.map(function(a){var b=j(l(atob(a.image.slice(23))));return b.duration=a.duration,b}));return navigator.mozGetUserMedia?n:void postMessage(n)}return a.prototype.add=function(a,b){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:b||this.duration})},a.prototype.compile=function(a){if(navigator.mozGetUserMedia)return void a(c(this.frames));var d=b(c);d.onmessage=function(b){return b.data.error?void console.error(b.data.error):void a(b.data)},d.postMessage(this.frames)},{Video:a}}(),A={init:function(){function a(a){a.createObjectStore(c.dataStoreName)}function b(){function a(a){b.objectStore(c.dataStoreName).get(a).onsuccess=function(b){c.callback&&c.callback(b.target.result,a)}}var b=d.transaction([c.dataStoreName],"readwrite");c.videoBlob&&b.objectStore(c.dataStoreName).put(c.videoBlob,"videoBlob"),c.gifBlob&&b.objectStore(c.dataStoreName).put(c.gifBlob,"gifBlob"),c.audioBlob&&b.objectStore(c.dataStoreName).put(c.audioBlob,"audioBlob"),a("audioBlob"),a("videoBlob"),a("gifBlob")}var c=this;if("undefined"==typeof indexedDB||"undefined"==typeof indexedDB.open)return void console.error("IndexedDB API are not available in this browser.");"undefined"!=typeof webkitIndexedDB&&(indexedDB=webkitIndexedDB),"undefined"!=typeof mozIndexedDB&&(indexedDB=mozIndexedDB),"undefined"!=typeof OIndexedDB&&(indexedDB=OIndexedDB),"undefined"!=typeof msIndexedDB&&(indexedDB=msIndexedDB);var d,e=1,f=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),g=indexedDB.open(f,e);g.onerror=c.onError,g.onsuccess=function(){if(d=g.result,d.onerror=c.onError,d.setVersion)if(d.version!==e){var f=d.setVersion(e);f.onsuccess=function(){a(d),b()}}else b();else b()},g.onupgradeneeded=function(b){a(b.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null}},function(a,b,c){var d;(function(a,e,f){(function(){"use strict";function g(a){return"function"==typeof a||"object"==typeof a&&null!==a}function h(a){return"function"==typeof a}function i(a){return"object"==typeof a&&null!==a}function j(){}function k(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;
return-1}function l(a){var b=a._promiseCallbacks;return b||(b=a._promiseCallbacks={}),b}function m(a,b){return"onerror"===a?void Ba.on("error",b):2!==arguments.length?Ba[a]:void(Ba[a]=b)}function n(){setTimeout(function(){for(var a,b=0;b<Ca.length;b++){a=Ca[b];var c=a.payload;c.guid=c.key+c.id,c.childGuid=c.key+c.childId,c.error&&(c.stack=c.error.stack),Ba.trigger(a.name,a.payload)}Ca.length=0},50)}function o(a,b,c){1===Ca.push({name:a,payload:{key:b._guidKey,id:b._id,eventName:a,detail:b._result,childId:c&&c._id,label:b._label,timeStamp:ya(),error:Ba["instrument-with-stack"]?new Error(b._label):null}})&&n()}function p(){return new TypeError("A promises callback cannot return that same promise.")}function q(){}function r(a){try{return a.then}catch(b){return Ha.error=b,Ha}}function s(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function t(a,b,c){Ba.async(function(a){var d=!1,e=s(c,b,function(c){d||(d=!0,b!==c?w(a,c):y(a,c))},function(b){d||(d=!0,z(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,z(a,e))},a)}function u(a,b){b._state===Fa?y(a,b._result):b._state===Ga?(b._onError=null,z(a,b._result)):A(b,void 0,function(c){b!==c?w(a,c):y(a,c)},function(b){z(a,b)})}function v(a,b){if(b.constructor===a.constructor)u(a,b);else{var c=r(b);c===Ha?z(a,Ha.error):void 0===c?y(a,b):h(c)?t(a,b,c):y(a,b)}}function w(a,b){a===b?y(a,b):g(b)?v(a,b):y(a,b)}function x(a){a._onError&&a._onError(a._result),B(a)}function y(a,b){a._state===Ea&&(a._result=b,a._state=Fa,0===a._subscribers.length?Ba.instrument&&Da("fulfilled",a):Ba.async(B,a))}function z(a,b){a._state===Ea&&(a._state=Ga,a._result=b,Ba.async(x,a))}function A(a,b,c,d){var e=a._subscribers,f=e.length;a._onError=null,e[f]=b,e[f+Fa]=c,e[f+Ga]=d,0===f&&a._state&&Ba.async(B,a)}function B(a){var b=a._subscribers,c=a._state;if(Ba.instrument&&Da(c===Fa?"fulfilled":"rejected",a),0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?E(c,d,e,f):e(f);a._subscribers.length=0}}function C(){this.error=null}function D(a,b){try{return a(b)}catch(c){return Ia.error=c,Ia}}function E(a,b,c,d){var e,f,g,i,j=h(c);if(j){if(e=D(c,d),e===Ia?(i=!0,f=e.error,e=null):g=!0,b===e)return void z(b,p())}else e=d,g=!0;b._state!==Ea||(j&&g?w(b,e):i?z(b,f):a===Fa?y(b,e):a===Ga&&z(b,e))}function F(a,b){var c=!1;try{b(function(b){c||(c=!0,w(a,b))},function(b){c||(c=!0,z(a,b))})}catch(d){z(a,d)}}function G(a,b,c){return a===Fa?{state:"fulfilled",value:c}:{state:"rejected",reason:c}}function H(a,b,c,d){var e=this;e._instanceConstructor=a,e.promise=new a(q,d),e._abortOnReject=c,e._validateInput(b)?(e._input=b,e.length=b.length,e._remaining=b.length,e._init(),0===e.length?y(e.promise,e._result):(e.length=e.length||0,e._enumerate(),0===e._remaining&&y(e.promise,e._result))):z(e.promise,e._validationError())}function I(a,b){return new Ja(this,a,!0,b).promise}function J(a,b){function c(a){w(f,a)}function d(a){z(f,a)}var e=this,f=new e(q,b);if(!xa(a))return z(f,new TypeError("You must pass an array to race.")),f;for(var g=a.length,h=0;f._state===Ea&&g>h;h++)A(e.resolve(a[h]),void 0,c,d);return f}function K(a,b){var c=this;if(a&&"object"==typeof a&&a.constructor===c)return a;var d=new c(q,b);return w(d,a),d}function L(a,b){var c=this,d=new c(q,b);return z(d,a),d}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function O(a,b){var c=this;c._id=Pa++,c._label=b,c._state=void 0,c._result=void 0,c._subscribers=[],Ba.instrument&&Da("created",c),q!==a&&(h(a)||M(),c instanceof O||N(),F(c,a))}function P(a,b,c){this._superConstructor(a,b,!1,c)}function Q(a,b){return new P(Qa,a,b).promise}function R(a,b){return Qa.all(a,b)}function S(a,b){ab[Va]=a,ab[Va+1]=b,Va+=2,2===Va&&Sa()}function T(){var b=a.nextTick,c=a.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(c)&&"0"===c[1]&&"10"===c[2]&&(b=setImmediate),function(){b(Y)}}function U(){return function(){Ra(Y)}}function V(){var a=0,b=new Za(Y),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function W(){var a=new MessageChannel;return a.port1.onmessage=Y,function(){a.port2.postMessage(0)}}function X(){return function(){setTimeout(Y,1)}}function Y(){for(var a=0;Va>a;a+=2){var b=ab[a],c=ab[a+1];b(c),ab[a]=void 0,ab[a+1]=void 0}Va=0}function Z(){try{var a=c(9);return Ra=a.runOnLoop||a.runOnContext,U()}catch(b){return X()}}function $(a){var b={};return b.promise=new Qa(function(a,c){b.resolve=a,b.reject=c},a),b}function _(a,b,c){return Qa.all(a,c).then(function(a){if(!h(b))throw new TypeError("You must pass a function as filter's second argument.");for(var d=a.length,e=new Array(d),f=0;d>f;f++)e[f]=b(a[f]);return Qa.all(e,c).then(function(b){for(var c=new Array(d),e=0,f=0;d>f;f++)b[f]&&(c[e]=a[f],e++);return c.length=e,c})})}function aa(a,b,c){this._superConstructor(a,b,!0,c)}function ba(a,b,c){this._superConstructor(a,b,!1,c)}function ca(a,b){return new ba(Qa,a,b).promise}function da(a,b){return new db(Qa,a,b).promise}function ea(a,b,c){return Qa.all(a,c).then(function(a){if(!h(b))throw new TypeError("You must pass a function as map's second argument.");for(var d=a.length,e=new Array(d),f=0;d>f;f++)e[f]=b(a[f]);return Qa.all(e,c)})}function fa(){this.value=void 0}function ga(a){try{return a.then}catch(b){return ib.value=b,ib}}function ha(a,b,c){try{a.apply(b,c)}catch(d){return ib.value=d,ib}}function ia(a,b){for(var c,d,e={},f=a.length,g=new Array(f),h=0;f>h;h++)g[h]=a[h];for(d=0;d<b.length;d++)c=b[d],e[c]=g[d+1];return e}function ja(a){for(var b=a.length,c=new Array(b-1),d=1;b>d;d++)c[d-1]=a[d];return c}function ka(a,b){return{then:function(c,d){return a.call(b,c,d)}}}function la(a,b){var c=function(){for(var c,d=this,e=arguments.length,f=new Array(e+1),g=!1,h=0;e>h;++h){if(c=arguments[h],!g){if(g=oa(c),g===jb){var i=new Qa(q);return z(i,jb.value),i}g&&g!==!0&&(c=ka(g,c))}f[h]=c}var j=new Qa(q);return f[e]=function(a,c){a?z(j,a):void 0===b?w(j,c):b===!0?w(j,ja(arguments)):xa(b)?w(j,ia(arguments,b)):w(j,c)},g?na(j,f,a,d):ma(j,f,a,d)};return c.__proto__=a,c}function ma(a,b,c,d){var e=ha(c,d,b);return e===ib&&z(a,e.value),a}function na(a,b,c,d){return Qa.all(b).then(function(b){var e=ha(c,d,b);return e===ib&&z(a,e.value),a})}function oa(a){return a&&"object"==typeof a?a.constructor===Qa?!0:ga(a):!1}function pa(a,b){return Qa.race(a,b)}function qa(a,b){return Qa.reject(a,b)}function ra(a,b){return Qa.resolve(a,b)}function sa(a){throw setTimeout(function(){throw a}),a}function ta(a,b){Ba.async(a,b)}function ua(){Ba.on.apply(Ba,arguments)}function va(){Ba.off.apply(Ba,arguments)}var wa;wa=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var xa=wa,ya=Date.now||function(){return(new Date).getTime()},za=Object.create||function(a){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof a)throw new TypeError("Argument must be an object");return j.prototype=a,new j},Aa={mixin:function(a){return a.on=this.on,a.off=this.off,a.trigger=this.trigger,a._promiseCallbacks=void 0,a},on:function(a,b){if("function"!=typeof b)throw new TypeError("Callback must be a function");var c,d=l(this);c=d[a],c||(c=d[a]=[]),-1===k(c,b)&&c.push(b)},off:function(a,b){var c,d,e=l(this);return b?(c=e[a],d=k(c,b),void(-1!==d&&c.splice(d,1))):void(e[a]=[])},trigger:function(a,b,c){var d,e,f=l(this);if(d=f[a])for(var g=0;g<d.length;g++)(e=d[g])(b,c)}},Ba={instrument:!1};Aa.mixin(Ba);var Ca=[],Da=o,Ea=void 0,Fa=1,Ga=2,Ha=new C,Ia=new C,Ja=H;H.prototype._validateInput=function(a){return xa(a)},H.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},H.prototype._init=function(){this._result=new Array(this.length)},H.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===Ea&&b>e;e++)a._eachEntry(d[e],e)},H.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;i(a)?a.constructor===d&&a._state!==Ea?(a._onError=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=c._makeResult(Fa,b,a))},H.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===Ea&&(d._remaining--,d._abortOnReject&&a===Ga?z(e,c):d._result[b]=d._makeResult(a,b,c)),0===d._remaining&&y(e,d._result)},H.prototype._makeResult=function(a,b,c){return c},H.prototype._willSettleAt=function(a,b){var c=this;A(a,void 0,function(a){c._settledAt(Fa,b,a)},function(a){c._settledAt(Ga,b,a)})};var Ka=I,La=J,Ma=K,Na=L,Oa="rsvp_"+ya()+"-",Pa=0,Qa=O;O.cast=Ma,O.all=Ka,O.race=La,O.resolve=Ma,O.reject=Na,O.prototype={constructor:O,_guidKey:Oa,_onError:function(a){var b=this;Ba.after(function(){b._onError&&Ba.trigger("error",a,b._label)})},then:function(a,b,c){var d=this,e=d._state;if(e===Fa&&!a||e===Ga&&!b)return Ba.instrument&&Da("chained",d,d),d;d._onError=null;var f=new d.constructor(q,c),g=d._result;if(Ba.instrument&&Da("chained",d,f),e){var h=arguments[e-1];Ba.async(function(){E(e,f,h,g)})}else A(d,f,a,b);return f},"catch":function(a,b){return this.then(void 0,a,b)},"finally":function(a,b){var c=this,d=c.constructor;return c.then(function(b){return d.resolve(a()).then(function(){return b})},function(b){return d.resolve(a()).then(function(){throw b})},b)}},P.prototype=za(Ja.prototype),P.prototype._superConstructor=Ja,P.prototype._makeResult=G,P.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Ra,Sa,Ta=Q,Ua=R,Va=0,Wa=({}.toString,S),Xa="undefined"!=typeof window?window:void 0,Ya=Xa||{},Za=Ya.MutationObserver||Ya.WebKitMutationObserver,$a="undefined"==typeof self&&"undefined"!=typeof a&&"[object process]"==={}.toString.call(a),_a="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ab=new Array(1e3);Sa=$a?T():Za?V():_a?W():void 0===Xa?Z():X();var bb=$,cb=_,db=aa;aa.prototype=za(Ja.prototype),aa.prototype._superConstructor=Ja,aa.prototype._init=function(){this._result={}},aa.prototype._validateInput=function(a){return a&&"object"==typeof a},aa.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},aa.prototype._enumerate=function(){var a=this,b=a.promise,c=a._input,d=[];for(var e in c)b._state===Ea&&Object.prototype.hasOwnProperty.call(c,e)&&d.push({position:e,entry:c[e]});var f=d.length;a._remaining=f;for(var g,h=0;b._state===Ea&&f>h;h++)g=d[h],a._eachEntry(g.entry,g.position)},ba.prototype=za(db.prototype),ba.prototype._superConstructor=Ja,ba.prototype._makeResult=G,ba.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var eb,fb=ca,gb=da,hb=ea,ib=new fa,jb=new fa,kb=la;if("object"==typeof self)eb=self;else{if("object"!=typeof e)throw new Error("no global: `self` or `global` found");eb=e}var lb=eb,mb=pa,nb=qa,ob=ra,pb=sa;Ba.async=Wa,Ba.after=function(a){setTimeout(a,0)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var qb=window.__PROMISE_INSTRUMENTATION__;m("instrument",!0);for(var rb in qb)qb.hasOwnProperty(rb)&&ua(rb,qb[rb])}var sb={race:mb,Promise:Qa,allSettled:Ta,hash:gb,hashSettled:fb,denodeify:kb,on:ua,off:va,map:hb,filter:cb,resolve:ob,reject:nb,all:Ua,rethrow:pb,defer:bb,EventTarget:Aa,configure:m,async:ta};c(12).amd?(d=function(){return sb}.call(b,c,b,f),!(void 0!==d&&(f.exports=d))):"undefined"!=typeof f&&f.exports?f.exports=sb:"undefined"!=typeof lb&&(lb.RSVP=sb)}).call(this)}).call(b,c(11),function(){return this}(),c(13)(a))},function(a,b,c){"use strict";function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}a.exports={capitalize:d}},function(a,b,c){(function(b){function c(){function a(a){return new Int8Array(a)}function b(a){return new Int16Array(a)}function c(a){return new Int32Array(a)}function d(a){return new Float32Array(a)}function e(a){return new Float64Array(a)}function f(a){if(1==a.length)return d(a[0]);var b=a[0];a=a.slice(1);for(var c=[],e=0;b>e;e++)c.push(f(a));return c}function g(a){if(1==a.length)return c(a[0]);var b=a[0];a=a.slice(1);for(var d=[],e=0;b>e;e++)d.push(g(a));return d}function h(a){if(1==a.length)return b(a[0]);var c=a[0];a=a.slice(1);for(var d=[],e=0;c>e;e++)d.push(h(a));return d}function i(a){if(1==a.length)return new Array(a[0]);var b=a[0];a=a.slice(1);for(var c=[],d=0;b>d;d++)c.push(i(a));return c}function j(a){this.ordinal=a}function k(a){this.ordinal=a}function l(a){var b=a;this.ordinal=function(){return b}}function m(){var a="http://www.mp3dev.org/",b=3,c=98,d=4,e=0,f=93;this.getLameVersion=function(){return b+"."+c+"."+d},this.getLameShortVersion=function(){return b+"."+c+"."+d},this.getLameVeryShortVersion=function(){return"LAME"+b+"."+c+"r"},this.getPsyVersion=function(){return e+"."+f},this.getLameUrl=function(){return a},this.getLameOsBitness=function(){return"32bits"}}function n(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.vbr_q=a,this.quant_comp=b,this.quant_comp_s=c,this.expY=d,this.st_lrm=e,this.st_s=f,this.masking_adj=g,this.masking_adj_short=h,this.ath_lower=i,this.ath_curve=j,this.ath_sensitivity=k,this.interch=l,this.safejoint=m,this.sfb21mod=n,this.msfix=o}function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.quant_comp=b,this.quant_comp_s=c,this.safejoint=d,this.nsmsfix=e,this.st_lrm=f,this.st_s=g,this.nsbass=h,this.scale=i,this.masking_adj=j,this.ath_lower=k,this.ath_curve=l,this.interch=m,this.sfscale=n}function c(a,b,c){var d=a.VBR==k.vbr_rh?g:h,f=a.VBR_q_frac,i=d[b],j=d[b+1],l=i;i.st_lrm=i.st_lrm+f*(j.st_lrm-i.st_lrm),i.st_s=i.st_s+f*(j.st_s-i.st_s),i.masking_adj=i.masking_adj+f*(j.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+f*(j.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+f*(j.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+f*(j.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+f*(j.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+f*(j.interch-i.interch),i.msfix=i.msfix+f*(j.msfix-i.msfix),e(a,l.vbr_q),0!=c?a.quant_comp=l.quant_comp:Math.abs(a.quant_comp- -1)>0||(a.quant_comp=l.quant_comp),0!=c?a.quant_comp_short=l.quant_comp_s:Math.abs(a.quant_comp_short- -1)>0||(a.quant_comp_short=l.quant_comp_s),0!=l.expY&&(a.experimentalY=0!=l.expY),0!=c?a.internal_flags.nsPsy.attackthre=l.st_lrm:Math.abs(a.internal_flags.nsPsy.attackthre- -1)>0||(a.internal_flags.nsPsy.attackthre=l.st_lrm),0!=c?a.internal_flags.nsPsy.attackthre_s=l.st_s:Math.abs(a.internal_flags.nsPsy.attackthre_s- -1)>0||(a.internal_flags.nsPsy.attackthre_s=l.st_s),0!=c?a.maskingadjust=l.masking_adj:Math.abs(a.maskingadjust-0)>0||(a.maskingadjust=l.masking_adj),0!=c?a.maskingadjust_short=l.masking_adj_short:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=l.masking_adj_short),0!=c?a.ATHlower=-l.ath_lower/10:Math.abs(10*-a.ATHlower-0)>0||(a.ATHlower=-l.ath_lower/10),0!=c?a.ATHcurve=l.ath_curve:Math.abs(a.ATHcurve- -1)>0||(a.ATHcurve=l.ath_curve),0!=c?a.athaa_sensitivity=l.ath_sensitivity:Math.abs(a.athaa_sensitivity- -1)>0||(a.athaa_sensitivity=l.ath_sensitivity),l.interch>0&&(0!=c?a.interChRatio=l.interch:Math.abs(a.interChRatio- -1)>0||(a.interChRatio=l.interch)),l.safejoint>0&&(a.exp_nspsytune=a.exp_nspsytune|l.safejoint),l.sfb21mod>0&&(a.exp_nspsytune=a.exp_nspsytune|l.sfb21mod<<20),0!=c?a.msfix=l.msfix:Math.abs(a.msfix- -1)>0||(a.msfix=l.msfix),0==c&&(a.VBR_q=b,a.VBR_q_frac=f)}function d(a,b,c){var d=b,e=f.nearestBitrateFullIndex(b);if(a.VBR=k.vbr_abr,a.VBR_mean_bitrate_kbps=d,a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320),a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.brate=a.VBR_mean_bitrate_kbps,a.VBR_mean_bitrate_kbps>320&&(a.disable_reservoir=!0),i[e].safejoint>0&&(a.exp_nspsytune=2|a.exp_nspsytune),i[e].sfscale>0&&(a.internal_flags.noise_shaping=2),Math.abs(i[e].nsbass)>0){var g=int(4*i[e].nsbass);0>g&&(g+=64),a.exp_nspsytune=a.exp_nspsytune|g<<2}return 0!=c?a.quant_comp=i[e].quant_comp:Math.abs(a.quant_comp- -1)>0||(a.quant_comp=i[e].quant_comp),0!=c?a.quant_comp_short=i[e].quant_comp_s:Math.abs(a.quant_comp_short- -1)>0||(a.quant_comp_short=i[e].quant_comp_s),0!=c?a.msfix=i[e].nsmsfix:Math.abs(a.msfix- -1)>0||(a.msfix=i[e].nsmsfix),0!=c?a.internal_flags.nsPsy.attackthre=i[e].st_lrm:Math.abs(a.internal_flags.nsPsy.attackthre- -1)>0||(a.internal_flags.nsPsy.attackthre=i[e].st_lrm),0!=c?a.internal_flags.nsPsy.attackthre_s=i[e].st_s:Math.abs(a.internal_flags.nsPsy.attackthre_s- -1)>0||(a.internal_flags.nsPsy.attackthre_s=i[e].st_s),0!=c?a.scale=i[e].scale:Math.abs(a.scale- -1)>0||(a.scale=i[e].scale),0!=c?a.maskingadjust=i[e].masking_adj:Math.abs(a.maskingadjust-0)>0||(a.maskingadjust=i[e].masking_adj),i[e].masking_adj>0?0!=c?a.maskingadjust_short=.9*i[e].masking_adj:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=.9*i[e].masking_adj):0!=c?a.maskingadjust_short=1.1*i[e].masking_adj:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=1.1*i[e].masking_adj),0!=c?a.ATHlower=-i[e].ath_lower/10:Math.abs(10*-a.ATHlower-0)>0||(a.ATHlower=-i[e].ath_lower/10),0!=c?a.ATHcurve=i[e].ath_curve:Math.abs(a.ATHcurve- -1)>0||(a.ATHcurve=i[e].ath_curve),0!=c?a.interChRatio=i[e].interch:Math.abs(a.interChRatio- -1)>0||(a.interChRatio=i[e].interch),b}function e(a,b){var c=0;return 0>b&&(c=-1,b=0),b>9&&(c=-1,b=9),a.VBR_q=b,a.VBR_q_frac=0,c}var f;this.setModules=function(a){f=a};var g=[new a(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new a(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new a(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new a(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new a(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new a(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new a(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new a(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new a(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new a(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new a(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],h=[new a(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new a(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new a(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new a(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new a(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new a(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new a(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new a(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new a(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new a(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new a(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)],i=[new b(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new b(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new b(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new b(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new b(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new b(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new b(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new b(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new b(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new b(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new b(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new b(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new b(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new b(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new b(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new b(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new b(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(a,b,e){switch(b){case Q.R3MIX:b=Q.V3,a.VBR=k.vbr_mtrh;break;case Q.MEDIUM:b=Q.V4,a.VBR=k.vbr_rh;break;case Q.MEDIUM_FAST:b=Q.V4,a.VBR=k.vbr_mtrh;break;case Q.STANDARD:b=Q.V2,a.VBR=k.vbr_rh;break;case Q.STANDARD_FAST:b=Q.V2,a.VBR=k.vbr_mtrh;break;case Q.EXTREME:b=Q.V0,a.VBR=k.vbr_rh;break;case Q.EXTREME_FAST:b=Q.V0,a.VBR=k.vbr_mtrh;break;case Q.INSANE:return b=320,a.preset=b,d(a,b,e),a.VBR=k.vbr_off,b}switch(a.preset=b,b){case Q.V9:return c(a,9,e),b;case Q.V8:return c(a,8,e),b;case Q.V7:return c(a,7,e),b;case Q.V6:return c(a,6,e),b;case Q.V5:return c(a,5,e),b;case Q.V4:return c(a,4,e),b;case Q.V3:return c(a,3,e),b;case Q.V2:return c(a,2,e),b;case Q.V1:return c(a,1,e),b;case Q.V0:return c(a,0,e),b}return b>=8&&320>=b?d(a,b,e):(a.preset=0,b)}}function o(){function a(a,b,c,d,e,f){for(;0!=e--;)c[d]=1e-10+a[b+0]*f[0]-c[d-1]*f[1]+a[b-1]*f[2]-c[d-2]*f[3]+a[b-2]*f[4]-c[d-3]*f[5]+a[b-3]*f[6]-c[d-4]*f[7]+a[b-4]*f[8]-c[d-5]*f[9]+a[b-5]*f[10]-c[d-6]*f[11]+a[b-6]*f[12]-c[d-7]*f[13]+a[b-7]*f[14]-c[d-8]*f[15]+a[b-8]*f[16]-c[d-9]*f[17]+a[b-9]*f[18]-c[d-10]*f[19]+a[b-10]*f[20],++d,++b}function b(a,b,c,d,e,f){for(;0!=e--;)c[d]=a[b+0]*f[0]-c[d-1]*f[1]+a[b-1]*f[2]-c[d-2]*f[3]+a[b-2]*f[4],++d,++b}function c(a,b){for(var c=0;c<MAX_ORDER;c++)a.linprebuf[c]=a.lstepbuf[c]=a.loutbuf[c]=a.rinprebuf[c]=a.rstepbuf[c]=a.routbuf[c]=0;switch(0|b){case 48e3:a.reqindex=0;break;case 44100:a.reqindex=1;break;case 32e3:a.reqindex=2;break;case 24e3:a.reqindex=3;break;case 22050:a.reqindex=4;break;case 16e3:a.reqindex=5;break;case 12e3:a.reqindex=6;break;case 11025:a.reqindex=7;break;case 8e3:a.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return a.sampleWindow=0|(b*h+i-1)/i,a.lsum=0,a.rsum=0,a.totsamp=0,Y.ill(a.A,0),INIT_GAIN_ANALYSIS_OK}function d(a){return a*a}function e(a,b){var c,d=0;for(c=0;b>c;c++)d+=a[c];if(0==d)return GAIN_NOT_ENOUGH_SAMPLES;var e=0|Math.ceil(d*(1-g));for(c=b;c-- >0&&!((e-=a[c])<=0););return f-c/o.STEPS_per_dB}var f=64.82,g=(o.YULE_ORDER,.95),h=(o.MAX_SAMP_FREQ,o.RMS_WINDOW_TIME_NUMERATOR),i=o.RMS_WINDOW_TIME_DENOMINATOR,j=(o.MAX_SAMPLES_PER_WINDOW,[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]]),k=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(a,b){return c(a,b)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(a.linpre=MAX_ORDER,a.rinpre=MAX_ORDER,a.lstep=MAX_ORDER,a.rstep=MAX_ORDER,a.lout=MAX_ORDER,a.rout=MAX_ORDER,Y.fill(a.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(c,e,f,g,h,i,l){var m,n,p,q,r,s,t;if(0==i)return GAIN_ANALYSIS_OK;switch(t=0,r=i,l){case 1:g=e,h=f;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(i<MAX_ORDER?(Z.arraycopy(e,f,c.linprebuf,MAX_ORDER,i),Z.arraycopy(g,h,c.rinprebuf,MAX_ORDER,i)):(Z.arraycopy(e,f,c.linprebuf,MAX_ORDER,MAX_ORDER),Z.arraycopy(g,h,c.rinprebuf,MAX_ORDER,MAX_ORDER));r>0;){s=r>c.sampleWindow-c.totsamp?c.sampleWindow-c.totsamp:r,t<MAX_ORDER?(m=c.linpre+t,n=c.linprebuf,p=c.rinpre+t,q=c.rinprebuf,s>MAX_ORDER-t&&(s=MAX_ORDER-t)):(m=f+t,n=e,p=h+t,q=g),a(n,m,c.lstepbuf,c.lstep+c.totsamp,s,j[c.reqindex]),a(q,p,c.rstepbuf,c.rstep+c.totsamp,s,j[c.reqindex]),b(c.lstepbuf,c.lstep+c.totsamp,c.loutbuf,c.lout+c.totsamp,s,k[c.reqindex]),b(c.rstepbuf,c.rstep+c.totsamp,c.routbuf,c.rout+c.totsamp,s,k[c.reqindex]),m=c.lout+c.totsamp,n=c.loutbuf,p=c.rout+c.totsamp,q=c.routbuf;for(var u=s%8;0!=u--;)c.lsum+=d(n[m++]),c.rsum+=d(q[p++]);for(u=s/8;0!=u--;)c.lsum+=d(n[m+0])+d(n[m+1])+d(n[m+2])+d(n[m+3])+d(n[m+4])+d(n[m+5])+d(n[m+6])+d(n[m+7]),m+=8,c.rsum+=d(q[p+0])+d(q[p+1])+d(q[p+2])+d(q[p+3])+d(q[p+4])+d(q[p+5])+d(q[p+6])+d(q[p+7]),p+=8;if(r-=s,t+=s,c.totsamp+=s,c.totsamp==c.sampleWindow){var v=10*o.STEPS_per_dB*Math.log10((c.lsum+c.rsum)/c.totsamp*.5+1e-37),w=0>=v?0:0|v;w>=c.A.length&&(w=c.A.length-1),c.A[w]++,c.lsum=c.rsum=0,Z.arraycopy(c.loutbuf,c.totsamp,c.loutbuf,0,MAX_ORDER),Z.arraycopy(c.routbuf,c.totsamp,c.routbuf,0,MAX_ORDER),Z.arraycopy(c.lstepbuf,c.totsamp,c.lstepbuf,0,MAX_ORDER),Z.arraycopy(c.rstepbuf,c.totsamp,c.rstepbuf,0,MAX_ORDER),c.totsamp=0}if(c.totsamp>c.sampleWindow)return GAIN_ANALYSIS_ERROR}return i<MAX_ORDER?(Z.arraycopy(c.linprebuf,i,c.linprebuf,0,MAX_ORDER-i),Z.arraycopy(c.rinprebuf,i,c.rinprebuf,0,MAX_ORDER-i),Z.arraycopy(e,f,c.linprebuf,MAX_ORDER-i,i),Z.arraycopy(g,h,c.rinprebuf,MAX_ORDER-i,i)):(Z.arraycopy(e,f+i-MAX_ORDER,c.linprebuf,0,MAX_ORDER),Z.arraycopy(g,h+i-MAX_ORDER,c.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(a){for(var b=e(a.A,a.A.length),c=0;c<a.A.length;c++)a.B[c]+=a.A[c],a.A[c]=0;for(var c=0;c<MAX_ORDER;c++)a.linprebuf[c]=a.lstepbuf[c]=a.loutbuf[c]=a.rinprebuf[c]=a.rstepbuf[c]=a.routbuf[c]=0;return a.totsamp=0,a.lsum=a.rsum=0,b}}function p(){function a(a){this.bits=0|a}function b(a,b,c,d,e,f){var g=.5946/b;for(a>>=1;0!=a--;)e[f++]=g>c[d++]?0:1,e[f++]=g>c[d++]?0:1}function d(a,b,c,d,e,f){a>>=1;var g=a%2;for(a>>=1;0!=a--;){var h,i,j,k,l,m,n,p;h=c[d++]*b,i=c[d++]*b,l=0|h,j=c[d++]*b,m=0|i,k=c[d++]*b,n=0|j,h+=o.adj43[l],p=0|k,i+=o.adj43[m],e[f++]=0|h,j+=o.adj43[n],e[f++]=0|i,k+=o.adj43[p],e[f++]=0|j,e[f++]=0|k}if(0!=g){var h,i,l,m;h=c[d++]*b,i=c[d++]*b,l=0|h,m=0|i,h+=o.adj43[l],i+=o.adj43[m],e[f++]=0|h,e[f++]=0|i}}function e(a,c,e,f,g){var h,i,j,k=0,l=0,m=0,n=0,p=c,q=0,r=p,s=0,t=a,u=0;for(j=null!=g&&f.global_gain==g.global_gain,i=f.block_type==I.SHORT_TYPE?38:21,h=0;i>=h;h++){var v=-1;if((j||f.block_type==I.NORM_TYPE)&&(v=f.global_gain-(f.scalefac[h]+(0!=f.preflag?o.pretab[h]:0)<<f.scalefac_scale+1)-8*f.subblock_gain[f.window[h]]),j&&g.step[h]==v)0!=l&&(d(l,e,t,u,r,s),l=0),0!=m&&(b(m,e,t,u,r,s),m=0);else{var w=f.width[h];if(k+f.width[h]>f.max_nonzero_coeff){var x;x=f.max_nonzero_coeff-k+1,Y.fill(c,f.max_nonzero_coeff,576,0),w=x,0>w&&(w=0),h=i+1}if(0==l&&0==m&&(r=p,s=q,t=a,u=n),null!=g&&g.sfb_count1>0&&h>=g.sfb_count1&&g.step[h]>0&&v>=g.step[h]?(0!=l&&(d(l,e,t,u,r,s),l=0,r=p,s=q,t=a,u=n),m+=w):(0!=m&&(b(m,e,t,u,r,s),m=0,r=p,s=q,t=a,u=n),l+=w),0>=w){0!=m&&(b(m,e,t,u,r,s),m=0),0!=l&&(d(l,e,t,u,r,s),l=0);break}}i>=h&&(q+=f.width[h],n+=f.width[h],k+=f.width[h])}0!=l&&(d(l,e,t,u,r,s),l=0),0!=m&&(b(m,e,t,u,r,s),m=0)}function f(a,b,c){var d=0,e=0;do{var f=a[b++],g=a[b++];f>d&&(d=f),g>e&&(e=g)}while(c>b);return e>d&&(d=e),d}function g(a,b,c,d,e,f){var g,h=65536*aa.ht[d].xlen+aa.ht[e].xlen,i=0;do{var j=a[b++],k=a[b++];0!=j&&(j>14&&(j=15,i+=h),j*=16),0!=k&&(k>14&&(k=15,i+=h),j+=k),i+=aa.largetbl[j]}while(c>b);return g=65535&i,i>>=16,i>g&&(i=g,d=e),f.bits+=i,d}function h(a,b,c,d){var e=0,f=aa.ht[1].hlen;do{var g=2*a[b+0]+a[b+1];b+=2,e+=f[g]}while(c>b);return d.bits+=e,1}function i(a,b,c,d,e){var f,g,h=0,i=aa.ht[d].xlen;g=2==d?aa.table23:aa.table56;do{var j=a[b+0]*i+a[b+1];b+=2,h+=g[j]}while(c>b);return f=65535&h,h>>=16,h>f&&(h=f,d++),e.bits+=h,d}function j(a,b,c,d,e){var f=0,g=0,h=0,i=aa.ht[d].xlen,j=aa.ht[d].hlen,k=aa.ht[d+1].hlen,l=aa.ht[d+2].hlen;do{var m=a[b+0]*i+a[b+1];b+=2,f+=j[m],g+=k[m],h+=l[m]}while(c>b);var n=d;return f>g&&(f=g,n++),f>h&&(f=h,n=d+2),e.bits+=f,n}function k(a,b,c,d){var e=f(a,b,c);switch(e){case 0:return e;case 1:return h(a,b,c,d);case 2:case 3:return i(a,b,c,r[e-1],d);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return j(a,b,c,r[e-1],d);default:if(e>C.IXMAX_VAL)return d.bits=C.LARGE_BITS,-1;e-=15;var k;for(k=24;32>k&&!(aa.ht[k].linmax>=e);k++);var l;for(l=k-8;24>l&&!(aa.ht[l].linmax>=e);l++);return g(a,b,c,l,k,d)}}function l(b,c,d,e,f,g,h){for(var i=c.big_values,j=0;22>=j;j++)e[j]=C.LARGE_BITS;for(var j=0;16>j;j++){var l=b.scalefac_band.l[j+1];if(l>=i)break;var m=0,n=new a(m),o=k(d,0,l,n);m=n.bits;for(var p=0;8>p;p++){var q=b.scalefac_band.l[j+p+2];if(q>=i)break;var r=m;n=new a(r);var s=k(d,l,q,n);r=n.bits,e[j+p]>r&&(e[j+p]=r,f[j+p]=j,g[j+p]=o,h[j+p]=s)}}}function m(b,c,d,e,f,g,h,i){for(var j=c.big_values,l=2;l<I.SBMAX_l+1;l++){var m=b.scalefac_band.l[l];if(m>=j)break;var n=f[l-2]+c.count1bits;if(d.part2_3_length<=n)break;var o=new a(n),p=k(e,m,j,o);n=o.bits,d.part2_3_length<=n||(d.assign(c),d.part2_3_length=n,d.region0_count=g[l-2],d.region1_count=l-2-g[l-2],d.table_select[0]=h[l-2],d.table_select[1]=i[l-2],d.table_select[2]=p)}}function n(a,b){for(var c,d=b.tt[1][a],e=b.tt[0][a],f=0;f<aa.scfsi_band.length-1;f++){for(c=aa.scfsi_band[f];c<aa.scfsi_band[f+1]&&!(e.scalefac[c]!=d.scalefac[c]&&d.scalefac[c]>=0);c++);if(c==aa.scfsi_band[f+1]){for(c=aa.scfsi_band[f];c<aa.scfsi_band[f+1];c++)d.scalefac[c]=-1;b.scfsi[a][f]=1}}var g=0,h=0;for(c=0;11>c;c++)-1!=d.scalefac[c]&&(h++,g<d.scalefac[c]&&(g=d.scalefac[c]));for(var i=0,j=0;c<I.SBPSY_l;c++)-1!=d.scalefac[c]&&(j++,i<d.scalefac[c]&&(i=d.scalefac[c]));for(var f=0;16>f;f++)if(g<s[f]&&i<t[f]){var k=u[f]*h+v[f]*j;d.part2_length>k&&(d.part2_length=k,d.scalefac_compress=f)}}var o=null;this.qupvt=null,this.setModules=function(a){
this.qupvt=a,o=a};var q=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],r=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(b,c,d){var e=c.l3_enc,f=Math.min(576,c.max_nonzero_coeff+2>>1<<1);for(null!=d&&(d.sfb_count1=0);f>1&&0==(e[f-1]|e[f-2]);f-=2);c.count1=f;for(var g=0,h=0;f>3;f-=4){var i;if((2147483647&(e[f-1]|e[f-2]|e[f-3]|e[f-4]))>1)break;i=2*(2*(2*e[f-4]+e[f-3])+e[f-2])+e[f-1],g+=aa.t32l[i],h+=aa.t33l[i]}var j=g;if(c.count1table_select=0,g>h&&(j=h,c.count1table_select=1),c.count1bits=j,c.big_values=f,0==f)return j;if(c.block_type==I.SHORT_TYPE)g=3*b.scalefac_band.s[3],g>c.big_values&&(g=c.big_values),h=c.big_values;else if(c.block_type==I.NORM_TYPE){if(g=c.region0_count=b.bv_scf[f-2],h=c.region1_count=b.bv_scf[f-1],h=b.scalefac_band.l[g+h+2],g=b.scalefac_band.l[g+1],f>h){var l=new a(j);c.table_select[2]=k(e,h,f,l),j=l.bits}}else c.region0_count=7,c.region1_count=I.SBMAX_l-1-7-1,g=b.scalefac_band.l[8],h=f,g>h&&(g=h);if(g=Math.min(g,f),h=Math.min(h,f),g>0){var l=new a(j);c.table_select[0]=k(e,0,g,l),j=l.bits}if(h>g){var l=new a(j);c.table_select[1]=k(e,g,h,l),j=l.bits}if(2==b.use_best_huffman&&(c.part2_3_length=j,best_huffman_divide(b,c),j=c.part2_3_length),null!=d&&c.block_type==I.NORM_TYPE){for(var m=0;b.scalefac_band.l[m]<c.big_values;)m++;d.sfb_count1=m}return j},this.count_bits=function(a,b,c,d){var f=c.l3_enc,g=C.IXMAX_VAL/o.IPOW20(c.global_gain);if(c.xrpow_max>g)return C.LARGE_BITS;if(e(b,f,o.IPOW20(c.global_gain),c,d),0!=(2&a.substep_shaping))for(var h=0,i=c.global_gain+c.scalefac_scale,j=.634521682242439/o.IPOW20(i),k=0;k<c.sfbmax;k++){var l=c.width[k];if(0==a.pseudohalf[k])h+=l;else{var m;for(m=h,h+=l;h>m;++m)f[m]=b[m]>=j?f[m]:0}}return this.noquant_count_bits(a,c,d)},this.best_huffman_divide=function(b,d){var e=new E,f=d.l3_enc,g=c(23),h=c(23),i=c(23),j=c(23);if(d.block_type!=I.SHORT_TYPE||1!=b.mode_gr){e.assign(d),d.block_type==I.NORM_TYPE&&(l(b,d,f,g,h,i,j),m(b,e,d,f,g,h,i,j));var n=e.big_values;if(!(0==n||(f[n-2]|f[n-1])>1||(n=d.count1+2,n>576))){e.assign(d),e.count1=n;for(var o=0,p=0;n>e.big_values;n-=4){var q=2*(2*(2*f[n-4]+f[n-3])+f[n-2])+f[n-1];o+=aa.t32l[q],p+=aa.t33l[q]}if(e.big_values=n,e.count1table_select=0,o>p&&(o=p,e.count1table_select=1),e.count1bits=o,e.block_type==I.NORM_TYPE)m(b,e,d,f,g,h,i,j);else{if(e.part2_3_length=o,o=b.scalefac_band.l[8],o>n&&(o=n),o>0){var r=new a(e.part2_3_length);e.table_select[0]=k(f,0,o,r),e.part2_3_length=r.bits}if(n>o){var r=new a(e.part2_3_length);e.table_select[1]=k(f,o,n,r),e.part2_3_length=r.bits}d.part2_3_length>e.part2_3_length&&d.assign(e)}}}};var s=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],t=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],u=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],v=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];p.slen1_tab=u,p.slen2_tab=v,this.best_scalefac_store=function(a,b,c,d){var e,f,g,h,i=d.tt[b][c],j=0;for(g=0,e=0;e<i.sfbmax;e++){var k=i.width[e];for(g+=k,h=-k;0>h&&0==i.l3_enc[h+g];h++);0==h&&(i.scalefac[e]=j=-2)}if(0==i.scalefac_scale&&0==i.preflag){var l=0;for(e=0;e<i.sfbmax;e++)i.scalefac[e]>0&&(l|=i.scalefac[e]);if(0==(1&l)&&0!=l){for(e=0;e<i.sfbmax;e++)i.scalefac[e]>0&&(i.scalefac[e]>>=1);i.scalefac_scale=j=1}}if(0==i.preflag&&i.block_type!=I.SHORT_TYPE&&2==a.mode_gr){for(e=11;e<I.SBPSY_l&&!(i.scalefac[e]<o.pretab[e]&&-2!=i.scalefac[e]);e++);if(e==I.SBPSY_l){for(e=11;e<I.SBPSY_l;e++)i.scalefac[e]>0&&(i.scalefac[e]-=o.pretab[e]);i.preflag=j=1}}for(f=0;4>f;f++)d.scfsi[c][f]=0;for(2==a.mode_gr&&1==b&&d.tt[0][c].block_type!=I.SHORT_TYPE&&d.tt[1][c].block_type!=I.SHORT_TYPE&&(n(c,d),j=0),e=0;e<i.sfbmax;e++)-2==i.scalefac[e]&&(i.scalefac[e]=0);0!=j&&(2==a.mode_gr?this.scale_bitcount(i):this.scale_bitcount_lsf(a,i))};var w=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],x=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],y=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(a){var b,c,d,e=0,f=0,g=a.scalefac;if(a.block_type==I.SHORT_TYPE)d=w,0!=a.mixed_block_flag&&(d=x);else if(d=y,0==a.preflag){for(c=11;c<I.SBPSY_l&&!(g[c]<o.pretab[c]);c++);if(c==I.SBPSY_l)for(a.preflag=1,c=11;c<I.SBPSY_l;c++)g[c]-=o.pretab[c]}for(c=0;c<a.sfbdivide;c++)e<g[c]&&(e=g[c]);for(;c<a.sfbmax;c++)f<g[c]&&(f=g[c]);for(a.part2_length=C.LARGE_BITS,b=0;16>b;b++)e<s[b]&&f<t[b]&&a.part2_length>d[b]&&(a.part2_length=d[b],a.scalefac_compress=b);return a.part2_length==C.LARGE_BITS};var z=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(a,b){var d,e,f,g,h,i,j,k,l=c(4),m=b.scalefac;for(d=0!=b.preflag?2:0,j=0;4>j;j++)l[j]=0;if(b.block_type==I.SHORT_TYPE){e=1;var n=o.nr_of_sfb_block[d][e];for(k=0,f=0;4>f;f++)for(g=n[f]/3,j=0;g>j;j++,k++)for(h=0;3>h;h++)m[3*k+h]>l[f]&&(l[f]=m[3*k+h])}else{e=0;var n=o.nr_of_sfb_block[d][e];for(k=0,f=0;4>f;f++)for(g=n[f],j=0;g>j;j++,k++)m[k]>l[f]&&(l[f]=m[k])}for(i=!1,f=0;4>f;f++)l[f]>z[d][f]&&(i=!0);if(!i){var p,q,r,s;for(b.sfb_partition_table=o.nr_of_sfb_block[d][e],f=0;4>f;f++)b.slen[f]=A[l[f]];switch(p=b.slen[0],q=b.slen[1],r=b.slen[2],s=b.slen[3],d){case 0:b.scalefac_compress=(5*p+q<<4)+(r<<2)+s;break;case 1:b.scalefac_compress=400+(5*p+q<<2)+r;break;case 2:b.scalefac_compress=500+3*p+q;break;default:Z.err.printf("intensity stereo not implemented yet\n")}}if(!i)for(b.part2_length=0,f=0;4>f;f++)b.part2_length+=b.slen[f]*b.sfb_partition_table[f];return i};var A=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(a){for(var b=2;576>=b;b+=2){for(var c,d=0;a.scalefac_band.l[++d]<b;);for(c=q[d][0];a.scalefac_band.l[c+1]>b;)c--;for(0>c&&(c=q[d][0]),a.bv_scf[b-2]=c,c=q[d][1];a.scalefac_band.l[c+a.bv_scf[b-2]+2]>b;)c--;0>c&&(c=q[d][1]),a.bv_scf[b-1]=c}}}function q(){var a;this.setModules=function(b){a=b},this.ResvFrameBegin=function(b,c){var d,e=b.internal_flags,f=e.l3_side,g=a.getframebits(b);c.bits=(g-8*e.sideinfo_len)/e.mode_gr;var h=2048*e.mode_gr-8;b.brate>320?d=8*int(1e3*b.brate/(b.out_samplerate/1152)/8+.5):(d=11520,b.strict_ISO&&(d=8*int(32e4/(b.out_samplerate/1152)/8+.5))),e.ResvMax=d-g,e.ResvMax>h&&(e.ResvMax=h),(e.ResvMax<0||b.disable_reservoir)&&(e.ResvMax=0);var i=c.bits*e.mode_gr+Math.min(e.ResvSize,e.ResvMax);return i>d&&(i=d),f.resvDrain_pre=0,null!=e.pinfo&&(e.pinfo.mean_bits=c.bits/2,e.pinfo.resvsize=e.ResvSize),i},this.ResvMaxBits=function(a,b,c,d){var e,f=a.internal_flags,g=f.ResvSize,h=f.ResvMax;0!=d&&(g+=b),0!=(1&f.substep_shaping)&&(h*=.9),c.bits=b,10*g>9*h?(e=g-9*h/10,c.bits+=e,f.substep_shaping|=128):(e=0,f.substep_shaping&=127,a.disable_reservoir||0!=(1&f.substep_shaping)||(c.bits-=.1*b));var i=g<6*f.ResvMax/10?g:6*f.ResvMax/10;return i-=e,0>i&&(i=0),i},this.ResvAdjust=function(a,b){a.ResvSize-=b.part2_3_length+b.part2_length},this.ResvFrameEnd=function(a,b){var c,d=a.l3_side;a.ResvSize+=b*a.mode_gr;var e=0;d.resvDrain_post=0,d.resvDrain_pre=0,0!=(c=a.ResvSize%8)&&(e+=c),c=a.ResvSize-e-a.ResvMax,c>0&&(e+=c);var f=Math.min(8*d.main_data_begin,e)/8;d.resvDrain_pre+=8*f,e-=8*f,a.ResvSize-=8*f,d.main_data_begin-=f,d.resvDrain_post+=e,a.ResvSize-=e}}function r(){function b(a){Z.arraycopy(a.header[a.w_ptr].buf,0,z,B,a.sideinfo_len),B+=a.sideinfo_len,A+=8*a.sideinfo_len,a.w_ptr=a.w_ptr+1&N.MAX_HEADER_BUF-1}function d(a,c,d){for(;d>0;){var e;0==C&&(C=8,B++,a.header[a.w_ptr].write_timing==A&&b(a),z[B]=0),e=Math.min(d,C),d-=e,C-=e,z[B]|=c>>d<<C,A+=e}}function e(a,b,c){for(;c>0;){var d;0==C&&(C=8,B++,z[B]=0),d=Math.min(c,C),c-=d,C-=d,z[B]|=b>>c<<C,A+=d}}function g(a,b){var c,e=a.internal_flags;if(b>=8&&(d(e,76,8),b-=8),b>=8&&(d(e,65,8),b-=8),b>=8&&(d(e,77,8),b-=8),b>=8&&(d(e,69,8),b-=8),b>=32){var f=x.getLameShortVersion();if(b>=32)for(c=0;c<f.length&&b>=8;++c)b-=8,d(e,f.charAt(c),8)}for(;b>=1;b-=1)d(e,e.ancillary_flag,1),e.ancillary_flag^=a.disable_reservoir?0:1}function h(a,b,c){for(var d=a.header[a.h_ptr].ptr;c>0;){var e=Math.min(c,8-(7&d));c-=e,a.header[a.h_ptr].buf[d>>3]|=b>>c<<8-(7&d)-e,d+=e}a.header[a.h_ptr].ptr=d}function i(a,b){a<<=8;for(var c=0;8>c;c++)a<<=1,b<<=1,0!=(65536&(b^a))&&(b^=u);return b}function j(a,b){var c,d,e,f=a.internal_flags;if(c=f.l3_side,f.header[f.h_ptr].ptr=0,Y.fill(f.header[f.h_ptr].buf,0,f.sideinfo_len,0),a.out_samplerate<16e3?h(f,4094,12):h(f,4095,12),h(f,a.version,1),h(f,1,2),h(f,a.error_protection?0:1,1),h(f,f.bitrate_index,4),h(f,f.samplerate_index,2),h(f,f.padding,1),h(f,a.extension,1),h(f,a.mode.ordinal(),2),h(f,f.mode_ext,2),h(f,a.copyright,1),h(f,a.original,1),h(f,a.emphasis,2),a.error_protection&&h(f,0,16),1==a.version){for(h(f,c.main_data_begin,9),2==f.channels_out?h(f,c.private_bits,3):h(f,c.private_bits,5),e=0;e<f.channels_out;e++){var g;for(g=0;4>g;g++)h(f,c.scfsi[e][g],1)}for(d=0;2>d;d++)for(e=0;e<f.channels_out;e++){var i=c.tt[d][e];h(f,i.part2_3_length+i.part2_length,12),h(f,i.big_values/2,9),h(f,i.global_gain,8),h(f,i.scalefac_compress,4),i.block_type!=I.NORM_TYPE?(h(f,1,1),h(f,i.block_type,2),h(f,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(f,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(f,i.table_select[1],5),h(f,i.subblock_gain[0],3),h(f,i.subblock_gain[1],3),h(f,i.subblock_gain[2],3)):(h(f,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(f,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(f,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(f,i.table_select[2],5),h(f,i.region0_count,4),h(f,i.region1_count,3)),h(f,i.preflag,1),h(f,i.scalefac_scale,1),h(f,i.count1table_select,1)}}else for(h(f,c.main_data_begin,8),h(f,c.private_bits,f.channels_out),d=0,e=0;e<f.channels_out;e++){var i=c.tt[d][e];h(f,i.part2_3_length+i.part2_length,12),h(f,i.big_values/2,9),h(f,i.global_gain,8),h(f,i.scalefac_compress,9),i.block_type!=I.NORM_TYPE?(h(f,1,1),h(f,i.block_type,2),h(f,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(f,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(f,i.table_select[1],5),h(f,i.subblock_gain[0],3),h(f,i.subblock_gain[1],3),h(f,i.subblock_gain[2],3)):(h(f,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(f,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(f,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(f,i.table_select[2],5),h(f,i.region0_count,4),h(f,i.region1_count,3)),h(f,i.scalefac_scale,1),h(f,i.count1table_select,1)}a.error_protection&&CRC_writeheader(f,f.header[f.h_ptr].buf);var j=f.h_ptr;f.h_ptr=j+1&N.MAX_HEADER_BUF-1,f.header[f.h_ptr].write_timing=f.header[j].write_timing+b,f.h_ptr==f.w_ptr&&Z.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function k(a,b){var c,e=aa.ht[b.count1table_select+32],f=0,g=b.big_values,h=b.big_values;for(c=(b.count1-b.big_values)/4;c>0;--c){var i,j=0,k=0;i=b.l3_enc[g+0],0!=i&&(k+=8,b.xr[h+0]<0&&j++),i=b.l3_enc[g+1],0!=i&&(k+=4,j*=2,b.xr[h+1]<0&&j++),i=b.l3_enc[g+2],0!=i&&(k+=2,j*=2,b.xr[h+2]<0&&j++),i=b.l3_enc[g+3],0!=i&&(k++,j*=2,b.xr[h+3]<0&&j++),g+=4,h+=4,d(a,j+e.table[k],e.hlen[k]),f+=e.hlen[k]}return f}function l(a,b,c,e,f){var g=aa.ht[b],h=0;if(0==b)return h;for(var i=c;e>i;i+=2){var j=0,k=0,l=g.xlen,m=g.xlen,n=0,o=f.l3_enc[i],p=f.l3_enc[i+1];if(0!=o&&(f.xr[i]<0&&n++,j--),b>15){if(o>14){var q=o-15;n|=q<<1,k=l,o=15}if(p>14){var r=p-15;n<<=l,n|=r,k+=l,p=15}m=16}0!=p&&(n<<=1,f.xr[i+1]<0&&n++,j--),o=o*m+p,k-=j,j+=g.hlen[o],d(a,g.table[o],j),d(a,n,k),h+=j+k}return h}function m(a,b){var c=3*a.scalefac_band.s[3];c>b.big_values&&(c=b.big_values);var d=l(a,b.table_select[0],0,c,b);return d+=l(a,b.table_select[1],c,b.big_values,b)}function n(a,b){var c,d,e,f;c=b.big_values;var g=b.region0_count+1;return e=a.scalefac_band.l[g],g+=b.region1_count+1,f=a.scalefac_band.l[g],e>c&&(e=c),f>c&&(f=c),d=l(a,b.table_select[0],0,e,b),d+=l(a,b.table_select[1],e,f,b),d+=l(a,b.table_select[2],f,c,b)}function q(a){var b,c,e,f,g=0,h=a.internal_flags,i=h.l3_side;if(1==a.version)for(b=0;2>b;b++)for(c=0;c<h.channels_out;c++){var j=i.tt[b][c],l=p.slen1_tab[j.scalefac_compress],o=p.slen2_tab[j.scalefac_compress];for(f=0,e=0;e<j.sfbdivide;e++)-1!=j.scalefac[e]&&(d(h,j.scalefac[e],l),f+=l);for(;e<j.sfbmax;e++)-1!=j.scalefac[e]&&(d(h,j.scalefac[e],o),f+=o);f+=j.block_type==I.SHORT_TYPE?m(h,j):n(h,j),f+=k(h,j),g+=f}else for(b=0,c=0;c<h.channels_out;c++){var q,r,j=i.tt[b][c],s=0;if(f=0,e=0,r=0,j.block_type==I.SHORT_TYPE){for(;4>r;r++){var t=j.sfb_partition_table[r]/3,u=j.slen[r];for(q=0;t>q;q++,e++)d(h,Math.max(j.scalefac[3*e+0],0),u),d(h,Math.max(j.scalefac[3*e+1],0),u),d(h,Math.max(j.scalefac[3*e+2],0),u),s+=3*u}f+=m(h,j)}else{for(;4>r;r++){var t=j.sfb_partition_table[r],u=j.slen[r];for(q=0;t>q;q++,e++)d(h,Math.max(j.scalefac[e],0),u),s+=u}f+=n(h,j)}f+=k(h,j),g+=s+f}return g}function r(){this.total=0}function s(a,b){var c,d,e,f,g,h=a.internal_flags;return g=h.w_ptr,f=h.h_ptr-1,-1==f&&(f=N.MAX_HEADER_BUF-1),c=h.header[f].write_timing-A,b.total=c,c>=0&&(d=1+f-g,g>f&&(d=1+f-g+N.MAX_HEADER_BUF),c-=8*d*h.sideinfo_len),e=t.getframebits(a),c+=e,b.total+=e,b.total%8!=0?b.total=1+b.total/8:b.total=b.total/8,b.total+=B+1,0>c&&Z.err.println("strange error flushing buffer ... \n"),c}var t=this,u=32773,v=null,w=null,x=null,y=null;this.setModules=function(a,b,c,d){v=a,w=b,x=c,y=d};var z=null,A=0,B=0,C=0;this.getframebits=function(a){var b,c=a.internal_flags;b=0!=c.bitrate_index?aa.bitrate_table[a.version][c.bitrate_index]:a.brate;var d=0|72e3*(a.version+1)*b/a.out_samplerate+c.padding;return 8*d},this.CRC_writeheader=function(a,b){var c=65535;c=i(255&b[2],c),c=i(255&b[3],c);for(var d=6;d<a.sideinfo_len;d++)c=i(255&b[d],c);b[4]=byte(c>>8),b[5]=byte(255&c)},this.flush_bitstream=function(a){var b,c,d=a.internal_flags,e=d.h_ptr-1;if(-1==e&&(e=N.MAX_HEADER_BUF-1),b=d.l3_side,!((c=s(a,new r))<0)){if(g(a,c),d.ResvSize=0,b.main_data_begin=0,d.findReplayGain){var f=v.GetTitleGain(d.rgdata);d.RadioGain=0|Math.floor(10*f+.5)}d.findPeakSample&&(d.noclipGainChange=0|Math.ceil(20*Math.log10(d.PeakSample/32767)*10),d.noclipGainChange>0&&(EQ(a.scale,1)||EQ(a.scale,0))?d.noclipScale=Math.floor(32767/d.PeakSample*100)/100:d.noclipScale=-1)}},this.add_dummy_byte=function(a,b,c){for(var d,f=a.internal_flags;c-- >0;)for(e(f,b,8),d=0;d<N.MAX_HEADER_BUF;++d)f.header[d].write_timing+=8},this.format_bitstream=function(a){var b,c=a.internal_flags;b=c.l3_side;var d=this.getframebits(a);g(a,b.resvDrain_pre),j(a,d);var e=8*c.sideinfo_len;if(e+=q(a),g(a,b.resvDrain_post),e+=b.resvDrain_post,b.main_data_begin+=(d-e)/8,s(a,new r)!=c.ResvSize&&Z.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*b.main_data_begin!=c.ResvSize&&(Z.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*b.main_data_begin,c.ResvSize,b.resvDrain_post,b.resvDrain_pre,8*c.sideinfo_len,e-b.resvDrain_post-8*c.sideinfo_len,e,e%8,d),Z.err.println("This is a fatal error.  It has several possible causes:"),Z.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Z.err.println(" 9%%  Your system is overclocked"),Z.err.println(" 1%%  bug in LAME encoding library"),c.ResvSize=8*b.main_data_begin),A>1e9){var f;for(f=0;f<N.MAX_HEADER_BUF;++f)c.header[f].write_timing-=A;A=0}return 0},this.copy_buffer=function(a,b,d,e,g){var h=B+1;if(0>=h)return 0;if(0!=e&&h>e)return-1;if(Z.arraycopy(z,0,b,d,h),B=-1,C=0,0!=g){var i=c(1);if(i[0]=a.nMusicCRC,y.updateMusicCRC(i,b,d,h),a.nMusicCRC=i[0],h>0&&(a.VBR_seek_table.nBytesWritten+=h),a.decode_on_the_fly)for(var j,k=f([2,1152]),l=h,m=-1;0!=m;)if(m=w.hip_decode1_unclipped(a.hip,b,d,l,k[0],k[1]),l=0,-1==m&&(m=0),m>0){if(a.findPeakSample){for(j=0;m>j;j++)k[0][j]>a.PeakSample?a.PeakSample=k[0][j]:-k[0][j]>a.PeakSample&&(a.PeakSample=-k[0][j]);if(a.channels_out>1)for(j=0;m>j;j++)k[1][j]>a.PeakSample?a.PeakSample=k[1][j]:-k[1][j]>a.PeakSample&&(a.PeakSample=-k[1][j])}if(a.findReplayGain&&v.AnalyzeSamples(a.rgdata,k[0],0,k[1],0,m,a.channels_out)==o.GAIN_ANALYSIS_ERROR)return-6}}return h},this.init_bit_stream_w=function(b){z=a(Q.LAME_MAXMP3BUFFER),b.h_ptr=b.w_ptr=0,b.header[b.h_ptr].write_timing=0,B=-1,C=0,A=0}}function s(){function b(a,b){if(a.nVbrNumFrames++,a.sum+=b,a.seen++,!(a.seen<a.want)&&(a.pos<a.size&&(a.bag[a.pos]=a.sum,a.pos++,a.seen=0),a.pos==a.size)){for(var c=1;c<a.size;c+=2)a.bag[c/2]=a.bag[c];a.want*=2,a.pos/=2}}function c(a,b){if(!(a.pos<=0))for(var c=1;w>c;++c){var d,e,f=c/w,g=0|Math.floor(f*a.pos);g>a.pos-1&&(g=a.pos-1),d=a.bag[g],e=a.sum;var h=0|256*d/e;h>255&&(h=255),b[c]=255&h}}function d(a,b){var c=255&a[b+0];return c<<=8,c|=255&a[b+1],c<<=8,c|=255&a[b+2],c<<=8,c|=255&a[b+3]}function e(a,b,c){a[b+0]=255&(c>>24&255),a[b+1]=255&(c>>16&255),a[b+2]=255&(c>>8&255),a[b+3]=255&(255&c)}function f(a,b,c){a[b+0]=255&(c>>8&255),a[b+1]=255&(255&c)}function g(a,b){return new String(a,b,E.length(),D).equals(E)||new String(a,b,F.length(),D).equals(F)}function h(a,b,c){return 255&(a<<b|c&~(-1<<b))}function i(a,b){var c=a.internal_flags;b[0]=h(b[0],8,255),b[1]=h(b[1],3,7),b[1]=h(b[1],1,a.out_samplerate<16e3?0:1),b[1]=h(b[1],1,a.version),b[1]=h(b[1],2,1),b[1]=h(b[1],1,a.error_protection?0:1),b[2]=h(b[2],4,c.bitrate_index),b[2]=h(b[2],2,c.samplerate_index),b[2]=h(b[2],1,0),b[2]=h(b[2],1,a.extension),b[3]=h(b[3],2,a.mode.ordinal()),b[3]=h(b[3],2,c.mode_ext),b[3]=h(b[3],1,a.copyright),b[3]=h(b[3],1,a.original),b[3]=h(b[3],2,a.emphasis),b[0]=255;var d,e=255&(241&b[1]);d=1==a.version?A:a.out_samplerate<16e3?C:B,a.VBR==k.vbr_off&&(d=a.brate);var f;f=a.free_format?0:255&16*o.BitrateIndex(d,a.version,a.out_samplerate),1==a.version?(b[1]=255&(10|e),e=255&(13&b[2]),b[2]=255&(f|e)):(b[1]=255&(2|e),e=255&(13&b[2]),b[2]=255&(f|e))}function l(a,b){var c=b^a;return b=b>>8^G[255&c]}function m(a,b,c,d,g){var h,i,k,m=a.internal_flags,n=0,o=a.encoder_delay,p=a.encoder_padding,r=100-10*a.VBR_q-a.quality,s=q.getLameVeryShortVersion(),t=0,u=[1,5,3,2,4,0,3],v=0|(a.lowpassfreq/100+.5>255?255:a.lowpassfreq/100+.5),w=0,x=0,y=0,z=a.internal_flags.noise_shaping,A=0,B=0,C=0,D=0,E=0,F=0!=(1&a.exp_nspsytune),G=0!=(2&a.exp_nspsytune),H=!1,I=!1,J=a.internal_flags.nogap_total,K=a.internal_flags.nogap_current,L=a.ATHtype,M=0;switch(a.VBR){case vbr_abr:k=a.VBR_mean_bitrate_kbps;break;case vbr_off:k=a.brate;break;default:k=a.VBR_min_bitrate_kbps}switch(h=a.VBR.ordinal()<u.length?u[a.VBR.ordinal()]:0,i=16*t+h,m.findReplayGain&&(m.RadioGain>510&&(m.RadioGain=510),m.RadioGain<-510&&(m.RadioGain=-510),x=8192,x|=3072,m.RadioGain>=0?x|=m.RadioGain:(x|=512,x|=-m.RadioGain)),m.findPeakSample&&(w=Math.abs(0|m.PeakSample/32767*Math.pow(2,23)+.5)),-1!=J&&(K>0&&(I=!0),J-1>K&&(H=!0)),M=L+((F?1:0)<<4)+((G?1:0)<<5)+((H?1:0)<<6)+((I?1:0)<<7),0>r&&(r=0),a.mode){case MONO:A=0;break;case STEREO:A=1;break;case DUAL_CHANNEL:A=2;break;case JOINT_STEREO:A=a.force_ms?4:3;break;case NOT_SET:default:A=7}C=a.in_samplerate<=32e3?0:48e3==a.in_samplerate?2:a.in_samplerate>48e3?3:1,(a.short_blocks==j.short_block_forced||a.short_blocks==j.short_block_dispensed||-1==a.lowpassfreq&&-1==a.highpassfreq||a.scale_left<a.scale_right||a.scale_left>a.scale_right||a.disable_reservoir&&a.brate<320||a.noATH||a.ATHonly||0==L||a.in_samplerate<=32e3)&&(B=1),D=z+(A<<2)+(B<<5)+(C<<6),E=m.nMusicCRC,e(c,d+n,r),n+=4;for(var N=0;9>N;N++)c[d+n+N]=255&s.charAt(N);n+=9,c[d+n]=255&i,n++,c[d+n]=255&v,n++,e(c,d+n,w),n+=4,f(c,d+n,x),n+=2,f(c,d+n,y),n+=2,c[d+n]=255&M,n++,k>=255?c[d+n]=255:c[d+n]=255&k,n++,c[d+n]=255&o>>4,c[d+n+1]=255&(o<<4)+(p>>8),c[d+n+2]=255&p,n+=3,c[d+n]=255&D,n++,c[d+n++]=0,f(c,d+n,a.preset),n+=2,e(c,d+n,b),n+=4,f(c,d+n,E),n+=2;for(var O=0;n>O;O++)g=l(c[d+O],g);return f(c,d+n,g),n+=2}function n(b){b.seek(0);var c=a(10);b.readFully(c);var d;return d=new String(c,"ISO-8859-1").startsWith("ID3")?0:((127&c[6])<<21|(127&c[7])<<14|(127&c[8])<<7|127&c[9])+c.length}var o,p,q;this.setModules=function(a,b,c){o=a,p=b,q=c};var r=1,t=2,u=4,v=8,w=s.NUMTOCENTRIES,x=s.MAXFRAMESIZE,y=w+4+4+4+4+4,z=y+9+1+1+8+1+1+3+1+1+2+4+2+2,A=128,B=64,C=32,D=null,E="Xing",F="Info",G=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(a){var c=a.internal_flags,d=aa.bitrate_table[a.version][c.bitrate_index];b(c.VBR_seek_table,d)},this.getVbrTag=function(a){var b=new VBRTagData,c=0;b.flags=0;var e=a[c+1]>>3&1,f=a[c+2]>>2&3,h=a[c+3]>>6&3,i=a[c+2]>>4&15;if(i=aa.bitrate_table[e][i],a[c+1]>>4==14?b.samprate=aa.samplerate_table[2][f]:b.samprate=aa.samplerate_table[e][f],c+=0!=e?3!=h?36:21:3!=h?21:13,!g(a,c))return null;c+=4,b.hId=e;var j=b.flags=d(a,c);if(c+=4,0!=(j&r)&&(b.frames=d(a,c),c+=4),0!=(j&t)&&(b.bytes=d(a,c),c+=4),0!=(j&u)){if(null!=b.toc)for(var k=0;w>k;k++)b.toc[k]=a[c+k];c+=w}b.vbrScale=-1,0!=(j&v)&&(b.vbrScale=d(a,c),c+=4),b.headersize=72e3*(e+1)*i/b.samprate,c+=21;var l=a[c+0]<<4;l+=a[c+1]>>4;var m=(15&a[c+1])<<8;return m+=255&a[c+2],(0>l||l>3e3)&&(l=-1),(0>m||m>3e3)&&(m=-1),b.encDelay=l,b.encPadding=m,b},this.InitVbrTag=function(b){var c,d=b.internal_flags;c=1==b.version?A:b.out_samplerate<16e3?C:B,b.VBR==k.vbr_off&&(c=b.brate);var e=72e3*(b.version+1)*c/b.out_samplerate,f=d.sideinfo_len+z;if(d.VBR_seek_table.TotalFrameSize=e,f>e||e>x)return void(b.bWriteVbrTag=!1);d.VBR_seek_table.nVbrNumFrames=0,d.VBR_seek_table.nBytesWritten=0,d.VBR_seek_table.sum=0,d.VBR_seek_table.seen=0,d.VBR_seek_table.want=1,d.VBR_seek_table.pos=0,null==d.VBR_seek_table.bag&&(d.VBR_seek_table.bag=new int[400],d.VBR_seek_table.size=400);var g=a(x);i(b,g);for(var h=d.VBR_seek_table.TotalFrameSize,j=0;h>j;++j)p.add_dummy_byte(b,255&g[j],1)},this.updateMusicCRC=function(a,b,c,d){for(var e=0;d>e;++e)a[0]=l(b[c+e],a[0])},this.getLameTagFrame=function(b,d){var f=b.internal_flags;if(!b.bWriteVbrTag)return 0;if(f.Class_ID!=Q.LAME_ID)return 0;if(f.VBR_seek_table.pos<=0)return 0;if(d.length<f.VBR_seek_table.TotalFrameSize)return f.VBR_seek_table.TotalFrameSize;Y.fill(d,0,f.VBR_seek_table.TotalFrameSize,0),i(b,d);var g=a(w);if(b.free_format)for(var h=1;w>h;++h)g[h]=255&255*h/100;else c(f.VBR_seek_table,g);var j=f.sideinfo_len;b.error_protection&&(j-=2),b.VBR==k.vbr_off?(d[j++]=255&F.charAt(0),d[j++]=255&F.charAt(1),d[j++]=255&F.charAt(2),d[j++]=255&F.charAt(3)):(d[j++]=255&E.charAt(0),d[j++]=255&E.charAt(1),d[j++]=255&E.charAt(2),d[j++]=255&E.charAt(3)),e(d,j,r+t+u+v),j+=4,e(d,j,f.VBR_seek_table.nVbrNumFrames),j+=4;var n=f.VBR_seek_table.nBytesWritten+f.VBR_seek_table.TotalFrameSize;e(d,j,0|n),j+=4,Z.arraycopy(g,0,d,j,g.length),j+=g.length,b.error_protection&&p.CRC_writeheader(f,d);for(var o=0,h=0;j>h;h++)o=l(d[h],o);return j+=m(b,n,d,j,o),f.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(b,c){var d=b.internal_flags;if(d.VBR_seek_table.pos<=0)return-1;if(c.seek(c.length()),0==c.length())return-1;var e=n(c);c.seek(e);var f=a(x),g=getLameTagFrame(b,f);return g>f.length?-1:1>g?0:(c.write(f,0,g),0)}}function t(a,b,c,d){this.xlen=a,this.linmax=b,this.table=c,this.hlen=d}function u(a){this.bits=a}function v(){var a,b;this.setModules=function(c,d){a=c,b=d}}function w(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function x(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=l.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function y(){this.linprebuf=d(2*o.MAX_ORDER),this.linpre=0,this.lstepbuf=d(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.lstep=0,this.loutbuf=d(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.lout=0,this.rinprebuf=d(2*o.MAX_ORDER),this.rinpre=0,this.rstepbuf=d(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.rstep=0,this.routbuf=d(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=c(0|o.STEPS_per_dB*o.MAX_dB),this.B=c(0|o.STEPS_per_dB*o.MAX_dB)}function z(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=d(I.SBMAX_l),this.s=d(I.SBMAX_s),this.psfb21=d(I.PSFB21),this.psfb12=d(I.PSFB12),this.cb_l=d(I.CBANDS),this.cb_s=d(I.CBANDS),this.eql_w=d(I.BLKSIZE/2)}function A(a){var b=a;this.quantize=b,this.iteration_loop=function(a,b,e,f){var g,h=a.internal_flags,i=d(ba.SFBMAX),j=d(576),k=c(2),l=0,m=h.l3_side,n=new u(l);this.quantize.rv.ResvFrameBegin(a,n),l=n.bits;for(var o=0;o<h.mode_gr;o++){g=this.quantize.qupvt.on_pe(a,b,k,l,o,o),h.mode_ext==I.MPG_MD_MS_LR&&(this.quantize.ms_convert(h.l3_side,o),this.quantize.qupvt.reduce_side(k,e[o],l,g));for(var p=0;p<h.channels_out;p++){var q,r,s=m.tt[o][p];s.block_type!=I.SHORT_TYPE?(q=0,r=h.PSY.mask_adjust-q):(q=0,r=h.PSY.mask_adjust_short-q),h.masking_lower=Math.pow(10,.1*r),this.quantize.init_outer_loop(h,s),this.quantize.init_xrpow(h,s,j)&&(this.quantize.qupvt.calc_xmin(a,f[o][p],s,i),this.quantize.outer_loop(a,s,i,j,p,k[p])),this.quantize.iteration_finish_one(h,o,p)}}this.quantize.rv.ResvFrameEnd(h,l)}}function B(a,b,d,e){this.l=c(1+I.SBMAX_l),this.s=c(1+I.SBMAX_s),this.psfb21=c(1+I.PSFB21),this.psfb12=c(1+I.PSFB12);var f=this.l,g=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Z.arraycopy(this.arrL,0,f,0,Math.min(this.arrL.length,this.l.length)),Z.arraycopy(this.arrS,0,g,0,Math.min(this.arrS.length,this.s.length)),Z.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Z.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function C(){function a(a){return s[a+C.Q_MAX2]}function b(a,b){var c=i.ATHformula(b,a);return c-=p,c=Math.pow(10,c/10+a.ATHlower)}function e(a){for(var c=a.internal_flags.ATH.l,d=a.internal_flags.ATH.psfb21,e=a.internal_flags.ATH.s,f=a.internal_flags.ATH.psfb12,g=a.internal_flags,h=a.out_samplerate,i=0;i<I.SBMAX_l;i++){var j=g.scalefac_band.l[i],k=g.scalefac_band.l[i+1];c[i]=_.MAX_VALUE;for(var l=j;k>l;l++){var m=l*h/1152,n=b(a,m);c[i]=Math.min(c[i],n)}}for(var i=0;i<I.PSFB21;i++){var j=g.scalefac_band.psfb21[i],k=g.scalefac_band.psfb21[i+1];d[i]=_.MAX_VALUE;for(var l=j;k>l;l++){var m=l*h/1152,n=b(a,m);d[i]=Math.min(d[i],n)}}for(var i=0;i<I.SBMAX_s;i++){var j=g.scalefac_band.s[i],k=g.scalefac_band.s[i+1];e[i]=_.MAX_VALUE;for(var l=j;k>l;l++){var m=l*h/384,n=b(a,m);e[i]=Math.min(e[i],n)}e[i]*=g.scalefac_band.s[i+1]-g.scalefac_band.s[i]}for(var i=0;i<I.PSFB12;i++){var j=g.scalefac_band.psfb12[i],k=g.scalefac_band.psfb12[i+1];f[i]=_.MAX_VALUE;for(var l=j;k>l;l++){var m=l*h/384,n=b(a,m);f[i]=Math.min(f[i],n)}f[i]*=g.scalefac_band.s[13]-g.scalefac_band.s[12]}if(a.noATH){for(var i=0;i<I.SBMAX_l;i++)c[i]=1e-20;for(var i=0;i<I.PSFB21;i++)d[i]=1e-20;for(var i=0;i<I.SBMAX_s;i++)e[i]=1e-20;for(var i=0;i<I.PSFB12;i++)f[i]=1e-20}g.ATH.floor=10*Math.log10(b(a,-1))}function f(a){this.s=a}var g=null,h=null,i=null;this.setModules=function(a,b,c){g=a,h=b,i=c},this.IPOW20=function(a){return t[a]};var j=2.220446049250313e-16,l=C.IXMAX_VAL,m=l+2,n=C.Q_MAX,o=C.Q_MAX2,p=(C.LARGE_BITS,100);this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var q=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=q,this.sfBandIndex=[new B([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var s=d(n+o+1),t=d(n),v=d(m),x=d(m);this.adj43=x,this.iteration_init=function(a){var b,c=a.internal_flags,d=c.l3_side;if(0==c.iteration_init_init){for(c.iteration_init_init=1,d.main_data_begin=0,e(a),v[0]=0,b=1;m>b;b++)v[b]=Math.pow(b,4/3);for(b=0;m-1>b;b++)x[b]=b+1-Math.pow(.5*(v[b]+v[b+1]),.75);for(x[b]=.5,b=0;n>b;b++)t[b]=Math.pow(2,(b-210)*-.1875);for(b=0;n+o>=b;b++)s[b]=Math.pow(2,.25*(b-210-o));g.huffman_init(c);var f,h,i,j;for(b=a.exp_nspsytune>>2&63,b>=32&&(b-=64),f=Math.pow(10,b/4/10),b=a.exp_nspsytune>>8&63,b>=32&&(b-=64),h=Math.pow(10,b/4/10),b=a.exp_nspsytune>>14&63,b>=32&&(b-=64),i=Math.pow(10,b/4/10),b=a.exp_nspsytune>>20&63,b>=32&&(b-=64),j=i*Math.pow(10,b/4/10),b=0;b<I.SBMAX_l;b++){
var k;k=6>=b?f:13>=b?h:20>=b?i:j,c.nsPsy.longfact[b]=k}for(b=0;b<I.SBMAX_s;b++){var k;k=5>=b?f:10>=b?h:11>=b?i:j,c.nsPsy.shortfact[b]=k}}},this.on_pe=function(a,b,d,e,f,g){var i,j,k=a.internal_flags,l=0,m=c(2),n=new u(l),o=h.ResvMaxBits(a,e,n,g);l=n.bits;var p=l+o;for(p>N.MAX_BITS_PER_GRANULE&&(p=N.MAX_BITS_PER_GRANULE),i=0,j=0;j<k.channels_out;++j)d[j]=Math.min(N.MAX_BITS_PER_CHANNEL,l/k.channels_out),m[j]=0|d[j]*b[f][j]/700-d[j],m[j]>3*e/4&&(m[j]=3*e/4),m[j]<0&&(m[j]=0),m[j]+d[j]>N.MAX_BITS_PER_CHANNEL&&(m[j]=Math.max(0,N.MAX_BITS_PER_CHANNEL-d[j])),i+=m[j];if(i>o)for(j=0;j<k.channels_out;++j)m[j]=o*m[j]/i;for(j=0;j<k.channels_out;++j)d[j]+=m[j],o-=m[j];for(i=0,j=0;j<k.channels_out;++j)i+=d[j];if(i>N.MAX_BITS_PER_GRANULE){var q=0;for(j=0;j<k.channels_out;++j)d[j]*=N.MAX_BITS_PER_GRANULE,d[j]/=i,q+=d[j]}return p},this.reduce_side=function(a,b,c,d){var e=.33*(.5-b)/.5;0>e&&(e=0),e>.5&&(e=.5);var f=0|.5*e*(a[0]+a[1]);f>N.MAX_BITS_PER_CHANNEL-a[0]&&(f=N.MAX_BITS_PER_CHANNEL-a[0]),0>f&&(f=0),a[1]>=125&&(a[1]-f>125?(a[0]<c&&(a[0]+=f),a[1]-=f):(a[0]+=a[1]-125,a[1]=125)),f=a[0]+a[1],f>d&&(a[0]=d*a[0]/f,a[1]=d*a[1]/f)},this.athAdjust=function(a,b,c){var d=90.30873362,e=94.82444863,f=$.FAST_LOG10_X(b,10),g=a*a,h=0;return f-=c,g>1e-20&&(h=1+$.FAST_LOG10_X(g,10/d)),0>h&&(h=0),f*=h,f+=c+d-e,Math.pow(10,.1*f)},this.calc_xmin=function(a,b,c,d){var e,f=0,g=a.internal_flags,h=0,i=0,l=g.ATH,m=c.xr,n=a.VBR==k.vbr_mtrh?1:0,o=g.masking_lower;for((a.VBR==k.vbr_mtrh||a.VBR==k.vbr_mt)&&(o=1),e=0;e<c.psy_lmax;e++){var p,q,s,t,u,v;q=a.VBR==k.vbr_rh||a.VBR==k.vbr_mtrh?athAdjust(l.adjust,l.l[e],l.floor):l.adjust*l.l[e],u=c.width[e],s=q/u,t=j,v=u>>1,p=0;do{var w,x;w=m[h]*m[h],p+=w,t+=s>w?w:s,h++,x=m[h]*m[h],p+=x,t+=s>x?x:s,h++}while(--v>0);if(p>q&&i++,e==I.SBPSY_l){var y=q*g.nsPsy.longfact[e];y>t&&(t=y)}if(0!=n&&(q=t),!a.ATHonly){var z=b.en.l[e];if(z>0){var y;y=p*b.thm.l[e]*o/z,0!=n&&(y*=g.nsPsy.longfact[e]),y>q&&(q=y)}}0!=n?d[f++]=q:d[f++]=q*g.nsPsy.longfact[e]}var A=575;if(c.block_type!=I.SHORT_TYPE)for(var B=576;0!=B--&&r.EQ(m[B],0);)A=B;c.max_nonzero_coeff=A;for(var C=c.sfb_smin;e<c.psymax;C++,e+=3){var u,D,E;for(E=a.VBR==k.vbr_rh||a.VBR==k.vbr_mtrh?athAdjust(l.adjust,l.s[C],l.floor):l.adjust*l.s[C],u=c.width[e],D=0;3>D;D++){var q,s,t,p=0,v=u>>1;s=E/u,t=j;do{var w,x;w=m[h]*m[h],p+=w,t+=s>w?w:s,h++,x=m[h]*m[h],p+=x,t+=s>x?x:s,h++}while(--v>0);if(p>E&&i++,C==I.SBPSY_s){var y=E*g.nsPsy.shortfact[C];y>t&&(t=y)}if(q=0!=n?t:E,!a.ATHonly&&!a.ATHshort){var z=b.en.s[C][D];if(z>0){var y;y=p*b.thm.s[C][D]*o/z,0!=n&&(y*=g.nsPsy.shortfact[C]),y>q&&(q=y)}}0!=n?d[f++]=q:d[f++]=q*g.nsPsy.shortfact[C]}a.useTemporal&&(d[f-3]>d[f-3+1]&&(d[f-3+1]+=(d[f-3]-d[f-3+1])*g.decay),d[f-3+1]>d[f-3+2]&&(d[f-3+2]+=(d[f-3+1]-d[f-3+2])*g.decay))}return i},this.calc_noise_core=function(a,b,c,e){var f=0,g=b.s,h=a.l3_enc;if(g>a.count1)for(;0!=c--;){var i;i=a.xr[g],g++,f+=i*i,i=a.xr[g],g++,f+=i*i}else if(g>a.big_values){var j=d(2);for(j[0]=0,j[1]=e;0!=c--;){var i;i=Math.abs(a.xr[g])-j[h[g]],g++,f+=i*i,i=Math.abs(a.xr[g])-j[h[g]],g++,f+=i*i}}else for(;0!=c--;){var i;i=Math.abs(a.xr[g])-v[h[g]]*e,g++,f+=i*i,i=Math.abs(a.xr[g])-v[h[g]]*e,g++,f+=i*i}return b.s=g,f},this.calc_noise=function(b,c,d,e,g){var h,i,j=0,k=0,l=0,m=0,n=0,o=-20,p=0,r=b.scalefac,s=0;for(e.over_SSD=0,h=0;h<b.psymax;h++){var t=b.global_gain-(r[s++]+(0!=b.preflag?q[h]:0)<<b.scalefac_scale+1)-8*b.subblock_gain[b.window[h]],u=0;if(null!=g&&g.step[h]==t)u=g.noise[h],p+=b.width[h],d[j++]=u/c[k++],u=g.noise_log[h];else{var v=a(t);if(i=b.width[h]>>1,p+b.width[h]>b.max_nonzero_coeff){var w;w=b.max_nonzero_coeff-p+1,i=w>0?w>>1:0}var x=new f(p);u=this.calc_noise_core(b,x,i,v),p=x.s,null!=g&&(g.step[h]=t,g.noise[h]=u),u=d[j++]=u/c[k++],u=$.FAST_LOG10(Math.max(u,1e-20)),null!=g&&(g.noise_log[h]=u)}if(null!=g&&(g.global_gain=b.global_gain),n+=u,u>0){var y;y=Math.max(0|10*u+.5,1),e.over_SSD+=y*y,l++,m+=u}o=Math.max(o,u)}return e.over_count=l,e.tot_noise=n,e.over_noise=m,e.max_noise=o,l},this.set_pinfo=function(a,b,c,e,f){var g,h,i,j,k,l=a.internal_flags,m=0==b.scalefac_scale?.5:1,n=b.scalefac,o=d(ba.SFBMAX),p=d(ba.SFBMAX),r=new w;calc_xmin(a,c,b,o),calc_noise(b,o,p,r,null);var s=0;for(h=b.sfb_lmax,b.block_type!=I.SHORT_TYPE&&0==b.mixed_block_flag&&(h=22),g=0;h>g;g++){var t=l.scalefac_band.l[g],u=l.scalefac_band.l[g+1],v=u-t;for(j=0;u>s;s++)j+=b.xr[s]*b.xr[s];j/=v,k=1e15,l.pinfo.en[e][f][g]=k*j,l.pinfo.xfsf[e][f][g]=k*o[g]*p[g]/v,c.en.l[g]>0&&!a.ATHonly?j/=c.en.l[g]:j=0,l.pinfo.thr[e][f][g]=k*Math.max(j*c.thm.l[g],l.ATH.l[g]),l.pinfo.LAMEsfb[e][f][g]=0,0!=b.preflag&&g>=11&&(l.pinfo.LAMEsfb[e][f][g]=-m*q[g]),g<I.SBPSY_l&&(l.pinfo.LAMEsfb[e][f][g]-=m*n[g])}if(b.block_type==I.SHORT_TYPE)for(h=g,g=b.sfb_smin;g<I.SBMAX_s;g++)for(var t=l.scalefac_band.s[g],u=l.scalefac_band.s[g+1],v=u-t,x=0;3>x;x++){for(j=0,i=t;u>i;i++)j+=b.xr[s]*b.xr[s],s++;j=Math.max(j/v,1e-20),k=1e15,l.pinfo.en_s[e][f][3*g+x]=k*j,l.pinfo.xfsf_s[e][f][3*g+x]=k*o[h]*p[h]/v,c.en.s[g][x]>0?j/=c.en.s[g][x]:j=0,(a.ATHonly||a.ATHshort)&&(j=0),l.pinfo.thr_s[e][f][3*g+x]=k*Math.max(j*c.thm.s[g][x],l.ATH.s[g]),l.pinfo.LAMEsfb_s[e][f][3*g+x]=-2*b.subblock_gain[x],g<I.SBPSY_s&&(l.pinfo.LAMEsfb_s[e][f][3*g+x]-=m*n[h]),h++}l.pinfo.LAMEqss[e][f]=b.global_gain,l.pinfo.LAMEmainbits[e][f]=b.part2_3_length+b.part2_length,l.pinfo.LAMEsfbits[e][f]=b.part2_length,l.pinfo.over[e][f]=r.over_count,l.pinfo.max_noise[e][f]=10*r.max_noise,l.pinfo.over_noise[e][f]=10*r.over_noise,l.pinfo.tot_noise[e][f]=10*r.tot_noise,l.pinfo.over_SSD[e][f]=r.over_SSD}}function D(){this.global_gain=0,this.sfb_count1=0,this.step=c(39),this.noise=d(39),this.noise_log=d(39)}function E(){function a(a){return new Int32Array(a)}function b(a){return new Float32Array(a)}this.xr=d(576),this.l3_enc=c(576),this.scalefac=c(ba.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=c(3),this.subblock_gain=c(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=c(ba.SFBMAX),this.window=c(ba.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=c(4),this.max_nonzero_coeff=0;var e=this;this.assign=function(c){e.xr=b(c.xr),e.l3_enc=a(c.l3_enc),e.scalefac=a(c.scalefac),e.xrpow_max=c.xrpow_max,e.part2_3_length=c.part2_3_length,e.big_values=c.big_values,e.count1=c.count1,e.global_gain=c.global_gain,e.scalefac_compress=c.scalefac_compress,e.block_type=c.block_type,e.mixed_block_flag=c.mixed_block_flag,e.table_select=a(c.table_select),e.subblock_gain=a(c.subblock_gain),e.region0_count=c.region0_count,e.region1_count=c.region1_count,e.preflag=c.preflag,e.scalefac_scale=c.scalefac_scale,e.count1table_select=c.count1table_select,e.part2_length=c.part2_length,e.sfb_lmax=c.sfb_lmax,e.sfb_smin=c.sfb_smin,e.psy_lmax=c.psy_lmax,e.sfbmax=c.sfbmax,e.psymax=c.psymax,e.sfbdivide=c.sfbdivide,e.width=a(c.width),e.window=a(c.window),e.count1bits=c.count1bits,e.sfb_partition_table=c.sfb_partition_table.slice(0),e.slen=a(c.slen),e.max_nonzero_coeff=c.max_nonzero_coeff}}function F(){function a(a,b,c,d){d=0;for(var e=0;c>=e;++e){var f=Math.abs(a.xr[e]);d+=f,b[e]=Math.sqrt(f*Math.sqrt(f)),b[e]>a.xrpow_max&&(a.xrpow_max=b[e])}return d}function b(a,b){var c=a.ATH,d=b.xr;if(b.block_type!=I.SHORT_TYPE)for(var e=!1,f=I.PSFB21-1;f>=0&&!e;f--){var g=a.scalefac_band.psfb21[f],h=a.scalefac_band.psfb21[f+1],i=q.athAdjust(c.adjust,c.psfb21[f],c.floor);a.nsPsy.longfact[21]>1e-12&&(i*=a.nsPsy.longfact[21]);for(var j=h-1;j>=g;j--){if(!(Math.abs(d[j])<i)){e=!0;break}d[j]=0}}else for(var k=0;3>k;k++)for(var e=!1,f=I.PSFB12-1;f>=0&&!e;f--){var g=3*a.scalefac_band.s[12]+(a.scalefac_band.s[13]-a.scalefac_band.s[12])*k+(a.scalefac_band.psfb12[f]-a.scalefac_band.psfb12[0]),h=g+(a.scalefac_band.psfb12[f+1]-a.scalefac_band.psfb12[f]),l=q.athAdjust(c.adjust,c.psfb12[f],c.floor);a.nsPsy.shortfact[12]>1e-12&&(l*=a.nsPsy.shortfact[12]);for(var j=h-1;j>=g;j--){if(!(Math.abs(d[j])<l)){e=!0;break}d[j]=0}}}function c(a){this.ordinal=a}function e(a,b,d,e,f){var g,h=a.CurrentStep[e],i=!1,j=a.OldValue[e],k=c.BINSEARCH_NONE;for(b.global_gain=j,d-=b.part2_length;;){var l;if(g=s.count_bits(a,f,b,null),1==h||g==d)break;g>d?(k==c.BINSEARCH_DOWN&&(i=!0),i&&(h/=2),k=c.BINSEARCH_UP,l=h):(k==c.BINSEARCH_UP&&(i=!0),i&&(h/=2),k=c.BINSEARCH_DOWN,l=-h),b.global_gain+=l,b.global_gain<0&&(b.global_gain=0,i=!0),b.global_gain>255&&(b.global_gain=255,i=!0)}for(;g>d&&b.global_gain<255;)b.global_gain++,g=s.count_bits(a,f,b,null);return a.CurrentStep[e]=j-b.global_gain>=4?4:2,a.OldValue[e]=b.global_gain,b.part2_3_length=g,g}function f(a){for(var b=0;b<a.sfbmax;b++)if(a.scalefac[b]+a.subblock_gain[a.window[b]]==0)return!1;return!0}function g(a){return $.FAST_LOG10(.368+.632*a*a*a)}function h(a,b){for(var c=1e-37,d=0;d<b.psymax;d++)c+=g(a[d]);return Math.max(1e-20,c)}function i(a,b,c,d,e){var f;switch(a){default:case 9:b.over_count>0?(f=c.over_SSD<=b.over_SSD,c.over_SSD==b.over_SSD&&(f=c.bits<b.bits)):f=c.max_noise<0&&10*c.max_noise+c.bits<=10*b.max_noise+b.bits;break;case 0:f=c.over_count<b.over_count||c.over_count==b.over_count&&c.over_noise<b.over_noise||c.over_count==b.over_count&&r.EQ(c.over_noise,b.over_noise)&&c.tot_noise<b.tot_noise;break;case 8:c.max_noise=h(e,d);case 1:f=c.max_noise<b.max_noise;break;case 2:f=c.tot_noise<b.tot_noise;break;case 3:f=c.tot_noise<b.tot_noise&&c.max_noise<b.max_noise;break;case 4:f=c.max_noise<=0&&b.max_noise>.2||c.max_noise<=0&&b.max_noise<0&&b.max_noise>c.max_noise-.2&&c.tot_noise<b.tot_noise||c.max_noise<=0&&b.max_noise>0&&b.max_noise>c.max_noise-.2&&c.tot_noise<b.tot_noise+b.over_noise||c.max_noise>0&&b.max_noise>-.05&&b.max_noise>c.max_noise-.1&&c.tot_noise+c.over_noise<b.tot_noise+b.over_noise||c.max_noise>0&&b.max_noise>-.1&&b.max_noise>c.max_noise-.15&&c.tot_noise+c.over_noise+c.over_noise<b.tot_noise+b.over_noise+b.over_noise;break;case 5:f=c.over_noise<b.over_noise||r.EQ(c.over_noise,b.over_noise)&&c.tot_noise<b.tot_noise;break;case 6:f=c.over_noise<b.over_noise||r.EQ(c.over_noise,b.over_noise)&&(c.max_noise<b.max_noise||r.EQ(c.max_noise,b.max_noise)&&c.tot_noise<=b.tot_noise);break;case 7:f=c.over_count<b.over_count||c.over_noise<b.over_noise}return 0==b.over_count&&(f=f&&c.bits<b.bits),f}function j(a,b,c,d,e){var f,g=a.internal_flags;f=0==b.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var h=0,i=0;i<b.sfbmax;i++)h<c[i]&&(h=c[i]);var j=g.noise_shaping_amp;switch(3==j&&(j=e?2:1),j){case 2:break;case 1:h>1?h=Math.pow(h,.5):h*=.95;break;case 0:default:h>1?h=1:h*=.95}for(var k=0,i=0;i<b.sfbmax;i++){var l,m=b.width[i];if(k+=m,!(c[i]<h)){if(0!=(2&g.substep_shaping)&&(g.pseudohalf[i]=0==g.pseudohalf[i]?1:0,0==g.pseudohalf[i]&&2==g.noise_shaping_amp))return;for(b.scalefac[i]++,l=-m;0>l;l++)d[k+l]*=f,d[k+l]>b.xrpow_max&&(b.xrpow_max=d[k+l]);if(2==g.noise_shaping_amp)return}}}function l(a,b){for(var c=1.2968395546510096,d=0,e=0;e<a.sfbmax;e++){var f=a.width[e],g=a.scalefac[e];if(0!=a.preflag&&(g+=q.pretab[e]),d+=f,0!=(1&g)){g++;for(var h=-f;0>h;h++)b[d+h]*=c,b[d+h]>a.xrpow_max&&(a.xrpow_max=b[d+h])}a.scalefac[e]=g>>1}a.preflag=0,a.scalefac_scale=1}function m(a,b,c){var d,e=b.scalefac;for(d=0;d<b.sfb_lmax;d++)if(e[d]>=16)return!0;for(var f=0;3>f;f++){var g=0,h=0;for(d=b.sfb_lmax+f;d<b.sfbdivide;d+=3)g<e[d]&&(g=e[d]);for(;d<b.sfbmax;d+=3)h<e[d]&&(h=e[d]);if(!(16>g&&8>h)){if(b.subblock_gain[f]>=7)return!0;b.subblock_gain[f]++;var i=a.scalefac_band.l[b.sfb_lmax];for(d=b.sfb_lmax+f;d<b.sfbmax;d+=3){var j,k=b.width[d],l=e[d];if(l-=4>>b.scalefac_scale,l>=0)e[d]=l,i+=3*k;else{e[d]=0;var m=210+(l<<b.scalefac_scale+1);j=q.IPOW20(m),i+=k*(f+1);for(var n=-k;0>n;n++)c[i+n]*=j,c[i+n]>b.xrpow_max&&(b.xrpow_max=c[i+n]);i+=k*(3-f-1)}}var j=q.IPOW20(202);i+=b.width[d]*(f+1);for(var n=-b.width[d];0>n;n++)c[i+n]*=j,c[i+n]>b.xrpow_max&&(b.xrpow_max=c[i+n])}}return!1}function n(a,b,c,d,e){var g=a.internal_flags;j(a,b,c,d,e);var h=f(b);return h?!1:(h=2==g.mode_gr?s.scale_bitcount(b):s.scale_bitcount_lsf(g,b))?(g.noise_shaping>1&&(Y.fill(g.pseudohalf,0),0==b.scalefac_scale?(l(b,d),h=!1):b.block_type==I.SHORT_TYPE&&g.subblock_gain>0&&(h=m(g,b,d)||f(b))),h||(h=2==g.mode_gr?s.scale_bitcount(b):s.scale_bitcount_lsf(g,b)),!h):!0}var o;this.rv=null;var p;this.qupvt=null;var q,s,t=new v;this.setModules=function(a,b,c,d){o=a,p=b,this.rv=b,q=c,this.qupvt=c,s=d,t.setModules(q,s)},this.ms_convert=function(a,b){for(var c=0;576>c;++c){var d=a.tt[b][0].xr[c],e=a.tt[b][1].xr[c];a.tt[b][0].xr[c]=(d+e)*(.5*$.SQRT2),a.tt[b][1].xr[c]=(d-e)*(.5*$.SQRT2)}},this.init_xrpow=function(b,c,d){var e=0,f=0|c.max_nonzero_coeff;if(c.xrpow_max=0,Y.fill(d,f,576,0),e=a(c,d,f,e),e>1e-20){var g=0;0!=(2&b.substep_shaping)&&(g=1);for(var h=0;h<c.psymax;h++)b.pseudohalf[h]=g;return!0}return Y.fill(c.l3_enc,0,576,0),!1},this.init_outer_loop=function(a,c){c.part2_3_length=0,c.big_values=0,c.count1=0,c.global_gain=210,c.scalefac_compress=0,c.table_select[0]=0,c.table_select[1]=0,c.table_select[2]=0,c.subblock_gain[0]=0,c.subblock_gain[1]=0,c.subblock_gain[2]=0,c.subblock_gain[3]=0,c.region0_count=0,c.region1_count=0,c.preflag=0,c.scalefac_scale=0,c.count1table_select=0,c.part2_length=0,c.sfb_lmax=I.SBPSY_l,c.sfb_smin=I.SBPSY_s,c.psy_lmax=a.sfb21_extra?I.SBMAX_l:I.SBPSY_l,c.psymax=c.psy_lmax,c.sfbmax=c.sfb_lmax,c.sfbdivide=11;for(var e=0;e<I.SBMAX_l;e++)c.width[e]=a.scalefac_band.l[e+1]-a.scalefac_band.l[e],c.window[e]=3;if(c.block_type==I.SHORT_TYPE){var f=d(576);c.sfb_smin=0,c.sfb_lmax=0,0!=c.mixed_block_flag&&(c.sfb_smin=3,c.sfb_lmax=2*a.mode_gr+4),c.psymax=c.sfb_lmax+3*((a.sfb21_extra?I.SBMAX_s:I.SBPSY_s)-c.sfb_smin),c.sfbmax=c.sfb_lmax+3*(I.SBPSY_s-c.sfb_smin),c.sfbdivide=c.sfbmax-18,c.psy_lmax=c.sfb_lmax;var g=a.scalefac_band.l[c.sfb_lmax];Z.arraycopy(c.xr,0,f,0,576);for(var e=c.sfb_smin;e<I.SBMAX_s;e++)for(var h=a.scalefac_band.s[e],i=a.scalefac_band.s[e+1],j=0;3>j;j++)for(var k=h;i>k;k++)c.xr[g++]=f[3*k+j];for(var l=c.sfb_lmax,e=c.sfb_smin;e<I.SBMAX_s;e++)c.width[l]=c.width[l+1]=c.width[l+2]=a.scalefac_band.s[e+1]-a.scalefac_band.s[e],c.window[l]=0,c.window[l+1]=1,c.window[l+2]=2,l+=3}c.count1bits=0,c.sfb_partition_table=q.nr_of_sfb_block[0][0],c.slen[0]=0,c.slen[1]=0,c.slen[2]=0,c.slen[3]=0,c.max_nonzero_coeff=575,Y.fill(c.scalefac,0),b(a,c)},c.BINSEARCH_NONE=new c(0),c.BINSEARCH_UP=new c(1),c.BINSEARCH_DOWN=new c(2),this.trancate_smallspectrums=function(a,b,c,e){var f=d(ba.SFBMAX);if((0!=(4&a.substep_shaping)||b.block_type!=I.SHORT_TYPE)&&0==(128&a.substep_shaping)){q.calc_noise(b,c,f,new w,null);for(var g=0;576>g;g++){var h=0;0!=b.l3_enc[g]&&(h=Math.abs(b.xr[g])),e[g]=h}var g=0,i=8;b.block_type==I.SHORT_TYPE&&(i=6);do{var j,k,l,m,n=b.width[i];if(g+=n,!(f[i]>=1||(Y.sort(e,g-n,n),r.EQ(e[g-1],0)))){j=(1-f[i])*c[i],k=0,m=0;do{var o;for(l=1;n>m+l&&!r.NEQ(e[m+g-n],e[m+g+l-n]);l++);if(o=e[m+g-n]*e[m+g-n]*l,o>j){0!=m&&(k=e[m+g-n-1]);break}j-=o,m+=l}while(n>m);if(!r.EQ(k,0))do Math.abs(b.xr[g-n])<=k&&(b.l3_enc[g-n]=0);while(--n>0)}}while(++i<b.psymax);b.part2_3_length=s.noquant_count_bits(a,b,null)}},this.outer_loop=function(a,b,c,f,g,h){var j,l=a.internal_flags,m=new E,o=d(576),p=d(ba.SFBMAX),r=new w,t=new D,u=9999999,v=!1,x=!1,y=0;if(e(l,b,h,g,f),0==l.noise_shaping)return 100;q.calc_noise(b,c,p,r,t),r.bits=b.part2_3_length,m.assign(b);var z=0;for(Z.arraycopy(f,0,o,0,576);!v;){do{var A,B=new w,C=255;if(A=0!=(2&l.substep_shaping)?20:3,l.sfb21_extra){if(p[m.sfbmax]>1)break;if(m.block_type==I.SHORT_TYPE&&(p[m.sfbmax+1]>1||p[m.sfbmax+2]>1))break}if(!n(a,m,p,f,x))break;0!=m.scalefac_scale&&(C=254);var F=h-m.part2_length;if(0>=F)break;for(;(m.part2_3_length=s.count_bits(l,f,m,t))>F&&m.global_gain<=C;)m.global_gain++;if(m.global_gain>C)break;if(0==r.over_count){for(;(m.part2_3_length=s.count_bits(l,f,m,t))>u&&m.global_gain<=C;)m.global_gain++;if(m.global_gain>C)break}if(q.calc_noise(m,c,p,B,t),B.bits=m.part2_3_length,j=b.block_type!=I.SHORT_TYPE?a.quant_comp:a.quant_comp_short,j=i(j,r,B,m,p)?1:0,0!=j)u=b.part2_3_length,r=B,b.assign(m),z=0,Z.arraycopy(f,0,o,0,576);else if(0==l.full_outer_loop){if(++z>A&&0==r.over_count)break;if(3==l.noise_shaping_amp&&x&&z>30)break;if(3==l.noise_shaping_amp&&x&&m.global_gain-y>15)break}}while(m.global_gain+m.scalefac_scale<255);3==l.noise_shaping_amp?x?v=!0:(m.assign(b),Z.arraycopy(o,0,f,0,576),z=0,y=m.global_gain,x=!0):v=!0}return a.VBR==k.vbr_rh||a.VBR==k.vbr_mtrh?Z.arraycopy(o,0,f,0,576):0!=(1&l.substep_shaping)&&trancate_smallspectrums(l,b,c,f),r.over_count},this.iteration_finish_one=function(a,b,c){var d=a.l3_side,e=d.tt[b][c];s.best_scalefac_store(a,b,c,d),1==a.use_best_huffman&&s.best_huffman_divide(a,e),p.ResvAdjust(a,e)},this.VBR_encode_granule=function(a,b,c,e,f,g,h){var i,j,k=a.internal_flags,l=new E,m=d(576),n=h,o=h+1,p=(h+g)/2,q=0,r=k.sfb21_extra;Y.fill(l.l3_enc,0);do p>n-42?k.sfb21_extra=!1:k.sfb21_extra=r,j=outer_loop(a,b,c,e,f,p),0>=j?(q=1,o=b.part2_3_length,l.assign(b),Z.arraycopy(e,0,m,0,576),h=o-32,i=h-g,p=(h+g)/2):(g=p+32,i=h-g,p=(h+g)/2,0!=q&&(q=2,b.assign(l),Z.arraycopy(m,0,e,0,576)));while(i>12);k.sfb21_extra=r,2==q&&Z.arraycopy(l.l3_enc,0,b.l3_enc,0,576)},this.get_framebits=function(a,b){var c=a.internal_flags;c.bitrate_index=c.VBR_min_bitrate;var d=o.getframebits(a);c.bitrate_index=1,d=o.getframebits(a);for(var e=1;e<=c.VBR_max_bitrate;e++){c.bitrate_index=e;var f=new u(d);b[e]=p.ResvFrameBegin(a,f),d=f.bits}},this.VBR_old_prepare=function(a,b,c,d,e,f,g,h,i){var j,k=a.internal_flags,l=0,m=1,n=0;k.bitrate_index=k.VBR_max_bitrate;var o=p.ResvFrameBegin(a,new u(0))/k.mode_gr;get_framebits(a,f);for(var r=0;r<k.mode_gr;r++){var s=q.on_pe(a,b,h[r],o,r,0);k.mode_ext==I.MPG_MD_MS_LR&&(ms_convert(k.l3_side,r),q.reduce_side(h[r],c[r],o,s));for(var t=0;t<k.channels_out;++t){var v=k.l3_side.tt[r][t];v.block_type!=I.SHORT_TYPE?(l=1.28/(1+Math.exp(3.5-b[r][t]/300))-.05,j=k.PSY.mask_adjust-l):(l=2.56/(1+Math.exp(3.5-b[r][t]/300))-.14,j=k.PSY.mask_adjust_short-l),k.masking_lower=Math.pow(10,.1*j),init_outer_loop(k,v),i[r][t]=q.calc_xmin(a,d[r][t],v,e[r][t]),0!=i[r][t]&&(m=0),g[r][t]=126,n+=h[r][t]}}for(var r=0;r<k.mode_gr;r++)for(var t=0;t<k.channels_out;t++)n>f[k.VBR_max_bitrate]&&(h[r][t]*=f[k.VBR_max_bitrate],h[r][t]/=n),g[r][t]>h[r][t]&&(g[r][t]=h[r][t]);return m},this.bitpressure_strategy=function(a,b,c,d){for(var e=0;e<a.mode_gr;e++)for(var f=0;f<a.channels_out;f++){for(var g=a.l3_side.tt[e][f],h=b[e][f],i=0,j=0;j<g.psy_lmax;j++)h[i++]*=1+.029*j*j/I.SBMAX_l/I.SBMAX_l;if(g.block_type==I.SHORT_TYPE)for(var j=g.sfb_smin;j<I.SBMAX_s;j++)h[i++]*=1+.029*j*j/I.SBMAX_s/I.SBMAX_s,h[i++]*=1+.029*j*j/I.SBMAX_s/I.SBMAX_s,h[i++]*=1+.029*j*j/I.SBMAX_s/I.SBMAX_s;d[e][f]=0|Math.max(c[e][f],.9*d[e][f])}},this.VBR_new_prepare=function(a,b,c,d,e,f){var g,h=a.internal_flags,i=1,j=0,k=0;if(a.free_format){h.bitrate_index=0;var l=new u(j);g=p.ResvFrameBegin(a,l),j=l.bits,e[0]=g}else{h.bitrate_index=h.VBR_max_bitrate;var l=new u(j);p.ResvFrameBegin(a,l),j=l.bits,get_framebits(a,e),g=e[h.VBR_max_bitrate]}for(var m=0;m<h.mode_gr;m++){q.on_pe(a,b,f[m],j,m,0),h.mode_ext==I.MPG_MD_MS_LR&&ms_convert(h.l3_side,m);for(var n=0;n<h.channels_out;++n){var o=h.l3_side.tt[m][n];h.masking_lower=Math.pow(10,.1*h.PSY.mask_adjust),init_outer_loop(h,o),0!=q.calc_xmin(a,c[m][n],o,d[m][n])&&(i=0),k+=f[m][n]}}for(var m=0;m<h.mode_gr;m++)for(var n=0;n<h.channels_out;n++)k>g&&(f[m][n]*=g,f[m][n]/=k);return i},this.calc_target_bits=function(a,b,c,d,e,f){var g,h,i,j,k=a.internal_flags,l=k.l3_side,m=0;k.bitrate_index=k.VBR_max_bitrate;var n=new u(m);for(f[0]=p.ResvFrameBegin(a,n),m=n.bits,k.bitrate_index=1,m=o.getframebits(a)-8*k.sideinfo_len,e[0]=m/(k.mode_gr*k.channels_out),m=a.VBR_mean_bitrate_kbps*a.framesize*1e3,0!=(1&k.substep_shaping)&&(m*=1.09),m/=a.out_samplerate,m-=8*k.sideinfo_len,m/=k.mode_gr*k.channels_out,g=.93+.07*(11-a.compression_ratio)/5.5,.9>g&&(g=.9),g>1&&(g=1),h=0;h<k.mode_gr;h++){var r=0;for(i=0;i<k.channels_out;i++){if(d[h][i]=int(g*m),b[h][i]>700){var s=int((b[h][i]-700)/1.4),t=l.tt[h][i];d[h][i]=int(g*m),t.block_type==I.SHORT_TYPE&&m/2>s&&(s=m/2),s>3*m/2?s=3*m/2:0>s&&(s=0),d[h][i]+=s}d[h][i]>N.MAX_BITS_PER_CHANNEL&&(d[h][i]=N.MAX_BITS_PER_CHANNEL),r+=d[h][i]}if(r>N.MAX_BITS_PER_GRANULE)for(i=0;i<k.channels_out;++i)d[h][i]*=N.MAX_BITS_PER_GRANULE,d[h][i]/=r}if(k.mode_ext==I.MPG_MD_MS_LR)for(h=0;h<k.mode_gr;h++)q.reduce_side(d[h],c[h],m*k.channels_out,N.MAX_BITS_PER_GRANULE);for(j=0,h=0;h<k.mode_gr;h++)for(i=0;i<k.channels_out;i++)d[h][i]>N.MAX_BITS_PER_CHANNEL&&(d[h][i]=N.MAX_BITS_PER_CHANNEL),j+=d[h][i];if(j>f[0])for(h=0;h<k.mode_gr;h++)for(i=0;i<k.channels_out;i++)d[h][i]*=f[0],d[h][i]/=j}}function G(){this.thm=new M,this.en=new M}function H(){function a(a,b,c){for(var d=10,f=b+238-14-286,g=-15;0>g;g++){var h,i,j;h=e[d+-10],i=a[f+-224]*h,j=a[b+224]*h,h=e[d+-9],i+=a[f+-160]*h,j+=a[b+160]*h,h=e[d+-8],i+=a[f+-96]*h,j+=a[b+96]*h,h=e[d+-7],i+=a[f+-32]*h,j+=a[b+32]*h,h=e[d+-6],i+=a[f+32]*h,j+=a[b+-32]*h,h=e[d+-5],i+=a[f+96]*h,j+=a[b+-96]*h,h=e[d+-4],i+=a[f+160]*h,j+=a[b+-160]*h,h=e[d+-3],i+=a[f+224]*h,j+=a[b+-224]*h,h=e[d+-2],i+=a[b+-256]*h,j-=a[f+256]*h,h=e[d+-1],i+=a[b+-192]*h,j-=a[f+192]*h,h=e[d+0],i+=a[b+-128]*h,j-=a[f+128]*h,h=e[d+1],i+=a[b+-64]*h,j-=a[f+64]*h,h=e[d+2],i+=a[b+0]*h,j-=a[f+0]*h,h=e[d+3],i+=a[b+64]*h,j-=a[f+-64]*h,h=e[d+4],i+=a[b+128]*h,j-=a[f+-128]*h,h=e[d+5],i+=a[b+192]*h,j-=a[f+-192]*h,i*=e[d+6],h=j-i,c[30+2*g]=j+i,c[31+2*g]=e[d+7]*h,d+=18,b--,f++}var i,j,k,l;j=a[b+-16]*e[d+-10],i=a[b+-32]*e[d+-2],j+=(a[b+-48]-a[b+16])*e[d+-9],i+=a[b+-96]*e[d+-1],j+=(a[b+-80]+a[b+48])*e[d+-8],i+=a[b+-160]*e[d+0],j+=(a[b+-112]-a[b+80])*e[d+-7],i+=a[b+-224]*e[d+1],j+=(a[b+-144]+a[b+112])*e[d+-6],i-=a[b+32]*e[d+2],j+=(a[b+-176]-a[b+144])*e[d+-5],i-=a[b+96]*e[d+3],j+=(a[b+-208]+a[b+176])*e[d+-4],i-=a[b+160]*e[d+4],j+=(a[b+-240]-a[b+208])*e[d+-3],i-=a[b+224],k=i-j,l=i+j,j=c[14],i=c[15]-j,c[31]=l+j,c[30]=k+i,c[15]=k-i,c[14]=l-j;var m;m=c[28]-c[0],c[0]+=c[28],c[28]=m*e[d+-36+7],m=c[29]-c[1],c[1]+=c[29],c[29]=m*e[d+-36+7],m=c[26]-c[2],c[2]+=c[26],c[26]=m*e[d+-72+7],m=c[27]-c[3],c[3]+=c[27],c[27]=m*e[d+-72+7],m=c[24]-c[4],c[4]+=c[24],c[24]=m*e[d+-108+7],m=c[25]-c[5],c[5]+=c[25],c[25]=m*e[d+-108+7],m=c[22]-c[6],c[6]+=c[22],c[22]=m*$.SQRT2,m=c[23]-c[7],c[7]+=c[23],c[23]=m*$.SQRT2-c[7],c[7]-=c[6],c[22]-=c[7],c[23]-=c[22],m=c[6],c[6]=c[31]-m,c[31]=c[31]+m,m=c[7],c[7]=c[30]-m,c[30]=c[30]+m,m=c[22],c[22]=c[15]-m,c[15]=c[15]+m,m=c[23],c[23]=c[14]-m,c[14]=c[14]+m,m=c[20]-c[8],c[8]+=c[20],c[20]=m*e[d+-180+7],m=c[21]-c[9],c[9]+=c[21],c[21]=m*e[d+-180+7],m=c[18]-c[10],c[10]+=c[18],c[18]=m*e[d+-216+7],m=c[19]-c[11],c[11]+=c[19],c[19]=m*e[d+-216+7],m=c[16]-c[12],c[12]+=c[16],c[16]=m*e[d+-252+7],m=c[17]-c[13],c[13]+=c[17],c[17]=m*e[d+-252+7],m=-c[20]+c[24],c[20]+=c[24],c[24]=m*e[d+-216+7],m=-c[21]+c[25],c[21]+=c[25],c[25]=m*e[d+-216+7],m=c[4]-c[8],c[4]+=c[8],c[8]=m*e[d+-216+7],m=c[5]-c[9],c[5]+=c[9],c[9]=m*e[d+-216+7],m=c[0]-c[12],c[0]+=c[12],c[12]=m*e[d+-72+7],m=c[1]-c[13],c[1]+=c[13],c[13]=m*e[d+-72+7],m=c[16]-c[28],c[16]+=c[28],c[28]=m*e[d+-72+7],m=-c[17]+c[29],c[17]+=c[29],c[29]=m*e[d+-72+7],m=$.SQRT2*(c[2]-c[10]),c[2]+=c[10],c[10]=m,m=$.SQRT2*(c[3]-c[11]),c[3]+=c[11],c[11]=m,m=$.SQRT2*(-c[18]+c[26]),c[18]+=c[26],c[26]=m-c[18],m=$.SQRT2*(-c[19]+c[27]),c[19]+=c[27],c[27]=m-c[19],m=c[2],c[19]-=c[3],c[3]-=m,c[2]=c[31]-m,c[31]+=m,m=c[3],c[11]-=c[19],c[18]-=m,c[3]=c[30]-m,c[30]+=m,m=c[18],c[27]-=c[11],c[19]-=m,c[18]=c[15]-m,c[15]+=m,m=c[19],c[10]-=m,c[19]=c[14]-m,c[14]+=m,m=c[10],c[11]-=m,c[10]=c[23]-m,c[23]+=m,m=c[11],c[26]-=m,c[11]=c[22]-m,c[22]+=m,m=c[26],c[27]-=m,c[26]=c[7]-m,c[7]+=m,m=c[27],c[27]=c[6]-m,c[6]+=m,m=$.SQRT2*(c[0]-c[4]),c[0]+=c[4],c[4]=m,m=$.SQRT2*(c[1]-c[5]),c[1]+=c[5],c[5]=m,m=$.SQRT2*(c[16]-c[20]),c[16]+=c[20],c[20]=m,m=$.SQRT2*(c[17]-c[21]),c[17]+=c[21],c[21]=m,m=-$.SQRT2*(c[8]-c[12]),c[8]+=c[12],c[12]=m-c[8],m=-$.SQRT2*(c[9]-c[13]),c[9]+=c[13],c[13]=m-c[9],m=-$.SQRT2*(c[25]-c[29]),c[25]+=c[29],c[29]=m-c[25],m=-$.SQRT2*(c[24]+c[28]),c[24]-=c[28],c[28]=m-c[24],m=c[24]-c[16],c[24]=m,m=c[20]-m,c[20]=m,m=c[28]-m,c[28]=m,m=c[25]-c[17],c[25]=m,m=c[21]-m,c[21]=m,m=c[29]-m,c[29]=m,m=c[17]-c[1],c[17]=m,m=c[9]-m,c[9]=m,m=c[25]-m,c[25]=m,m=c[5]-m,c[5]=m,m=c[21]-m,c[21]=m,m=c[13]-m,c[13]=m,m=c[29]-m,c[29]=m,m=c[1]-c[0],c[1]=m,m=c[16]-m,c[16]=m,m=c[17]-m,c[17]=m,m=c[8]-m,c[8]=m,m=c[9]-m,c[9]=m,m=c[24]-m,c[24]=m,m=c[25]-m,c[25]=m,m=c[4]-m,c[4]=m,m=c[5]-m,c[5]=m,m=c[20]-m,c[20]=m,m=c[21]-m,c[21]=m,m=c[12]-m,c[12]=m,m=c[13]-m,c[13]=m,m=c[28]-m,c[28]=m,m=c[29]-m,c[29]=m,m=c[0],c[0]+=c[31],c[31]-=m,m=c[1],c[1]+=c[30],c[30]-=m,m=c[16],c[16]+=c[15],c[15]-=m,m=c[17],c[17]+=c[14],c[14]-=m,m=c[8],c[8]+=c[23],c[23]-=m,m=c[9],c[9]+=c[22],c[22]-=m,m=c[24],c[24]+=c[7],c[7]-=m,m=c[25],c[25]+=c[6],c[6]-=m,m=c[4],c[4]+=c[27],c[27]-=m,m=c[5],c[5]+=c[26],c[26]-=m,m=c[20],c[20]+=c[11],c[11]-=m,m=c[21],c[21]+=c[10],c[10]-=m,m=c[12],c[12]+=c[19],c[19]-=m,m=c[13],c[13]+=c[18],c[18]-=m,m=c[28],c[28]+=c[3],c[3]-=m,m=c[29],c[29]+=c[2],c[2]-=m}function b(a,b){for(var c=0;3>c;c++){var d,e,f,g,i,j;g=a[b+6]*h[I.SHORT_TYPE][0]-a[b+15],d=a[b+0]*h[I.SHORT_TYPE][2]-a[b+9],e=g+d,f=g-d,g=a[b+15]*h[I.SHORT_TYPE][0]+a[b+6],d=a[b+9]*h[I.SHORT_TYPE][2]+a[b+0],i=g+d,j=-g+d,d=2.069978111953089e-11*(a[b+3]*h[I.SHORT_TYPE][1]-a[b+12]),g=2.069978111953089e-11*(a[b+12]*h[I.SHORT_TYPE][1]+a[b+3]),a[b+0]=1.90752519173728e-11*e+d,a[b+15]=1.90752519173728e-11*-i+g,f=.8660254037844387*f*1.907525191737281e-11,i=.5*i*1.907525191737281e-11+g,a[b+3]=f-i,a[b+6]=f+i,e=.5*e*1.907525191737281e-11-d,j=.8660254037844387*j*1.907525191737281e-11,a[b+9]=e+j,a[b+12]=e-j,b++}}function c(a,b,c){var d,e,f,g,h,i,k,l,m,n;f=c[17]-c[9],h=c[15]-c[11],i=c[14]-c[12],k=c[0]+c[8],l=c[1]+c[7],m=c[2]+c[6],n=c[3]+c[5],a[b+17]=k+m-n-(l-c[4]),e=(k+m-n)*j[19]+(l-c[4]),d=(f-h-i)*j[18],a[b+5]=d+e,a[b+6]=d-e,g=(c[16]-c[10])*j[18],l=l*j[19]+c[4],d=f*j[12]+g+h*j[13]+i*j[14],e=-k*j[16]+l-m*j[17]+n*j[15],a[b+1]=d+e,a[b+2]=d-e,d=f*j[13]-g-h*j[14]+i*j[12],e=-k*j[17]+l-m*j[15]+n*j[16],a[b+9]=d+e,a[b+10]=d-e,d=f*j[14]-g+h*j[12]-i*j[13],e=k*j[15]-l+m*j[16]-n*j[17],a[b+13]=d+e,a[b+14]=d-e;var o,p,q,r,s,t,u,v;o=c[8]-c[0],q=c[6]-c[2],r=c[5]-c[3],s=c[17]+c[9],t=c[16]+c[10],u=c[15]+c[11],v=c[14]+c[12],a[b+0]=s+u+v+(t+c[13]),d=(s+u+v)*j[19]-(t+c[13]),e=(o-q+r)*j[18],a[b+11]=d+e,a[b+12]=d-e,p=(c[7]-c[1])*j[18],t=c[13]-t*j[19],d=s*j[15]-t+u*j[16]+v*j[17],e=o*j[14]+p+q*j[12]+r*j[13],a[b+3]=d+e,a[b+4]=d-e,d=-s*j[17]+t-u*j[15]-v*j[16],e=o*j[13]+p-q*j[14]-r*j[12],a[b+7]=d+e,a[b+8]=d-e,d=-s*j[16]+t-u*j[17]-v*j[15],e=o*j[12]-p+q*j[13]-r*j[14],a[b+15]=d+e,a[b+16]=d-e}var e=[-0.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-0.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-0.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-0.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-0.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-0.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-0.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-0.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-0.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-0.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-0.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-0.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-0.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-0.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-0.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*$.SQRT2*.5/2384e-9,.017876148*$.SQRT2*.5/2384e-9,.003134727*$.SQRT2*.5/2384e-9,.002457142*$.SQRT2*.5/2384e-9,971317e-9*$.SQRT2*.5/2384e-9,218868e-9*$.SQRT2*.5/2384e-9,101566e-9*$.SQRT2*.5/2384e-9,13828e-9*$.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,49591e-9/2384e-9,1995.1556208053692,21458e-9/2384e-9,-69618e-9/2384e-9],f=12,g=36,h=[[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.40084909404969e-13,6.423305872147839e-13,2.382191739347918e-13,5.456116108943412e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758252e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558783e-12,8.371015190102974e-13,2.599706096327376e-13,-5.456116108943412e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758252e-12,-2.858043359288076e-12,-2.156177623817898e-12,-1.475637723558783e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347923e-13,-6.423305872147843e-13,-9.400849094049696e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049694e-13,-6.42330587214784e-13,-2.382191739347918e-13],[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.400849094049688e-13,6.423305872147841e-13,2.382191739347918e-13,5.456116108943413e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758253e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558782e-12,8.371015190102975e-13,2.599706096327376e-13,-5.461314069809755e-12,-4.921085770524055e-12,-4.343405037091838e-12,-3.732668368707687e-12,-3.093523840190885e-12,-2.430835727329465e-12,-1.734679010007751e-12,-9.74825365660928e-13,-2.797435120168326e-13,0,0,0,0,0,0,-2.283748241799531e-13,-4.037858874020686e-13,-2.146547464825323e-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531e-13,4.037858874020686e-13,2.146547464825323e-13,5.461314069809755e-12,4.921085770524055e-12,4.343405037091838e-12,3.732668368707687e-12,3.093523840190885e-12,2.430835727329466e-12,1.734679010007751e-12,9.74825365660928e-13,2.797435120168326e-13,-5.456116108943413e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758253e-12,-2.858043359288075e-12,-2.156177623817898e-12,-1.475637723558782e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347913e-13,-6.423305872147834e-13,-9.400849094049688e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049688e-13,-6.423305872147841e-13,-2.382191739347918e-13]],i=h[I.SHORT_TYPE],j=h[I.SHORT_TYPE],k=h[I.SHORT_TYPE],l=h[I.SHORT_TYPE],m=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];
this.mdct_sub48=function(e,j,n){for(var o=j,p=286,q=0;q<e.channels_out;q++){for(var r=0;r<e.mode_gr;r++){for(var s,t=e.l3_side.tt[r][q],u=t.xr,v=0,w=e.sb_sample[q][1-r],x=0,y=0;9>y;y++)for(a(o,p,w[x]),a(o,p+32,w[x+1]),x+=2,p+=64,s=1;32>s;s+=2)w[x-1][s]*=-1;for(s=0;32>s;s++,v+=18){var z=t.block_type,A=e.sb_sample[q][r],B=e.sb_sample[q][1-r];if(0!=t.mixed_block_flag&&2>s&&(z=0),e.amp_filter[s]<1e-12)Y.fill(u,v+0,v+18,0);else{if(e.amp_filter[s]<1)for(var y=0;18>y;y++)B[y][m[s]]*=e.amp_filter[s];if(z==I.SHORT_TYPE){for(var y=-f/4;0>y;y++){var C=h[I.SHORT_TYPE][y+3];u[v+3*y+9]=A[9+y][m[s]]*C-A[8-y][m[s]],u[v+3*y+18]=A[14-y][m[s]]*C+A[15+y][m[s]],u[v+3*y+10]=A[15+y][m[s]]*C-A[14-y][m[s]],u[v+3*y+19]=B[2-y][m[s]]*C+B[3+y][m[s]],u[v+3*y+11]=B[3+y][m[s]]*C-B[2-y][m[s]],u[v+3*y+20]=B[8-y][m[s]]*C+B[9+y][m[s]]}b(u,v)}else{for(var D=d(18),y=-g/4;0>y;y++){var E,F;E=h[z][y+27]*B[y+9][m[s]]+h[z][y+36]*B[8-y][m[s]],F=h[z][y+9]*A[y+9][m[s]]-h[z][y+18]*A[8-y][m[s]],D[y+9]=E-F*i[3+y+9],D[y+18]=E*i[3+y+9]+F}c(u,v,D)}}if(z!=I.SHORT_TYPE&&0!=s)for(var y=7;y>=0;--y){var G,H;G=u[v+y]*k[20+y]+u[v+-1-y]*l[28+y],H=u[v+y]*l[28+y]-u[v+-1-y]*k[20+y],u[v+-1-y]=G,u[v+y]=H}}}if(o=n,p=286,1==e.mode_gr)for(var J=0;18>J;J++)Z.arraycopy(e.sb_sample[q][1][J],0,e.sb_sample[q][0][J],0,32)}}}function I(){function a(a){var b,c;if(0==a.ATH.useAdjust)return void(a.ATH.adjust=1);if(c=a.loudness_sq[0][0],b=a.loudness_sq[1][0],2==a.channels_out?(c+=a.loudness_sq[0][1],b+=a.loudness_sq[1][1]):(c+=c,b+=b),2==a.mode_gr&&(c=Math.max(c,b)),c*=.5,c*=a.ATH.aaSensitivityP,c>.03125)a.ATH.adjust>=1?a.ATH.adjust=1:a.ATH.adjust<a.ATH.adjustLimit&&(a.ATH.adjust=a.ATH.adjustLimit),a.ATH.adjustLimit=1;else{var d=31.98*c+625e-6;a.ATH.adjust>=d?(a.ATH.adjust*=.075*d+.925,a.ATH.adjust<d&&(a.ATH.adjust=d)):a.ATH.adjustLimit>=d?a.ATH.adjust=d:a.ATH.adjust<a.ATH.adjustLimit&&(a.ATH.adjust=a.ATH.adjustLimit),a.ATH.adjustLimit=d}}function b(a){var b,c;for(a.bitrate_stereoMode_Hist[a.bitrate_index][4]++,a.bitrate_stereoMode_Hist[15][4]++,2==a.channels_out&&(a.bitrate_stereoMode_Hist[a.bitrate_index][a.mode_ext]++,a.bitrate_stereoMode_Hist[15][a.mode_ext]++),b=0;b<a.mode_gr;++b)for(c=0;c<a.channels_out;++c){var d=0|a.l3_side.tt[b][c].block_type;0!=a.l3_side.tt[b][c].mixed_block_flag&&(d=4),a.bitrate_blockType_Hist[a.bitrate_index][d]++,a.bitrate_blockType_Hist[a.bitrate_index][5]++,a.bitrate_blockType_Hist[15][d]++,a.bitrate_blockType_Hist[15][5]++}}function e(a,b){var c,e,f=a.internal_flags;if(0==f.lame_encode_frame_init){var g,h,i=d(2014),j=d(2014);for(f.lame_encode_frame_init=1,g=0,h=0;g<286+576*(1+f.mode_gr);++g)g<576*f.mode_gr?(i[g]=0,2==f.channels_out&&(j[g]=0)):(i[g]=b[0][h],2==f.channels_out&&(j[g]=b[1][h]),++h);for(e=0;e<f.mode_gr;e++)for(c=0;c<f.channels_out;c++)f.l3_side.tt[e][c].block_type=I.SHORT_TYPE;p.mdct_sub48(f,i,j)}}var g=I.FFTOFFSET,h=I.MPG_MD_MS_LR,j=null;this.psy=null;var m=null,n=null,o=null;this.setModules=function(a,b,c,d){j=a,this.psy=b,m=b,n=d,o=c};var p=new H;this.lame_encode_mp3_frame=function(d,q,r,s,t,u){var v,w=i([2,2]);w[0][0]=new G,w[0][1]=new G,w[1][0]=new G,w[1][1]=new G;var x=i([2,2]);x[0][0]=new G,x[0][1]=new G,x[1][0]=new G,x[1][1]=new G;var y,z,A,B,C=[null,null],D=d.internal_flags,E=f([2,4]),F=[.5,.5],H=[[0,0],[0,0]],J=[[0,0],[0,0]];if(C[0]=q,C[1]=r,0==D.lame_encode_frame_init&&e(d,C),D.padding=0,(D.slot_lag-=D.frac_SpF)<0&&(D.slot_lag+=d.out_samplerate,D.padding=1),0!=D.psymodel){var K,L=[null,null],M=0,N=c(2);for(B=0;B<D.mode_gr;B++){for(A=0;A<D.channels_out;A++)L[A]=C[A],M=576+576*B-I.FFTOFFSET;if(K=d.VBR==k.vbr_mtrh||d.VBR==k.vbr_mt?m.L3psycho_anal_vbr(d,L,M,B,w,x,H[B],J[B],E[B],N):m.L3psycho_anal_ns(d,L,M,B,w,x,H[B],J[B],E[B],N),0!=K)return-4;for(d.mode==l.JOINT_STEREO&&(F[B]=E[B][2]+E[B][3],F[B]>0&&(F[B]=E[B][3]/F[B])),A=0;A<D.channels_out;A++){var O=D.l3_side.tt[B][A];O.block_type=N[A],O.mixed_block_flag=0}}}else for(B=0;B<D.mode_gr;B++)for(A=0;A<D.channels_out;A++)D.l3_side.tt[B][A].block_type=I.NORM_TYPE,D.l3_side.tt[B][A].mixed_block_flag=0,J[B][A]=H[B][A]=700;if(a(D),p.mdct_sub48(D,C[0],C[1]),D.mode_ext=I.MPG_MD_LR_LR,d.force_ms)D.mode_ext=I.MPG_MD_MS_LR;else if(d.mode==l.JOINT_STEREO){var P=0,Q=0;for(B=0;B<D.mode_gr;B++)for(A=0;A<D.channels_out;A++)P+=J[B][A],Q+=H[B][A];if(1*Q>=P){var R=D.l3_side.tt[0],S=D.l3_side.tt[D.mode_gr-1];R[0].block_type==R[1].block_type&&S[0].block_type==S[1].block_type&&(D.mode_ext=I.MPG_MD_MS_LR)}}if(D.mode_ext==h?(y=x,z=J):(y=w,z=H),d.analysis&&null!=D.pinfo)for(B=0;B<D.mode_gr;B++)for(A=0;A<D.channels_out;A++)D.pinfo.ms_ratio[B]=D.ms_ratio[B],D.pinfo.ms_ener_ratio[B]=F[B],D.pinfo.blocktype[B][A]=D.l3_side.tt[B][A].block_type,D.pinfo.pe[B][A]=z[B][A],Z.arraycopy(D.l3_side.tt[B][A].xr,0,D.pinfo.xr[B][A],0,576),D.mode_ext==h&&(D.pinfo.ers[B][A]=D.pinfo.ers[B][A+2],Z.arraycopy(D.pinfo.energy[B][A+2],0,D.pinfo.energy[B][A],0,D.pinfo.energy[B][A].length));if(d.VBR==k.vbr_off||d.VBR==k.vbr_abr){var T,U;for(T=0;18>T;T++)D.nsPsy.pefirbuf[T]=D.nsPsy.pefirbuf[T+1];for(U=0,B=0;B<D.mode_gr;B++)for(A=0;A<D.channels_out;A++)U+=z[B][A];for(D.nsPsy.pefirbuf[18]=U,U=D.nsPsy.pefirbuf[9],T=0;9>T;T++)U+=(D.nsPsy.pefirbuf[T]+D.nsPsy.pefirbuf[18-T])*I.fircoef[T];for(U=3350*D.mode_gr*D.channels_out/U,B=0;B<D.mode_gr;B++)for(A=0;A<D.channels_out;A++)z[B][A]*=U}if(D.iteration_loop.iteration_loop(d,z,F,y),j.format_bitstream(d),v=j.copy_buffer(D,s,t,u,1),d.bWriteVbrTag&&n.addVbrFrame(d),d.analysis&&null!=D.pinfo){for(A=0;A<D.channels_out;A++){var V;for(V=0;g>V;V++)D.pinfo.pcmdata[A][V]=D.pinfo.pcmdata[A][V+d.framesize];for(V=g;1600>V;V++)D.pinfo.pcmdata[A][V]=C[A][V-g]}o.set_frame_pinfo(d,y)}return b(D),v}}function J(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function K(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[c(4),c(4)];for(var a=0;2>a;a++)for(var b=0;2>b;b++)this.tt[a][b]=new E}function L(){this.last_en_subshort=f([4,9]),this.lastAttacks=c(4),this.pefirbuf=d(19),this.longfact=d(I.SBMAX_l),this.shortfact=d(I.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function M(){this.l=d(I.SBMAX_l),this.s=f([I.SBMAX_s,3]);var a=this;this.assign=function(b){Z.arraycopy(b.l,0,a.l,0,I.SBMAX_l);for(var c=0;c<I.SBMAX_s;c++)for(var d=0;3>d;d++)a.s[c][d]=b.s[c][d]}}function N(){function b(){this.write_timing=0,this.ptr=0,this.buf=a(h)}var h=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=f([2,N.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new K,this.ms_ratio=d(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=c(2),this.CurrentStep=c(2),this.masking_lower=0,this.bv_scf=c(576),this.pseudohalf=c(ba.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*N.BPC+1),this.itime=e(2),this.sideinfo_len=0,this.sb_sample=f([2,2,18,I.SBLIMIT]),this.amp_filter=d(32),this.header=new Array(N.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new B,this.minval_l=d(I.CBANDS),this.minval_s=d(I.CBANDS),this.nb_1=f([4,I.CBANDS]),this.nb_2=f([4,I.CBANDS]),this.nb_s1=f([4,I.CBANDS]),this.nb_s2=f([4,I.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=d(4),this.loudness_sq=f([2,2]),this.loudness_sq_save=d(2),this.mld_l=d(I.SBMAX_l),this.mld_s=d(I.SBMAX_s),this.bm_l=c(I.SBMAX_l),this.bo_l=c(I.SBMAX_l),this.bm_s=c(I.SBMAX_s),this.bo_s=c(I.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=g([I.CBANDS,2]),this.s3ind_s=g([I.CBANDS,2]),this.numlines_s=c(I.CBANDS),this.numlines_l=c(I.CBANDS),this.rnumlines_l=d(I.CBANDS),this.mld_cb_l=d(I.CBANDS),this.mld_cb_s=d(I.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=d(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=c(2),this.nsPsy=new L,this.VBR_seek_table=new J,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=g([16,5]),this.bitrate_blockType_Hist=g([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new M;for(var i=0;i<this.thm.length;i++)this.thm[i]=new M;for(var i=0;i<this.header.length;i++)this.header[i]=new b}function O(){function a(a,b,c){var d,f,g,h=0;c<<=1;var i=b+c;d=4;do{var j,k,l,m,n,o,p;p=d>>1,m=d,n=d<<1,o=n+m,d=n<<1,f=b,g=f+p;do{var q,r,s,t;r=a[f+0]-a[f+m],q=a[f+0]+a[f+m],t=a[f+n]-a[f+o],s=a[f+n]+a[f+o],a[f+n]=q-s,a[f+0]=q+s,a[f+o]=r-t,a[f+m]=r+t,r=a[g+0]-a[g+m],q=a[g+0]+a[g+m],t=$.SQRT2*a[g+o],s=$.SQRT2*a[g+n],a[g+n]=q-s,a[g+0]=q+s,a[g+o]=r-t,a[g+m]=r+t,g+=d,f+=d}while(i>f);for(k=e[h+0],j=e[h+1],l=1;p>l;l++){var u,v;u=1-2*j*j,v=2*j*k,f=b+l,g=b+m-l;do{var w,x,y,q,r,z,s,A,t,B;x=v*a[f+m]-u*a[g+m],w=u*a[f+m]+v*a[g+m],r=a[f+0]-w,q=a[f+0]+w,z=a[g+0]-x,y=a[g+0]+x,x=v*a[f+o]-u*a[g+o],w=u*a[f+o]+v*a[g+o],t=a[f+n]-w,s=a[f+n]+w,B=a[g+n]-x,A=a[g+n]+x,x=j*s-k*B,w=k*s+j*B,a[f+n]=q-w,a[f+0]=q+w,a[g+o]=z-x,a[g+m]=z+x,x=k*A-j*t,w=j*A+k*t,a[g+n]=y-w,a[g+0]=y+w,a[f+o]=r-x,a[f+m]=r+x,g+=d,f+=d}while(i>f);u=k,k=u*e[h+0]-j*e[h+1],j=u*e[h+1]+j*e[h+0]}h+=2}while(c>d)}var b=d(I.BLKSIZE),c=d(I.BLKSIZE_s/2),e=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],f=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(b,d,e,g,h){for(var i=0;3>i;i++){var j=I.BLKSIZE_s/2,k=65535&192*(i+1),l=I.BLKSIZE_s/8-1;do{var m,n,o,p,q,r=255&f[l<<2];m=c[r]*g[e][h+r+k],q=c[127-r]*g[e][h+r+k+128],n=m-q,m+=q,o=c[r+64]*g[e][h+r+k+64],q=c[63-r]*g[e][h+r+k+192],p=o-q,o+=q,j-=4,d[i][j+0]=m+o,d[i][j+2]=m-o,d[i][j+1]=n+p,d[i][j+3]=n-p,m=c[r+1]*g[e][h+r+k+1],q=c[126-r]*g[e][h+r+k+129],n=m-q,m+=q,o=c[r+65]*g[e][h+r+k+65],q=c[62-r]*g[e][h+r+k+193],p=o-q,o+=q,d[i][j+I.BLKSIZE_s/2+0]=m+o,d[i][j+I.BLKSIZE_s/2+2]=m-o,d[i][j+I.BLKSIZE_s/2+1]=n+p,d[i][j+I.BLKSIZE_s/2+3]=n-p}while(--l>=0);a(d[i],j,I.BLKSIZE_s/2)}},this.fft_long=function(c,d,e,g,h){var i=I.BLKSIZE/8-1,j=I.BLKSIZE/2;do{var k,l,m,n,o,p=255&f[i];k=b[p]*g[e][h+p],o=b[p+512]*g[e][h+p+512],l=k-o,k+=o,m=b[p+256]*g[e][h+p+256],o=b[p+768]*g[e][h+p+768],n=m-o,m+=o,j-=4,d[j+0]=k+m,d[j+2]=k-m,d[j+1]=l+n,d[j+3]=l-n,k=b[p+1]*g[e][h+p+1],o=b[p+513]*g[e][h+p+513],l=k-o,k+=o,m=b[p+257]*g[e][h+p+257],o=b[p+769]*g[e][h+p+769],n=m-o,m+=o,d[j+I.BLKSIZE/2+0]=k+m,d[j+I.BLKSIZE/2+2]=k-m,d[j+I.BLKSIZE/2+1]=l+n,d[j+I.BLKSIZE/2+3]=l-n}while(--i>=0);a(d,j,I.BLKSIZE/2)},this.init_fft=function(a){for(var d=0;d<I.BLKSIZE;d++)b[d]=.42-.5*Math.cos(2*Math.PI*(d+.5)/I.BLKSIZE)+.08*Math.cos(4*Math.PI*(d+.5)/I.BLKSIZE);for(var d=0;d<I.BLKSIZE_s/2;d++)c[d]=.5*(1-Math.cos(2*Math.PI*(d+.5)/I.BLKSIZE_s))}}function P(){function a(a){return a}function b(a,b){for(var c=0,d=0;d<I.BLKSIZE/2;++d)c+=a[d]*b.ATH.eql_w[d];return c*=fa}function e(c,d,e,f,g,h,i,j,k,l,m){var n=c.internal_flags;if(2>k)X.fft_long(n,f[g],k,l,m),X.fft_short(n,h[i],k,l,m);else if(2==k){for(var o=I.BLKSIZE-1;o>=0;--o){var p=f[g+0][o],q=f[g+1][o];f[g+0][o]=(p+q)*$.SQRT2*.5,f[g+1][o]=(p-q)*$.SQRT2*.5}for(var r=2;r>=0;--r)for(var o=I.BLKSIZE_s-1;o>=0;--o){var p=h[i+0][r][o],q=h[i+1][r][o];h[i+0][r][o]=(p+q)*$.SQRT2*.5,h[i+1][r][o]=(p-q)*$.SQRT2*.5}}d[0]=a(f[g+0][0]),d[0]*=d[0];for(var o=I.BLKSIZE/2-1;o>=0;--o){var s=f[g+0][I.BLKSIZE/2-o],t=f[g+0][I.BLKSIZE/2+o];d[I.BLKSIZE/2-o]=a(.5*(s*s+t*t))}for(var r=2;r>=0;--r){e[r][0]=h[i+0][r][0],e[r][0]*=e[r][0];for(var o=I.BLKSIZE_s/2-1;o>=0;--o){var s=h[i+0][r][I.BLKSIZE_s/2-o],t=h[i+0][r][I.BLKSIZE_s/2+o];e[r][I.BLKSIZE_s/2-o]=a(.5*(s*s+t*t))}}for(var u=0,o=11;o<I.HBLKSIZE;o++)u+=d[o];if(n.tot_ener[k]=u,c.analysis){for(var o=0;o<I.HBLKSIZE;o++)n.pinfo.energy[j][k][o]=n.pinfo.energy_save[k][o],n.pinfo.energy_save[k][o]=d[o];n.pinfo.pe[j][k]=n.pe[k]}2==c.athaa_loudapprox&&2>k&&(n.loudness_sq[j][k]=n.loudness_sq_save[k],n.loudness_sq_save[k]=b(d,n))}function g(){U=Math.pow(10,(na+1)/16),V=Math.pow(10,(oa+1)/16),W=Math.pow(10,pa/10)}function h(a,b,c,d,e,f){var g;if(b>a){if(!(a*V>b))return a+b;g=b/a}else{if(a>=b*V)return a+b;g=a/b}if(a+=b,6>=d+3){if(g>=U)return a;var h=0|$.FAST_LOG10_X(g,16);return a*sa[h]}var h=0|$.FAST_LOG10_X(g,16);if(b=0!=f?e.ATH.cb_s[c]*e.ATH.adjust:e.ATH.cb_l[c]*e.ATH.adjust,W*b>a){if(a>b){var i,j;return i=1,13>=h&&(i=ta[h]),j=$.FAST_LOG10_X(a/b,10/15),a*((ra[h]-i)*j+i)}return h>13?a:a*ta[h]}return a*ra[h]}function i(a,b,c){var d;if(0>a&&(a=0),0>b&&(b=0),0>=a)return b;if(0>=b)return a;if(d=b>a?b/a:a/b,c>=-2&&2>=c){if(d>=U)return a+b;var e=0|$.FAST_LOG10_X(d,16);return(a+b)*ua[e]}return V>d?a+b:(b>a&&(a=b),a)}function m(a,b){var c=a.internal_flags;if(c.channels_out>1){for(var d=0;d<I.SBMAX_l;d++){var e=c.thm[0].l[d],f=c.thm[1].l[d];c.thm[0].l[d]+=f*b,c.thm[1].l[d]+=e*b}for(var d=0;d<I.SBMAX_s;d++)for(var g=0;3>g;g++){var e=c.thm[0].s[d][g],f=c.thm[1].s[d][g];c.thm[0].s[d][g]+=f*b,c.thm[1].s[d][g]+=e*b}}}function n(a){for(var b=0;b<I.SBMAX_l;b++)if(!(a.thm[0].l[b]>1.58*a.thm[1].l[b]||a.thm[1].l[b]>1.58*a.thm[0].l[b])){var c=a.mld_l[b]*a.en[3].l[b],d=Math.max(a.thm[2].l[b],Math.min(a.thm[3].l[b],c));c=a.mld_l[b]*a.en[2].l[b];var e=Math.max(a.thm[3].l[b],Math.min(a.thm[2].l[b],c));a.thm[2].l[b]=d,a.thm[3].l[b]=e}for(var b=0;b<I.SBMAX_s;b++)for(var f=0;3>f;f++)if(!(a.thm[0].s[b][f]>1.58*a.thm[1].s[b][f]||a.thm[1].s[b][f]>1.58*a.thm[0].s[b][f])){var c=a.mld_s[b]*a.en[3].s[b][f],d=Math.max(a.thm[2].s[b][f],Math.min(a.thm[3].s[b][f],c));c=a.mld_s[b]*a.en[2].s[b][f];var e=Math.max(a.thm[3].s[b][f],Math.min(a.thm[2].s[b][f],c));a.thm[2].s[b][f]=d,a.thm[3].s[b][f]=e}}function o(a,b,c){var d=b,e=Math.pow(10,c);b*=2,d*=2;for(var f=0;f<I.SBMAX_l;f++){var g,h,i,j;if(j=a.ATH.cb_l[a.bm_l[f]]*e,g=Math.min(Math.max(a.thm[0].l[f],j),Math.max(a.thm[1].l[f],j)),h=Math.max(a.thm[2].l[f],j),i=Math.max(a.thm[3].l[f],j),h+i>g*b){var k=g*d/(h+i);h*=k,i*=k}a.thm[2].l[f]=Math.min(h,a.thm[2].l[f]),a.thm[3].l[f]=Math.min(i,a.thm[3].l[f])}e*=I.BLKSIZE_s/I.BLKSIZE;for(var f=0;f<I.SBMAX_s;f++)for(var l=0;3>l;l++){var g,h,i,j;if(j=a.ATH.cb_s[a.bm_s[f]]*e,g=Math.min(Math.max(a.thm[0].s[f][l],j),Math.max(a.thm[1].s[f][l],j)),h=Math.max(a.thm[2].s[f][l],j),i=Math.max(a.thm[3].s[f][l],j),h+i>g*b){var k=g*b/(h+i);h*=k,i*=k}a.thm[2].s[f][l]=Math.min(a.thm[2].s[f][l],h),a.thm[3].s[f][l]=Math.min(a.thm[3].s[f][l],i)}}function p(a,b,c,d,e){var f,g,h=0,i=0;for(f=g=0;f<I.SBMAX_s;++g,++f){for(var j=a.bo_s[f],k=a.npart_s,l=k>j?j:k;l>g;)h+=b[g],i+=c[g],g++;if(a.en[d].s[f][e]=h,a.thm[d].s[f][e]=i,g>=k){++f;break}var m=a.PSY.bo_s_weight[f],n=1-m;h=m*b[g],i=m*c[g],a.en[d].s[f][e]+=h,a.thm[d].s[f][e]+=i,h=n*b[g],i=n*c[g]}for(;f<I.SBMAX_s;++f)a.en[d].s[f][e]=0,a.thm[d].s[f][e]=0}function q(a,b,c,d){var e,f,g=0,h=0;for(e=f=0;e<I.SBMAX_l;++f,++e){for(var i=a.bo_l[e],j=a.npart_l,k=j>i?i:j;k>f;)g+=b[f],h+=c[f],f++;if(a.en[d].l[e]=g,a.thm[d].l[e]=h,f>=j){++e;break}var l=a.PSY.bo_l_weight[e],m=1-l;g=l*b[f],h=l*c[f],a.en[d].l[e]+=g,a.thm[d].l[e]+=h,g=m*b[f],h=m*c[f]}for(;e<I.SBMAX_l;++e)a.en[d].l[e]=0,a.thm[d].l[e]=0}function r(a,b,c,d,e,f){var g,h,i=a.internal_flags;for(h=g=0;h<i.npart_s;++h){for(var j=0,k=0,l=i.numlines_s[h],m=0;l>m;++m,++g){var n=b[f][g];j+=n,n>k&&(k=n)}c[h]=j}for(g=h=0;h<i.npart_s;h++){var o=i.s3ind_s[h][0],p=i.s3_ss[g++]*c[o];for(++o;o<=i.s3ind_s[h][1];)p+=i.s3_ss[g]*c[o],++g,++o;var q=ca*i.nb_s1[e][h];if(d[h]=Math.min(p,q),i.blocktype_old[1&e]==I.SHORT_TYPE){var q=da*i.nb_s2[e][h],r=d[h];d[h]=Math.min(q,r)}i.nb_s2[e][h]=i.nb_s1[e][h],i.nb_s1[e][h]=p}for(;h<=I.CBANDS;++h)c[h]=0,d[h]=0}function s(a,b,c,d){var e=a.internal_flags;a.short_blocks!=j.short_block_coupled||0!=b[0]&&0!=b[1]||(b[0]=b[1]=0);for(var f=0;f<e.channels_out;f++)d[f]=I.NORM_TYPE,a.short_blocks==j.short_block_dispensed&&(b[f]=1),a.short_blocks==j.short_block_forced&&(b[f]=0),0!=b[f]?e.blocktype_old[f]==I.SHORT_TYPE&&(d[f]=I.STOP_TYPE):(d[f]=I.SHORT_TYPE,e.blocktype_old[f]==I.NORM_TYPE&&(e.blocktype_old[f]=I.START_TYPE),e.blocktype_old[f]==I.STOP_TYPE&&(e.blocktype_old[f]=I.SHORT_TYPE)),c[f]=e.blocktype_old[f],e.blocktype_old[f]=d[f]}function t(a,b,c){return c>=1?a:0>=c?b:b>0?Math.pow(a/b,c)*b:0}function u(a,b){for(var c=309.07,d=0;d<I.SBMAX_s-1;d++)for(var e=0;3>e;e++){var f=a.thm.s[d][e];if(f>0){var g=f*b,h=a.en.s[d][e];h>g&&(c+=h>1e10*g?va[d]*(10*Z):va[d]*$.FAST_LOG10(h/g))}}return c}function v(a,b){for(var c=281.0575,d=0;d<I.SBMAX_l-1;d++){var e=a.thm.l[d];if(e>0){var f=e*b,g=a.en.l[d];g>f&&(c+=g>1e10*f?wa[d]*(10*Z):wa[d]*$.FAST_LOG10(g/f))}}return c}function w(a,b,c,d,e){var f,g;for(f=g=0;f<a.npart_l;++f){var h,i=0,j=0;for(h=0;h<a.numlines_l[f];++h,++g){var k=b[g];i+=k,k>j&&(j=k)}c[f]=i,d[f]=j,e[f]=i*a.rnumlines_l[f]}}function x(a,b,c,d){var e=qa.length-1,f=0,g=c[f]+c[f+1];if(g>0){var h=b[f];h<b[f+1]&&(h=b[f+1]),g=20*(2*h-g)/(g*(a.numlines_l[f]+a.numlines_l[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;for(f=1;f<a.npart_l-1;f++)if(g=c[f-1]+c[f]+c[f+1],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),h<b[f+1]&&(h=b[f+1]),g=20*(3*h-g)/(g*(a.numlines_l[f-1]+a.numlines_l[f]+a.numlines_l[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;if(g=c[f-1]+c[f],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),g=20*(2*h-g)/(g*(a.numlines_l[f-1]+a.numlines_l[f]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0}function y(b,c,d,e,f,g,h,i){var j=b.internal_flags;if(2>e)X.fft_long(j,h[i],e,c,d);else if(2==e)for(var k=I.BLKSIZE-1;k>=0;--k){var l=h[i+0][k],m=h[i+1][k];h[i+0][k]=(l+m)*$.SQRT2*.5,h[i+1][k]=(l-m)*$.SQRT2*.5}g[0]=a(h[i+0][0]),g[0]*=g[0];for(var k=I.BLKSIZE/2-1;k>=0;--k){var n=h[i+0][I.BLKSIZE/2-k],o=h[i+0][I.BLKSIZE/2+k];g[I.BLKSIZE/2-k]=a(.5*(n*n+o*o))}for(var p=0,k=11;k<I.HBLKSIZE;k++)p+=g[k];if(j.tot_ener[e]=p,b.analysis){for(var k=0;k<I.HBLKSIZE;k++)j.pinfo.energy[f][e][k]=j.pinfo.energy_save[e][k],j.pinfo.energy_save[e][k]=g[k];j.pinfo.pe[f][e]=j.pe[e]}}function z(b,c,d,e,f,g,h,i){var j=b.internal_flags;if(0==f&&2>e&&X.fft_short(j,h[i],e,c,d),2==e)for(var k=I.BLKSIZE_s-1;k>=0;--k){var l=h[i+0][f][k],m=h[i+1][f][k];h[i+0][f][k]=(l+m)*$.SQRT2*.5,h[i+1][f][k]=(l-m)*$.SQRT2*.5}g[f][0]=h[i+0][f][0],g[f][0]*=g[f][0];for(var k=I.BLKSIZE_s/2-1;k>=0;--k){var n=h[i+0][f][I.BLKSIZE_s/2-k],o=h[i+0][f][I.BLKSIZE_s/2+k];g[f][I.BLKSIZE_s/2-k]=a(.5*(n*n+o*o))}}function A(a,c,d,e){var f=a.internal_flags;2==a.athaa_loudapprox&&2>d&&(f.loudness_sq[c][d]=f.loudness_sq_save[d],f.loudness_sq_save[d]=b(e,f))}function B(a,b,c,e,g,h,i,j,k,m){for(var n=f([2,576]),o=a.internal_flags,p=o.channels_out,q=a.mode==l.JOINT_STEREO?4:p,r=0;p>r;r++){firbuf=b[r];for(var s=c+576-350-la+192,t=0;576>t;t++){var u,v;u=firbuf[s+t+10],v=0;for(var w=0;(la-1)/2-1>w;w+=2)u+=ya[w]*(firbuf[s+t+w]+firbuf[s+t+la-w]),v+=ya[w+1]*(firbuf[s+t+w+1]+firbuf[s+t+la-w-1]);n[r][t]=u+v}g[e][r].en.assign(o.en[r]),g[e][r].thm.assign(o.thm[r]),q>2&&(h[e][r].en.assign(o.en[r+2]),h[e][r].thm.assign(o.thm[r+2]))}for(var r=0;q>r;r++){var x=d(12),y=d(12),z=[0,0,0,0],A=n[1&r],B=0,C=3==r?o.nsPsy.attackthre_s:o.nsPsy.attackthre,D=1;if(2==r)for(var t=0,w=576;w>0;++t,--w){var E=n[0][t],F=n[1][t];n[0][t]=E+F,n[1][t]=E-F}for(var t=0;3>t;t++)y[t]=o.nsPsy.last_en_subshort[r][t+6],x[t]=y[t]/o.nsPsy.last_en_subshort[r][t+4],z[0]+=y[t];for(var t=0;9>t;t++){for(var G=B+64,H=1;G>B;B++)H<Math.abs(A[B])&&(H=Math.abs(A[B]));o.nsPsy.last_en_subshort[r][t]=y[t+3]=H,z[1+t/3]+=H,H>y[t+3-2]?H/=y[t+3-2]:H=y[t+3-2]>10*H?y[t+3-2]/(10*H):0,x[t+3]=H}for(var t=0;3>t;++t){var I=y[3*t+3]+y[3*t+4]+y[3*t+5],J=1;6*y[3*t+5]<I&&(J*=.5,6*y[3*t+4]<I&&(J*=.5)),j[r][t]=J}if(a.analysis){for(var K=x[0],t=1;12>t;t++)K<x[t]&&(K=x[t]);o.pinfo.ers[e][r]=o.pinfo.ers_save[r],o.pinfo.ers_save[r]=K}for(var t=0;12>t;t++)0==k[r][t/3]&&x[t]>C&&(k[r][t/3]=t%3+1);for(var t=1;4>t;t++){var L=z[t-1],M=z[t],N=Math.max(L,M);4e4>N&&1.7*M>L&&1.7*L>M&&(1==t&&k[r][0]<=k[r][t]&&(k[r][0]=0),k[r][t]=0)}k[r][0]<=o.nsPsy.lastAttacks[r]&&(k[r][0]=0),(3==o.nsPsy.lastAttacks[r]||k[r][0]+k[r][1]+k[r][2]+k[r][3]!=0)&&(D=0,0!=k[r][1]&&0!=k[r][0]&&(k[r][1]=0),0!=k[r][2]&&0!=k[r][1]&&(k[r][2]=0),0!=k[r][3]&&0!=k[r][2]&&(k[r][3]=0)),2>r?m[r]=D:0==D&&(m[0]=m[1]=0),i[r]=o.tot_ener[r]}}function C(a,b,c){if(0==c)for(var d=0;d<a.npart_s;d++)a.nb_s2[b][d]=a.nb_s1[b][d],a.nb_s1[b][d]=0}function D(a,b){for(var c=0;c<a.npart_l;c++)a.nb_2[b][c]=a.nb_1[b][c],a.nb_1[b][c]=0}function E(a,b,c,d){var e=qa.length-1,f=0,g=c[f]+c[f+1];if(g>0){var h=b[f];h<b[f+1]&&(h=b[f+1]),g=20*(2*h-g)/(g*(a.numlines_s[f]+a.numlines_s[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;for(f=1;f<a.npart_s-1;f++)if(g=c[f-1]+c[f]+c[f+1],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),h<b[f+1]&&(h=b[f+1]),g=20*(3*h-g)/(g*(a.numlines_s[f-1]+a.numlines_s[f]+a.numlines_s[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;if(g=c[f-1]+c[f],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),g=20*(2*h-g)/(g*(a.numlines_s[f-1]+a.numlines_s[f]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0}function F(a,b,c,e,f,g){var h,j,k,l=a.internal_flags,m=new float[I.CBANDS],n=d(I.CBANDS),o=new int[I.CBANDS];for(k=j=0;k<l.npart_s;++k){var p=0,q=0,r=l.numlines_s[k];for(h=0;r>h;++h,++j){var s=b[g][j];p+=s,s>q&&(q=s)}c[k]=p,m[k]=q,n[k]=p/r}for(;k<I.CBANDS;++k)m[k]=0,n[k]=0;for(E(l,m,n,o),j=k=0;k<l.npart_s;k++){var t,u,v,w,x,y=l.s3ind_s[k][0],z=l.s3ind_s[k][1];for(t=o[y],u=1,w=l.s3_ss[j]*c[y]*qa[o[y]],++j,++y;z>=y;)t+=o[y],u+=1,v=l.s3_ss[j]*c[y]*qa[o[y]],w=i(w,v,y-k),++j,++y;t=(1+2*t)/(2*u),x=.5*qa[t],w*=x,e[k]=w,l.nb_s2[f][k]=l.nb_s1[f][k],l.nb_s1[f][k]=w,v=m[k],v*=l.minval_s[k],v*=x,e[k]>v&&(e[k]=v),l.masking_lower>1&&(e[k]*=l.masking_lower),e[k]>c[k]&&(e[k]=c[k]),l.masking_lower<1&&(e[k]*=l.masking_lower)}for(;k<I.CBANDS;++k)c[k]=0,e[k]=0}function G(a,b,e,f,g){var h,j=d(I.CBANDS),k=d(I.CBANDS),l=c(I.CBANDS+2);w(a,b,e,j,k),x(a,j,k,l);var m=0;for(h=0;h<a.npart_l;h++){var n,o,p,q,r=a.s3ind[h][0],s=a.s3ind[h][1],t=0,u=0;for(t=l[r],u+=1,o=a.s3_ll[m]*e[r]*qa[l[r]],++m,++r;s>=r;)t+=l[r],u+=1,n=a.s3_ll[m]*e[r]*qa[l[r]],q=i(o,n,r-h),o=q,++m,++r;if(t=(1+2*t)/(2*u),p=.5*qa[t],o*=p,a.blocktype_old[1&g]==I.SHORT_TYPE){var v=aa*a.nb_1[g][h];v>0?f[h]=Math.min(o,v):f[h]=Math.min(o,e[h]*ja)}else{var v,y=ba*a.nb_2[g][h],z=aa*a.nb_1[g][h];0>=y&&(y=o),0>=z&&(z=o),v=a.blocktype_old[1&g]==I.NORM_TYPE?Math.min(z,y):z,f[h]=Math.min(o,v)}a.nb_2[g][h]=a.nb_1[g][h],a.nb_1[g][h]=o,n=j[h],n*=a.minval_l[h],n*=p,f[h]>n&&(f[h]=n),a.masking_lower>1&&(f[h]*=a.masking_lower),f[h]>e[h]&&(f[h]=e[h]),a.masking_lower<1&&(f[h]*=a.masking_lower)}for(;h<I.CBANDS;++h)e[h]=0,f[h]=0}function H(a,b){var c=a.internal_flags;a.short_blocks!=j.short_block_coupled||0!=b[0]&&0!=b[1]||(b[0]=b[1]=0);for(var d=0;d<c.channels_out;d++)a.short_blocks==j.short_block_dispensed&&(b[d]=1),a.short_blocks==j.short_block_forced&&(b[d]=0)}function J(a,b,c){for(var d=a.internal_flags,e=0;e<d.channels_out;e++){var f=I.NORM_TYPE;0!=b[e]?d.blocktype_old[e]==I.SHORT_TYPE&&(f=I.STOP_TYPE):(f=I.SHORT_TYPE,d.blocktype_old[e]==I.NORM_TYPE&&(d.blocktype_old[e]=I.START_TYPE),d.blocktype_old[e]==I.STOP_TYPE&&(d.blocktype_old[e]=I.SHORT_TYPE)),c[e]=d.blocktype_old[e],d.blocktype_old[e]=f}}function K(a,b,c,d,e,f,g){for(var h,i,j=2*f,k=f>0?Math.pow(10,e):1,l=0;g>l;++l){var m=a[2][l],n=a[3][l],o=b[0][l],p=b[1][l],q=b[2][l],r=b[3][l];if(1.58*p>=o&&1.58*o>=p){var s=c[l]*n,t=c[l]*m;i=Math.max(q,Math.min(r,s)),h=Math.max(r,Math.min(q,t))}else i=q,h=r;if(f>0){var u,v,w=d[l]*k;if(u=Math.min(Math.max(o,w),Math.max(p,w)),q=Math.max(i,w),r=Math.max(h,w),v=q+r,v>0&&v>u*j){var x=u*j/v;q*=x,r*=x}i=Math.min(q,i),h=Math.min(r,h)}i>m&&(i=m),h>n&&(h=n),b[2][l]=i,b[3][l]=h}}function L(a,b){var c,d=a;return c=d>=0?27*-d:d*b,-72>=c?0:Math.exp(c*ma)}function M(a){var b,c,d=0,e=0,f=0;for(f=0;L(f,a)>1e-20;f-=1);for(b=f,c=0;Math.abs(c-b)>1e-12;)f=(c+b)/2,L(f,a)>0?c=f:b=f;d=b;var b,c,f=0;for(f=0;L(f,a)>1e-20;f+=1);for(b=0,c=f;Math.abs(c-b)>1e-12;)f=(c+b)/2,L(f,a)>0?b=f:c=f;e=c;var g,h=0,i=1e3;for(g=0;i>=g;++g){var f=d+g*(e-d)/i,j=L(f,a);h+=j}var k=(i+1)/(h*(e-d));return k}function N(a){var b,c,d,e;return b=a,b*=b>=0?3:1.5,b>=.5&&2.5>=b?(e=b-.5,c=8*(e*e-2*e)):c=0,b+=.474,d=15.811389+7.5*b-17.5*Math.sqrt(1+b*b),-60>=d?0:(b=Math.exp((c+d)*ma),b/=.6609193)}function P(a){return 0>a&&(a=0),a=.001*a,13*Math.atan(.76*a)+3.5*Math.atan(a*a/56.25)}function Q(a,b,e,f,g,h,i,j,k,l,m,n){var o,p=d(I.CBANDS+1),q=j/(n>15?1152:384),r=c(I.HBLKSIZE);j/=k;var s=0,t=0;for(o=0;o<I.CBANDS;o++){var u,v;for(u=P(j*s),p[o]=j*s,v=s;P(j*v)-u<ea&&k/2>=v;v++);for(a[o]=v-s,t=o+1;v>s;)r[s++]=o;if(s>k/2){s=k/2,++o;break}}p[o]=j*s;for(var w=0;n>w;w++){var x,y,z,A,B;z=l[w],A=l[w+1],x=0|Math.floor(.5+m*(z-.5)),0>x&&(x=0),y=0|Math.floor(.5+m*(A-.5)),y>k/2&&(y=k/2),e[w]=(r[x]+r[y])/2,b[w]=r[y];var C=q*A;i[w]=(C-p[b[w]])/(p[b[w]+1]-p[b[w]]),i[w]<0?i[w]=0:i[w]>1&&(i[w]=1),B=P(j*l[w]*m),B=Math.min(B,15.5)/15.5,h[w]=Math.pow(10,1.25*(1-Math.cos(Math.PI*B))-2.5)}s=0;for(var D=0;t>D;D++){var u,E,F=a[D];u=P(j*s),E=P(j*(s+F-1)),f[D]=.5*(u+E),u=P(j*(s-.5)),E=P(j*(s+F-.5)),g[D]=E-u,s+=F}return t}function R(a,b,c,e,g,h){var i,j=f([I.CBANDS,I.CBANDS]),k=0;if(h)for(var l=0;b>l;l++)for(i=0;b>i;i++){var m=N(c[l]-c[i])*e[i];j[l][i]=m*g[l]}else for(i=0;b>i;i++)for(var n=15+Math.min(21/c[i],12),o=M(n),l=0;b>l;l++){var m=o*L(c[l]-c[i],n)*e[i];j[l][i]=m*g[l]}for(var l=0;b>l;l++){for(i=0;b>i&&!(j[l][i]>0);i++);for(a[l][0]=i,i=b-1;i>0&&!(j[l][i]>0);i--);a[l][1]=i,k+=a[l][1]-a[l][0]+1}for(var p=d(k),q=0,l=0;b>l;l++)for(i=a[l][0];i<=a[l][1];i++)p[q++]=j[l][i];return p}function S(a){var b=P(a);return b=Math.min(b,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*b))-2.5)}function T(a,b){-.3>a&&(a=3410),a/=1e3,a=Math.max(.1,a);var c=3.64*Math.pow(a,-.8)-6.8*Math.exp(-.6*Math.pow(a-3.4,2))+6*Math.exp(-.15*Math.pow(a-8.7,2))+.001*(.6+.04*b)*Math.pow(a,4);return c}var U,V,W,X=new O,Z=2.302585092994046,aa=2,ba=16,ca=2,da=16,ea=.34,fa=1/217621504/(I.BLKSIZE/2),ga=.01,ha=.8,ia=.6,ja=.3,ka=3.5,la=21,ma=.2302585093,na=8,oa=23,pa=15,qa=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],ra=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],sa=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],ta=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],ua=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],va=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],wa=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],xa=[-1.730326e-17,-0.01703172,-1.349528e-17,.0418072,-6.73278e-17,-0.0876324,-3.0835e-17,.1863476,-1.104424e-16,-0.627638];this.L3psycho_anal_ns=function(a,b,g,i,j,y,z,A,B,C){var D,E,F,G,H,J,K,L,M,N=a.internal_flags,O=f([2,I.BLKSIZE]),P=f([2,3,I.BLKSIZE_s]),Q=d(I.CBANDS+1),R=d(I.CBANDS+1),S=d(I.CBANDS+2),T=c(2),U=c(2),V=f([2,576]),W=c(I.CBANDS+2),X=c(I.CBANDS+2);for(Y.fill(X,0),D=N.channels_out,a.mode==l.JOINT_STEREO&&(D=4),M=a.VBR==k.vbr_off?0==N.ResvMax?0:N.ResvSize/N.ResvMax*.5:a.VBR==k.vbr_rh||a.VBR==k.vbr_mtrh||a.VBR==k.vbr_mt?.6:1,E=0;E<N.channels_out;E++){var Z=b[E],$=g+576-350-la+192;for(G=0;576>G;G++){var _,ca;for(_=Z[$+G+10],ca=0,H=0;(la-1)/2-1>H;H+=2)_+=xa[H]*(Z[$+G+H]+Z[$+G+la-H]),ca+=xa[H+1]*(Z[$+G+H+1]+Z[$+G+la-H-1]);V[E][G]=_+ca}j[i][E].en.assign(N.en[E]),j[i][E].thm.assign(N.thm[E]),D>2&&(y[i][E].en.assign(N.en[E+2]),y[i][E].thm.assign(N.thm[E+2]))}for(E=0;D>E;E++){var da,ea,fa,ga=d(12),ka=[0,0,0,0],ma=d(12),na=1,oa=d(I.CBANDS),pa=d(I.CBANDS),ra=[0,0,0,0],sa=d(I.HBLKSIZE),ta=f([3,I.HBLKSIZE_s]);for(G=0;3>G;G++)ga[G]=N.nsPsy.last_en_subshort[E][G+6],ma[G]=ga[G]/N.nsPsy.last_en_subshort[E][G+4],ka[0]+=ga[G];if(2==E)for(G=0;576>G;G++){var ua,va;ua=V[0][G],va=V[1][G],V[0][G]=ua+va,V[1][G]=ua-va}var wa=V[1&E],ya=0;for(G=0;9>G;G++){for(var za=ya+64,Aa=1;za>ya;ya++)Aa<Math.abs(wa[ya])&&(Aa=Math.abs(wa[ya]));N.nsPsy.last_en_subshort[E][G]=ga[G+3]=Aa,ka[1+G/3]+=Aa,Aa>ga[G+3-2]?Aa/=ga[G+3-2]:Aa=ga[G+3-2]>10*Aa?ga[G+3-2]/(10*Aa):0,ma[G+3]=Aa}if(a.analysis){var Ba=ma[0];for(G=1;12>G;G++)Ba<ma[G]&&(Ba=ma[G]);N.pinfo.ers[i][E]=N.pinfo.ers_save[E],N.pinfo.ers_save[E]=Ba}for(fa=3==E?N.nsPsy.attackthre_s:N.nsPsy.attackthre,G=0;12>G;G++)0==ra[G/3]&&ma[G]>fa&&(ra[G/3]=G%3+1);for(G=1;4>G;G++){var Ca;Ca=ka[G-1]>ka[G]?ka[G-1]/ka[G]:ka[G]/ka[G-1],1.7>Ca&&(ra[G]=0,1==G&&(ra[0]=0))}for(0!=ra[0]&&0!=N.nsPsy.lastAttacks[E]&&(ra[0]=0),(3==N.nsPsy.lastAttacks[E]||ra[0]+ra[1]+ra[2]+ra[3]!=0)&&(na=0,0!=ra[1]&&0!=ra[0]&&(ra[1]=0),0!=ra[2]&&0!=ra[1]&&(ra[2]=0),0!=ra[3]&&0!=ra[2]&&(ra[3]=0)),2>E?U[E]=na:0==na&&(U[0]=U[1]=0),B[E]=N.tot_ener[E],ea=P,da=O,e(a,sa,ta,da,1&E,ea,1&E,i,E,b,g),w(N,sa,Q,oa,pa),x(N,oa,pa,W),L=0;3>L;L++){var Da,Ea;for(r(a,ta,R,S,E,L),p(N,R,S,E,L),K=0;K<I.SBMAX_s;K++){if(Ea=N.thm[E].s[K][L],Ea*=ha,ra[L]>=2||1==ra[L+1]){var Fa=0!=L?L-1:2,Aa=t(N.thm[E].s[K][Fa],Ea,ia*M);Ea=Math.min(Ea,Aa)}if(1==ra[L]){var Fa=0!=L?L-1:2,Aa=t(N.thm[E].s[K][Fa],Ea,ja*M);Ea=Math.min(Ea,Aa)}else if(0!=L&&3==ra[L-1]||0==L&&3==N.nsPsy.lastAttacks[E]){var Fa=2!=L?L+1:0,Aa=t(N.thm[E].s[K][Fa],Ea,ja*M);Ea=Math.min(Ea,Aa)}Da=ga[3*L+3]+ga[3*L+4]+ga[3*L+5],6*ga[3*L+5]<Da&&(Ea*=.5,6*ga[3*L+4]<Da&&(Ea*=.5)),N.thm[E].s[K][L]=Ea}}for(N.nsPsy.lastAttacks[E]=ra[2],J=0,F=0;F<N.npart_l;F++){for(var Ga=N.s3ind[F][0],Ha=Q[Ga]*qa[W[Ga]],Ia=N.s3_ll[J++]*Ha;++Ga<=N.s3ind[F][1];)Ha=Q[Ga]*qa[W[Ga]],Ia=h(Ia,N.s3_ll[J++]*Ha,Ga,Ga-F,N,0);Ia*=.158489319246111,N.blocktype_old[1&E]==I.SHORT_TYPE?S[F]=Ia:S[F]=t(Math.min(Ia,Math.min(aa*N.nb_1[E][F],ba*N.nb_2[E][F])),Ia,M),N.nb_2[E][F]=N.nb_1[E][F],N.nb_1[E][F]=Ia}for(;F<=I.CBANDS;++F)Q[F]=0,S[F]=0;q(N,Q,S,E)}if((a.mode==l.STEREO||a.mode==l.JOINT_STEREO)&&a.interChRatio>0&&m(a,a.interChRatio),a.mode==l.JOINT_STEREO){var Ja;n(N),Ja=a.msfix,Math.abs(Ja)>0&&o(N,Ja,a.ATHlower*N.ATH.adjust)}for(s(a,U,C,T),E=0;D>E;E++){var Ka,La,Ma,Na=0;E>1?(Ka=A,Na=-2,La=I.NORM_TYPE,(C[0]==I.SHORT_TYPE||C[1]==I.SHORT_TYPE)&&(La=I.SHORT_TYPE),Ma=y[i][E-2]):(Ka=z,Na=0,La=C[E],Ma=j[i][E]),La==I.SHORT_TYPE?Ka[Na+E]=u(Ma,N.masking_lower):Ka[Na+E]=v(Ma,N.masking_lower),a.analysis&&(N.pinfo.pe[i][E]=Ka[Na+E])}return 0};var ya=[-1.730326e-17,-0.01703172,-1.349528e-17,.0418072,-6.73278e-17,-0.0876324,-3.0835e-17,.1863476,-1.104424e-16,-0.627638];this.L3psycho_anal_vbr=function(a,b,e,g,h,i,j,k,m,n){var o,r,s=a.internal_flags,w=d(I.HBLKSIZE),x=f([3,I.HBLKSIZE_s]),E=f([2,I.BLKSIZE]),L=f([2,3,I.BLKSIZE_s]),M=f([4,I.CBANDS]),N=f([4,I.CBANDS]),O=f([4,3]),P=.6,Q=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],R=c(2),S=a.mode==l.JOINT_STEREO?4:s.channels_out;B(a,b,e,g,h,i,m,O,Q,R),H(a,R);for(var T=0;S>T;T++){var U=1&T;o=E,y(a,b,e,T,g,w,o,U),A(a,g,T,w),0!=R[U]?G(s,w,M[T],N[T],T):D(s,T);
}R[0]+R[1]==2&&a.mode==l.JOINT_STEREO&&K(M,N,s.mld_cb_l,s.ATH.cb_l,a.ATHlower*s.ATH.adjust,a.msfix,s.npart_l);for(var T=0;S>T;T++){var U=1&T;0!=R[U]&&q(s,M[T],N[T],T)}for(var V=0;3>V;V++){for(var T=0;S>T;++T){var U=1&T;0!=R[U]?C(s,T,V):(r=L,z(a,b,e,T,V,x,r,U),F(a,x,M[T],N[T],T,V))}R[0]+R[1]==0&&a.mode==l.JOINT_STEREO&&K(M,N,s.mld_cb_s,s.ATH.cb_s,a.ATHlower*s.ATH.adjust,a.msfix,s.npart_s);for(var T=0;S>T;++T){var U=1&T;0==R[U]&&p(s,M[T],N[T],T,V)}}for(var T=0;S>T;T++){var U=1&T;if(0==R[U])for(var W=0;W<I.SBMAX_s;W++){for(var X=d(3),V=0;3>V;V++){var Y=s.thm[T].s[W][V];if(Y*=ha,Q[T][V]>=2||1==Q[T][V+1]){var Z=0!=V?V-1:2,$=t(s.thm[T].s[W][Z],Y,ia*P);Y=Math.min(Y,$)}else if(1==Q[T][V]){var Z=0!=V?V-1:2,$=t(s.thm[T].s[W][Z],Y,ja*P);Y=Math.min(Y,$)}else if(0!=V&&3==Q[T][V-1]||0==V&&3==s.nsPsy.lastAttacks[T]){var Z=2!=V?V+1:0,$=t(s.thm[T].s[W][Z],Y,ja*P);Y=Math.min(Y,$)}Y*=O[T][V],X[V]=Y}for(var V=0;3>V;V++)s.thm[T].s[W][V]=X[V]}}for(var T=0;S>T;T++)s.nsPsy.lastAttacks[T]=Q[T][2];J(a,R,n);for(var T=0;S>T;T++){var _,aa,ba,ca;T>1?(_=k,aa=-2,ba=I.NORM_TYPE,(n[0]==I.SHORT_TYPE||n[1]==I.SHORT_TYPE)&&(ba=I.SHORT_TYPE),ca=i[g][T-2]):(_=j,aa=0,ba=n[T],ca=h[g][T]),ba==I.SHORT_TYPE?_[aa+T]=u(ca,s.masking_lower):_[aa+T]=v(ca,s.masking_lower),a.analysis&&(s.pinfo.pe[g][T]=_[aa+T])}return 0},this.psymodel_init=function(a){var b,c=a.internal_flags,e=!0,f=13,h=24,i=0,j=0,l=-8.25,m=-4.5,n=d(I.CBANDS),o=d(I.CBANDS),p=d(I.CBANDS),q=a.out_samplerate;switch(a.experimentalZ){default:case 0:e=!0;break;case 1:e=a.VBR==k.vbr_mtrh||a.VBR==k.vbr_mt?!1:!0;break;case 2:e=!1;break;case 3:f=8,i=-1.75,j=-.0125,l=-8.25,m=-2.25}for(c.ms_ener_ratio_old=.25,c.blocktype_old[0]=c.blocktype_old[1]=I.NORM_TYPE,b=0;4>b;++b){for(var r=0;r<I.CBANDS;++r)c.nb_1[b][r]=1e20,c.nb_2[b][r]=1e20,c.nb_s1[b][r]=c.nb_s2[b][r]=1;for(var s=0;s<I.SBMAX_l;s++)c.en[b].l[s]=1e20,c.thm[b].l[s]=1e20;for(var r=0;3>r;++r){for(var s=0;s<I.SBMAX_s;s++)c.en[b].s[s][r]=1e20,c.thm[b].s[s][r]=1e20;c.nsPsy.lastAttacks[b]=0}for(var r=0;9>r;r++)c.nsPsy.last_en_subshort[b][r]=10}for(c.loudness_sq_save[0]=c.loudness_sq_save[1]=0,c.npart_l=Q(c.numlines_l,c.bo_l,c.bm_l,n,o,c.mld_l,c.PSY.bo_l_weight,q,I.BLKSIZE,c.scalefac_band.l,I.BLKSIZE/1152,I.SBMAX_l),b=0;b<c.npart_l;b++){var t=i;n[b]>=f&&(t=j*(n[b]-f)/(h-f)+i*(h-n[b])/(h-f)),p[b]=Math.pow(10,t/10),c.numlines_l[b]>0?c.rnumlines_l[b]=1/c.numlines_l[b]:c.rnumlines_l[b]=0}c.s3_ll=R(c.s3ind,c.npart_l,n,o,p,e);var r=0;for(b=0;b<c.npart_l;b++){var u;u=_.MAX_VALUE;for(var v=0;v<c.numlines_l[b];v++,r++){var w,x=q*r/(1e3*I.BLKSIZE);w=this.ATHformula(1e3*x,a)-20,w=Math.pow(10,.1*w),w*=c.numlines_l[b],u>w&&(u=w)}c.ATH.cb_l[b]=u,u=-20+20*n[b]/10,u>6&&(u=100),-15>u&&(u=-15),u-=8,c.minval_l[b]=Math.pow(10,u/10)*c.numlines_l[b]}for(c.npart_s=Q(c.numlines_s,c.bo_s,c.bm_s,n,o,c.mld_s,c.PSY.bo_s_weight,q,I.BLKSIZE_s,c.scalefac_band.s,I.BLKSIZE_s/384,I.SBMAX_s),r=0,b=0;b<c.npart_s;b++){var u,t=l;n[b]>=f&&(t=m*(n[b]-f)/(h-f)+l*(h-n[b])/(h-f)),p[b]=Math.pow(10,t/10),u=_.MAX_VALUE;for(var v=0;v<c.numlines_s[b];v++,r++){var w,x=q*r/(1e3*I.BLKSIZE_s);w=this.ATHformula(1e3*x,a)-20,w=Math.pow(10,.1*w),w*=c.numlines_s[b],u>w&&(u=w)}c.ATH.cb_s[b]=u,u=-7+7*n[b]/12,n[b]>12&&(u*=1+3.1*Math.log(1+u)),n[b]<12&&(u*=1+2.3*Math.log(1-u)),-15>u&&(u=-15),u-=8,c.minval_s[b]=Math.pow(10,u/10)*c.numlines_s[b]}c.s3_ss=R(c.s3ind_s,c.npart_s,n,o,p,e),g(),X.init_fft(c),c.decay=Math.exp(-1*Z/(ga*q/192));var y;y=ka,0!=(2&a.exp_nspsytune)&&(y=1),Math.abs(a.msfix)>0&&(y=a.msfix),a.msfix=y;for(var z=0;z<c.npart_l;z++)c.s3ind[z][1]>c.npart_l-1&&(c.s3ind[z][1]=c.npart_l-1);var A=576*c.mode_gr/q;if(c.ATH.decay=Math.pow(10,-1.2*A),c.ATH.adjust=.01,c.ATH.adjustLimit=1,-1!=a.ATHtype){var x,B=a.out_samplerate/I.BLKSIZE,C=0;for(x=0,b=0;b<I.BLKSIZE/2;++b)x+=B,c.ATH.eql_w[b]=1/Math.pow(10,this.ATHformula(x,a)/10),C+=c.ATH.eql_w[b];for(C=1/C,b=I.BLKSIZE/2;--b>=0;)c.ATH.eql_w[b]*=C}for(var z=r=0;z<c.npart_s;++z)for(b=0;b<c.numlines_s[z];++b)++r;for(var z=r=0;z<c.npart_l;++z)for(b=0;b<c.numlines_l[z];++b)++r;for(r=0,b=0;b<c.npart_l;b++){var x=q*(r+c.numlines_l[b]/2)/(1*I.BLKSIZE);c.mld_cb_l[b]=S(x),r+=c.numlines_l[b]}for(;b<I.CBANDS;++b)c.mld_cb_l[b]=1;for(r=0,b=0;b<c.npart_s;b++){var x=q*(r+c.numlines_s[b]/2)/(1*I.BLKSIZE_s);c.mld_cb_s[b]=S(x),r+=c.numlines_s[b]}for(;b<I.CBANDS;++b)c.mld_cb_s[b]=1;return 0},this.ATHformula=function(a,b){var c;switch(b.ATHtype){case 0:c=T(a,9);break;case 1:c=T(a,-1);break;case 2:c=T(a,0);break;case 3:c=T(a,1)+6;break;case 4:c=T(a,b.ATHcurve);break;default:c=T(a,0)}return c}}function Q(){function a(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=d(I.SBMAX_l),this.bo_s_weight=d(I.SBMAX_s)}function b(){this.lowerlimit=0}function c(a,b){this.lowpass=b}function e(a){var b;return a.class_id=_,b=a.internal_flags=new N,a.mode=l.NOT_SET,a.original=1,a.in_samplerate=44100,a.num_channels=2,a.num_samples=-1,a.bWriteVbrTag=!0,a.quality=-1,a.short_blocks=null,b.subblock_gain=-1,a.lowpassfreq=0,a.highpassfreq=0,a.lowpasswidth=-1,a.highpasswidth=-1,a.VBR=k.vbr_off,a.VBR_q=4,a.ATHcurve=-1,a.VBR_mean_bitrate_kbps=128,a.VBR_min_bitrate_kbps=0,a.VBR_max_bitrate_kbps=0,a.VBR_hard_min=0,b.VBR_min_bitrate=1,b.VBR_max_bitrate=13,a.quant_comp=-1,a.quant_comp_short=-1,a.msfix=-1,b.resample_ratio=1,b.OldValue[0]=180,b.OldValue[1]=180,b.CurrentStep[0]=4,b.CurrentStep[1]=4,b.masking_lower=1,b.nsPsy.attackthre=-1,b.nsPsy.attackthre_s=-1,a.scale=-1,a.athaa_type=-1,a.ATHtype=-1,a.athaa_loudapprox=-1,a.athaa_sensitivity=0,a.useTemporal=null,a.interChRatio=-1,b.mf_samples_to_encode=I.ENCDELAY+I.POSTDELAY,a.encoder_padding=0,b.mf_size=I.ENCDELAY-I.MDCTDELAY,a.findReplayGain=!1,a.decode_on_the_fly=!1,b.decode_on_the_fly=!1,b.findReplayGain=!1,b.findPeakSample=!1,b.RadioGain=0,b.AudiophileGain=0,b.noclipGainChange=0,b.noclipScale=-1,a.preset=0,a.write_id3tag_automatic=!0,0}function f(a){return a>1?0:0>=a?1:Math.cos(Math.PI/2*a)}function i(a,b){var c=44100;return b>=48e3?c=48e3:b>=44100?c=44100:b>=32e3?c=32e3:b>=24e3?c=24e3:b>=22050?c=22050:b>=16e3?c=16e3:b>=12e3?c=12e3:b>=11025?c=11025:b>=8e3&&(c=8e3),-1==a?c:(15960>=a&&(c=44100),15250>=a&&(c=32e3),11220>=a&&(c=24e3),9970>=a&&(c=22050),7230>=a&&(c=16e3),5420>=a&&(c=12e3),4510>=a&&(c=11025),3970>=a&&(c=8e3),c>b?b>44100?48e3:b>32e3?44100:b>24e3?32e3:b>22050?24e3:b>16e3?22050:b>12e3?16e3:b>11025?12e3:b>8e3?11025:8e3:c)}function m(a,b){switch(a){case 44100:return b.version=1,0;case 48e3:return b.version=1,1;case 32e3:return b.version=1,2;case 22050:return b.version=0,0;case 24e3:return b.version=0,1;case 16e3:return b.version=0,2;case 11025:return b.version=0,0;case 12e3:return b.version=0,1;case 8e3:return b.version=0,2;default:return b.version=0,-1}}function n(a,b,c){16e3>c&&(b=2);for(var d=aa.bitrate_table[b][1],e=2;14>=e;e++)aa.bitrate_table[b][e]>0&&Math.abs(aa.bitrate_table[b][e]-a)<Math.abs(d-a)&&(d=aa.bitrate_table[b][e]);return d}function p(a,b,c){16e3>c&&(b=2);for(var d=0;14>=d;d++)if(aa.bitrate_table[b][d]>0&&aa.bitrate_table[b][d]==a)return d;return-1}function q(a,b){var d=[new c(8,2e3),new c(16,3700),new c(24,3900),new c(32,5500),new c(40,7e3),new c(48,7500),new c(56,1e4),new c(64,11e3),new c(80,13500),new c(96,15100),new c(112,15600),new c(128,17e3),new c(160,17500),new c(192,18600),new c(224,19400),new c(256,19700),new c(320,20500)],e=K.nearestBitrateFullIndex(b);a.lowerlimit=d[e].lowpass}function s(a){var b=a.internal_flags,c=32,d=-1;if(b.lowpass1>0){for(var e=999,g=0;31>=g;g++){var h=g/31;h>=b.lowpass2&&(c=Math.min(c,g)),b.lowpass1<h&&h<b.lowpass2&&(e=Math.min(e,g))}999==e?b.lowpass1=(c-.75)/31:b.lowpass1=(e-.75)/31,b.lowpass2=c/31}if(b.highpass2>0&&b.highpass2<.9*(.75/31)&&(b.highpass1=0,b.highpass2=0,Z.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),b.highpass2>0){for(var i=-1,g=0;31>=g;g++){var h=g/31;h<=b.highpass1&&(d=Math.max(d,g)),b.highpass1<h&&h<b.highpass2&&(i=Math.max(i,g))}b.highpass1=d/31,-1==i?b.highpass2=(d+.75)/31:b.highpass2=(i+.75)/31}for(var g=0;32>g;g++){var j,k,h=g/31;j=b.highpass2>b.highpass1?f((b.highpass2-h)/(b.highpass2-b.highpass1+1e-20)):1,k=b.lowpass2>b.lowpass1?f((h-b.lowpass1)/(b.lowpass2-b.lowpass1+1e-20)):1,b.amp_filter[g]=j*k}}function t(a){var b=a.internal_flags;switch(a.quality){default:case 9:b.psymodel=0,b.noise_shaping=0,b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.use_best_huffman=0,b.full_outer_loop=0;break;case 8:a.quality=7;case 7:b.psymodel=1,b.noise_shaping=0,b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.use_best_huffman=0,b.full_outer_loop=0;break;case 6:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=0,b.full_outer_loop=0;break;case 5:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=0,b.full_outer_loop=0;break;case 4:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 3:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=1,b.noise_shaping_stop=1,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 2:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=1,b.noise_shaping_stop=1,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 1:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=2,b.noise_shaping_stop=1,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 0:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=2,b.noise_shaping_stop=1,-1==b.subblock_gain&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0}}function u(a){var b=a.internal_flags;a.frameNum=0,a.write_id3tag_automatic&&X.id3tag_write_v2(a),b.bitrate_stereoMode_Hist=g([16,5]),b.bitrate_blockType_Hist=g([16,6]),b.PeakSample=0,a.bWriteVbrTag&&V.InitVbrTag(a)}function v(a,b){(null==a.in_buffer_0||a.in_buffer_nsamples<b)&&(a.in_buffer_0=d(b),a.in_buffer_1=d(b),a.in_buffer_nsamples=b)}function w(a){var b=I.BLKSIZE+a.framesize-I.FFTOFFSET;return b=Math.max(b,512+a.framesize-32)}function B(a,b,c,d,e,f,g){var h,i,j,k,l,m=a.internal_flags,n=0,p=[null,null],q=[null,null];if(m.Class_ID!=_)return-3;if(0==d)return 0;if(l=R.copy_buffer(m,e,f,g,0),0>l)return l;if(f+=l,n+=l,q[0]=b,q[1]=c,r.NEQ(a.scale,0)&&r.NEQ(a.scale,1))for(i=0;d>i;++i)q[0][i]*=a.scale,2==m.channels_out&&(q[1][i]*=a.scale);if(r.NEQ(a.scale_left,0)&&r.NEQ(a.scale_left,1))for(i=0;d>i;++i)q[0][i]*=a.scale_left;if(r.NEQ(a.scale_right,0)&&r.NEQ(a.scale_right,1))for(i=0;d>i;++i)q[1][i]*=a.scale_right;if(2==a.num_channels&&1==m.channels_out)for(i=0;d>i;++i)q[0][i]=.5*(q[0][i]+q[1][i]),q[1][i]=0;k=w(a),p[0]=m.mfbuf[0],p[1]=m.mfbuf[1];for(var s=0;d>0;){var t=[null,null],u=0,v=0;t[0]=q[0],t[1]=q[1];var x=new D;if(J(a,p,t,s,d,x),u=x.n_in,v=x.n_out,m.findReplayGain&&!m.decode_on_the_fly&&O.AnalyzeSamples(m.rgdata,p[0],m.mf_size,p[1],m.mf_size,v,m.channels_out)==o.GAIN_ANALYSIS_ERROR)return-6;if(d-=u,s+=u,2==m.channels_out,m.mf_size+=v,m.mf_samples_to_encode<1&&(m.mf_samples_to_encode=I.ENCDELAY+I.POSTDELAY),m.mf_samples_to_encode+=v,m.mf_size>=k){var y=g-n;if(0==g&&(y=0),h=C(a,p[0],p[1],e,f,y),0>h)return h;for(f+=h,n+=h,m.mf_size-=a.framesize,m.mf_samples_to_encode-=a.framesize,j=0;j<m.channels_out;j++)for(i=0;i<m.mf_size;i++)p[j][i]=p[j][i+a.framesize]}}return n}function C(a,b,c,d,e,f){var g=K.enc.lame_encode_mp3_frame(a,b,c,d,e,f);return a.frameNum++,g}function D(){this.n_in=0,this.n_out=0}function E(){this.num_used=0}function F(a,b){return 0!=b?F(b,a%b):a}function G(a,b,c){var d=Math.PI*b;a/=c,0>a&&(a=0),a>1&&(a=1);var e=a-.5,f=.42-.5*Math.cos(2*a*Math.PI)+.08*Math.cos(4*a*Math.PI);return Math.abs(e)<1e-9?d/Math.PI:f*Math.sin(c*d*e)/(Math.PI*c*e)}function H(a,b,c,e,f,g,h,i,j){var k,l,m=a.internal_flags,n=0,o=a.out_samplerate/F(a.out_samplerate,a.in_samplerate);o>N.BPC&&(o=N.BPC);var p=Math.abs(m.resample_ratio-Math.floor(.5+m.resample_ratio))<1e-4?1:0,q=1/m.resample_ratio;q>1&&(q=1);var r=31;0==r%2&&--r,r+=p;var s=r+1;if(0==m.fill_buffer_resample_init){for(m.inbuf_old[0]=d(s),m.inbuf_old[1]=d(s),k=0;2*o>=k;++k)m.blackfilt[k]=d(s);for(m.itime[0]=0,m.itime[1]=0,n=0;2*o>=n;n++){var t=0,u=(n-o)/(2*o);for(k=0;r>=k;k++)t+=m.blackfilt[n][k]=G(k-u,q,r);for(k=0;r>=k;k++)m.blackfilt[n][k]/=t}m.fill_buffer_resample_init=1}var v=m.inbuf_old[j];for(l=0;e>l;l++){var w,x;if(w=l*m.resample_ratio,n=0|Math.floor(w-m.itime[j]),r+n-r/2>=h)break;var u=w-m.itime[j]-(n+.5*(r%2));x=0|Math.floor(2*u*o+o+.5);var y=0;for(k=0;r>=k;++k){var z,A=k+n-r/2;z=0>A?v[s+A]:f[g+A],y+=z*m.blackfilt[x][k]}b[c+l]=y}if(i.num_used=Math.min(h,r+n-r/2),m.itime[j]+=i.num_used-l*m.resample_ratio,i.num_used>=s)for(k=0;s>k;k++)v[k]=f[g+i.num_used+k-s];else{var B=s-i.num_used;for(k=0;B>k;++k)v[k]=v[k+i.num_used];for(n=0;s>k;++k,++n)v[k]=f[g+n]}return l}function J(a,b,c,d,e,f){var g=a.internal_flags;if(g.resample_ratio<.9999||g.resample_ratio>1.0001)for(var h=0;h<g.channels_out;h++){var i=new E;f.n_out=H(a,b[h],g.mf_size,a.framesize,c[h],d,e,i,h),f.n_in=i.num_used}else{f.n_out=Math.min(a.framesize,e),f.n_in=f.n_out;for(var j=0;j<f.n_out;++j)b[0][g.mf_size+j]=c[0][d+j],2==g.channels_out&&(b[1][g.mf_size+j]=c[1][d+j])}}var K=this,L=131072;Q.V9=410,Q.V8=420,Q.V7=430,Q.V6=440,Q.V5=450,Q.V4=460,Q.V3=470,Q.V2=480,Q.V1=490,Q.V0=500,Q.R3MIX=1e3,Q.STANDARD=1001,Q.EXTREME=1002,Q.INSANE=1003,Q.STANDARD_FAST=1004,Q.EXTREME_FAST=1005,Q.MEDIUM=1006,Q.MEDIUM_FAST=1007;var M=16384+L;Q.LAME_MAXMP3BUFFER=M;var O,R,S,T,U,V,W,X,Y,$=new P;this.enc=new I,this.setModules=function(a,b,c,d,e,f,g,h,i){O=a,R=b,S=c,T=d,U=e,V=f,W=g,X=h,Y=i,this.enc.setModules(R,$,T,V)};var _=4294479419;this.lame_init=function(){var a=new x,b=e(a);return 0!=b?null:(a.lame_allocated_gfp=1,a)},this.nearestBitrateFullIndex=function(a){var b=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],c=0,d=0,e=0,f=0;f=b[16],e=16,d=b[16],c=16;for(var g=0;16>g;g++)if(Math.max(a,b[g+1])!=a){f=b[g+1],e=g+1,d=b[g],c=g;break}return f-a>a-d?c:e},this.lame_init_params=function(c){var d=c.internal_flags;if(d.Class_ID=0,null==d.ATH&&(d.ATH=new z),null==d.PSY&&(d.PSY=new a),null==d.rgdata&&(d.rgdata=new y),d.channels_in=c.num_channels,1==d.channels_in&&(c.mode=l.MONO),d.channels_out=c.mode==l.MONO?1:2,d.mode_ext=I.MPG_MD_MS_LR,c.mode==l.MONO&&(c.force_ms=!1),c.VBR==k.vbr_off&&128!=c.VBR_mean_bitrate_kbps&&0==c.brate&&(c.brate=c.VBR_mean_bitrate_kbps),c.VBR==k.vbr_off||c.VBR==k.vbr_mtrh||c.VBR==k.vbr_mt||(c.free_format=!1),c.VBR==k.vbr_off&&0==c.brate&&r.EQ(c.compression_ratio,0)&&(c.compression_ratio=11.025),c.VBR==k.vbr_off&&c.compression_ratio>0&&(0==c.out_samplerate&&(c.out_samplerate=map2MP3Frequency(int(.97*c.in_samplerate))),c.brate=0|16*c.out_samplerate*d.channels_out/(1e3*c.compression_ratio),d.samplerate_index=m(c.out_samplerate,c),c.free_format||(c.brate=n(c.brate,c.version,c.out_samplerate))),0!=c.out_samplerate&&(c.out_samplerate<16e3?(c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,8),c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,64)):c.out_samplerate<32e3?(c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,8),c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,160)):(c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,32),c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,320))),0==c.lowpassfreq){var e=16e3;switch(c.VBR){case k.vbr_off:var f=new b;q(f,c.brate),e=f.lowerlimit;break;case k.vbr_abr:var f=new b;q(f,c.VBR_mean_bitrate_kbps),e=f.lowerlimit;break;case k.vbr_rh:var g=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=c.VBR_q&&c.VBR_q<=9){var h=g[c.VBR_q],v=g[c.VBR_q+1],w=c.VBR_q_frac;e=linear_int(h,v,w)}else e=19500;break;default:var g=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=c.VBR_q&&c.VBR_q<=9){var h=g[c.VBR_q],v=g[c.VBR_q+1],w=c.VBR_q_frac;e=linear_int(h,v,w)}else e=19500}c.mode!=l.MONO||c.VBR!=k.vbr_off&&c.VBR!=k.vbr_abr||(e*=1.5),c.lowpassfreq=0|e}if(0==c.out_samplerate&&(2*c.lowpassfreq>c.in_samplerate&&(c.lowpassfreq=c.in_samplerate/2),c.out_samplerate=i(0|c.lowpassfreq,c.in_samplerate)),c.lowpassfreq=Math.min(20500,c.lowpassfreq),c.lowpassfreq=Math.min(c.out_samplerate/2,c.lowpassfreq),c.VBR==k.vbr_off&&(c.compression_ratio=16*c.out_samplerate*d.channels_out/(1e3*c.brate)),c.VBR==k.vbr_abr&&(c.compression_ratio=16*c.out_samplerate*d.channels_out/(1e3*c.VBR_mean_bitrate_kbps)),c.bWriteVbrTag||(c.findReplayGain=!1,c.decode_on_the_fly=!1,d.findPeakSample=!1),d.findReplayGain=c.findReplayGain,d.decode_on_the_fly=c.decode_on_the_fly,d.decode_on_the_fly&&(d.findPeakSample=!0),d.findReplayGain&&O.InitGainAnalysis(d.rgdata,c.out_samplerate)==o.INIT_GAIN_ANALYSIS_ERROR)return c.internal_flags=null,-6;switch(d.decode_on_the_fly&&!c.decode_only&&(null!=d.hip&&Y.hip_decode_exit(d.hip),d.hip=Y.hip_decode_init()),d.mode_gr=c.out_samplerate<=24e3?1:2,c.framesize=576*d.mode_gr,c.encoder_delay=I.ENCDELAY,d.resample_ratio=c.in_samplerate/c.out_samplerate,c.VBR){case k.vbr_mt:case k.vbr_rh:case k.vbr_mtrh:var x=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];c.compression_ratio=x[c.VBR_q];break;case k.vbr_abr:c.compression_ratio=16*c.out_samplerate*d.channels_out/(1e3*c.VBR_mean_bitrate_kbps);break;default:c.compression_ratio=16*c.out_samplerate*d.channels_out/(1e3*c.brate)}if(c.mode==l.NOT_SET&&(c.mode=l.JOINT_STEREO),c.highpassfreq>0?(d.highpass1=2*c.highpassfreq,c.highpasswidth>=0?d.highpass2=2*(c.highpassfreq+c.highpasswidth):d.highpass2=2*c.highpassfreq,d.highpass1/=c.out_samplerate,d.highpass2/=c.out_samplerate):(d.highpass1=0,d.highpass2=0),c.lowpassfreq>0?(d.lowpass2=2*c.lowpassfreq,c.lowpasswidth>=0?(d.lowpass1=2*(c.lowpassfreq-c.lowpasswidth),d.lowpass1<0&&(d.lowpass1=0)):d.lowpass1=2*c.lowpassfreq,d.lowpass1/=c.out_samplerate,d.lowpass2/=c.out_samplerate):(d.lowpass1=0,d.lowpass2=0),s(c),d.samplerate_index=m(c.out_samplerate,c),d.samplerate_index<0)return c.internal_flags=null,-1;if(c.VBR==k.vbr_off){if(c.free_format)d.bitrate_index=0;else if(c.brate=n(c.brate,c.version,c.out_samplerate),d.bitrate_index=p(c.brate,c.version,c.out_samplerate),d.bitrate_index<=0)return c.internal_flags=null,-1}else d.bitrate_index=1;c.analysis&&(c.bWriteVbrTag=!1),null!=d.pinfo&&(c.bWriteVbrTag=!1),R.init_bit_stream_w(d);for(var B=d.samplerate_index+3*c.version+6*(c.out_samplerate<16e3?1:0),C=0;C<I.SBMAX_l+1;C++)d.scalefac_band.l[C]=T.sfBandIndex[B].l[C];for(var C=0;C<I.PSFB21+1;C++){var D=(d.scalefac_band.l[22]-d.scalefac_band.l[21])/I.PSFB21,E=d.scalefac_band.l[21]+C*D;d.scalefac_band.psfb21[C]=E}d.scalefac_band.psfb21[I.PSFB21]=576;for(var C=0;C<I.SBMAX_s+1;C++)d.scalefac_band.s[C]=T.sfBandIndex[B].s[C];for(var C=0;C<I.PSFB12+1;C++){var D=(d.scalefac_band.s[13]-d.scalefac_band.s[12])/I.PSFB12,E=d.scalefac_band.s[12]+C*D;d.scalefac_band.psfb12[C]=E}d.scalefac_band.psfb12[I.PSFB12]=192,1==c.version?d.sideinfo_len=1==d.channels_out?21:36:d.sideinfo_len=1==d.channels_out?13:21,c.error_protection&&(d.sideinfo_len+=2),u(c),d.Class_ID=_;var F;for(F=0;19>F;F++)d.nsPsy.pefirbuf[F]=700*d.mode_gr*d.channels_out;switch(-1==c.ATHtype&&(c.ATHtype=4),c.VBR){case k.vbr_mt:c.VBR=k.vbr_mtrh;case k.vbr_mtrh:null==c.useTemporal&&(c.useTemporal=!1),S.apply_preset(c,500-10*c.VBR_q,0),c.quality<0&&(c.quality=LAME_DEFAULT_QUALITY),c.quality<5&&(c.quality=0),c.quality>5&&(c.quality=5),d.PSY.mask_adjust=c.maskingadjust,d.PSY.mask_adjust_short=c.maskingadjust_short,c.experimentalY?d.sfb21_extra=!1:d.sfb21_extra=c.out_samplerate>44e3,d.iteration_loop=new VBRNewIterationLoop(U);break;case k.vbr_rh:S.apply_preset(c,500-10*c.VBR_q,0),d.PSY.mask_adjust=c.maskingadjust,d.PSY.mask_adjust_short=c.maskingadjust_short,c.experimentalY?d.sfb21_extra=!1:d.sfb21_extra=c.out_samplerate>44e3,c.quality>6&&(c.quality=6),c.quality<0&&(c.quality=LAME_DEFAULT_QUALITY),d.iteration_loop=new VBROldIterationLoop(U);break;default:var G;d.sfb21_extra=!1,c.quality<0&&(c.quality=LAME_DEFAULT_QUALITY),G=c.VBR,G==k.vbr_off&&(c.VBR_mean_bitrate_kbps=c.brate),S.apply_preset(c,c.VBR_mean_bitrate_kbps,0),c.VBR=G,d.PSY.mask_adjust=c.maskingadjust,d.PSY.mask_adjust_short=c.maskingadjust_short,G==k.vbr_off?d.iteration_loop=new A(U):d.iteration_loop=new ABRIterationLoop(U)}if(c.VBR!=k.vbr_off){if(d.VBR_min_bitrate=1,d.VBR_max_bitrate=14,c.out_samplerate<16e3&&(d.VBR_max_bitrate=8),0!=c.VBR_min_bitrate_kbps&&(c.VBR_min_bitrate_kbps=n(c.VBR_min_bitrate_kbps,c.version,c.out_samplerate),d.VBR_min_bitrate=p(c.VBR_min_bitrate_kbps,c.version,c.out_samplerate),d.VBR_min_bitrate<0))return-1;if(0!=c.VBR_max_bitrate_kbps&&(c.VBR_max_bitrate_kbps=n(c.VBR_max_bitrate_kbps,c.version,c.out_samplerate),d.VBR_max_bitrate=p(c.VBR_max_bitrate_kbps,c.version,c.out_samplerate),d.VBR_max_bitrate<0))return-1;c.VBR_min_bitrate_kbps=aa.bitrate_table[c.version][d.VBR_min_bitrate],c.VBR_max_bitrate_kbps=aa.bitrate_table[c.version][d.VBR_max_bitrate],c.VBR_mean_bitrate_kbps=Math.min(aa.bitrate_table[c.version][d.VBR_max_bitrate],c.VBR_mean_bitrate_kbps),c.VBR_mean_bitrate_kbps=Math.max(aa.bitrate_table[c.version][d.VBR_min_bitrate],c.VBR_mean_bitrate_kbps)}return c.tune&&(d.PSY.mask_adjust+=c.tune_value_a,d.PSY.mask_adjust_short+=c.tune_value_a),t(c),c.athaa_type<0?d.ATH.useAdjust=3:d.ATH.useAdjust=c.athaa_type,d.ATH.aaSensitivityP=Math.pow(10,c.athaa_sensitivity/-10),null==c.short_blocks&&(c.short_blocks=j.short_block_allowed),c.short_blocks!=j.short_block_allowed||c.mode!=l.JOINT_STEREO&&c.mode!=l.STEREO||(c.short_blocks=j.short_block_coupled),c.quant_comp<0&&(c.quant_comp=1),c.quant_comp_short<0&&(c.quant_comp_short=0),c.msfix<0&&(c.msfix=0),c.exp_nspsytune=1|c.exp_nspsytune,c.internal_flags.nsPsy.attackthre<0&&(c.internal_flags.nsPsy.attackthre=P.NSATTACKTHRE),c.internal_flags.nsPsy.attackthre_s<0&&(c.internal_flags.nsPsy.attackthre_s=P.NSATTACKTHRE_S),c.scale<0&&(c.scale=1),c.ATHtype<0&&(c.ATHtype=4),c.ATHcurve<0&&(c.ATHcurve=4),c.athaa_loudapprox<0&&(c.athaa_loudapprox=2),c.interChRatio<0&&(c.interChRatio=0),null==c.useTemporal&&(c.useTemporal=!0),d.slot_lag=d.frac_SpF=0,c.VBR==k.vbr_off&&(d.slot_lag=d.frac_SpF=72e3*(c.version+1)*c.brate%c.out_samplerate|0),T.iteration_init(c),$.psymodel_init(c),0},this.lame_encode_flush=function(a,b,c,d){var e,f,g,i,j=a.internal_flags,k=h([2,1152]),l=0,m=j.mf_samples_to_encode-I.POSTDELAY,n=w(a);if(j.mf_samples_to_encode<1)return 0;for(e=0,a.in_samplerate!=a.out_samplerate&&(m+=16*a.out_samplerate/a.in_samplerate),g=a.framesize-m%a.framesize,576>g&&(g+=a.framesize),a.encoder_padding=g,i=(m+g)/a.framesize;i>0&&l>=0;){var o=n-j.mf_size,p=a.frameNum;o*=a.in_samplerate,o/=a.out_samplerate,o>1152&&(o=1152),1>o&&(o=1),f=d-e,0==d&&(f=0),l=this.lame_encode_buffer(a,k[0],k[1],o,b,c,f),c+=l,e+=l,i-=p!=a.frameNum?1:0}if(j.mf_samples_to_encode=0,0>l)return l;if(f=d-e,0==d&&(f=0),R.flush_bitstream(a),l=R.copy_buffer(j,b,c,f,1),0>l)return l;if(c+=l,e+=l,f=d-e,0==d&&(f=0),a.write_id3tag_automatic){if(X.id3tag_write_v1(a),l=R.copy_buffer(j,b,c,f,0),0>l)return l;e+=l}return e},this.lame_encode_buffer=function(a,b,c,d,e,f,g){var h=a.internal_flags,i=[null,null];if(h.Class_ID!=_)return-3;if(0==d)return 0;v(h,d),i[0]=h.in_buffer_0,i[1]=h.in_buffer_1;for(var j=0;d>j;j++)i[0][j]=b[j],h.channels_in>1&&(i[1][j]=c[j]);return B(a,i[0],i[1],d,e,f,g)}}function R(){var a,b;this.setModules=function(c,d){a=c,b=d}}function S(){var a,b,c;this.setModules=function(d,e,f){a=d,b=e,c=f}}function T(){}function U(){var a,b;this.setModules=function(c,d){a=c,b=d}}function V(b,c,d){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),b=1,c=44100,d=128);var e=new Q,f=new R,g=new o,h=new r,i=new n,j=new C,k=new F,t=new s,u=new m,v=new U,w=new q,x=new p,y=new S,z=new T;e.setModules(g,h,i,j,k,t,u,v,z),h.setModules(g,z,u,t),v.setModules(h,u),i.setModules(e),k.setModules(h,w,j,x),j.setModules(x,w,e.enc.psy),w.setModules(h),x.setModules(j),t.setModules(e,h,u),f.setModules(y,z),y.setModules(u,v,i);var A=e.lame_init();A.num_channels=b,A.in_samplerate=c,A.brate=d,A.mode=l.STEREO,A.quality=3,A.bWriteVbrTag=!1,A.disable_reservoir=!0,A.write_id3tag_automatic=!1;var B=(e.lame_init_params(A),1152),D=0|1.25*B+7200,E=a(D);this.encodeBuffer=function(c,d){1==b&&(d=c),c.length>B&&(B=c.length,D=0|1.25*B+7200,E=a(D));var f=e.lame_encode_buffer(A,c,d,c.length,E,0,D);return new Int8Array(E.subarray(0,f))},this.flush=function(){var a=e.lame_encode_flush(A,E,0,D);return new Int8Array(E.subarray(0,a))}}function W(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function X(a){return a.charCodeAt(0)<<24|a.charCodeAt(1)<<16|a.charCodeAt(2)<<8|a.charCodeAt(3)}var Y={};Y.fill=function(a,b,c,d){if(2==arguments.length)for(var e=0;e<a.length;e++)a[e]=arguments[1];else for(var e=b;c>e;e++)a[e]=d};var Z={};Z.arraycopy=function(a,b,c,d,e){for(var f=b+e;f>b;)c[d++]=a[b++]};var $={};$.SQRT2=1.4142135623730951,$.FAST_LOG10=function(a){return Math.log10(a)},$.FAST_LOG10_X=function(a,b){return Math.log10(a)*b},j.short_block_allowed=new j(0),j.short_block_coupled=new j(1),j.short_block_dispensed=new j(2),j.short_block_forced=new j(3);var _={};_.MAX_VALUE=3.4028235e38,k.vbr_off=new k(0),k.vbr_mt=new k(1),k.vbr_rh=new k(2),k.vbr_abr=new k(3),k.vbr_mtrh=new k(4),k.vbr_default=k.vbr_mtrh;l.STEREO=new l(0),l.JOINT_STEREO=new l(1),l.DUAL_CHANNEL=new l(2),l.MONO=new l(3),l.NOT_SET=new l(4),o.STEPS_per_dB=100,o.MAX_dB=120,o.GAIN_NOT_ENOUGH_SAMPLES=-24601,o.GAIN_ANALYSIS_ERROR=0,o.GAIN_ANALYSIS_OK=1,o.INIT_GAIN_ANALYSIS_ERROR=0,o.INIT_GAIN_ANALYSIS_OK=1,o.YULE_ORDER=10,o.MAX_ORDER=o.YULE_ORDER,o.MAX_SAMP_FREQ=48e3,o.RMS_WINDOW_TIME_NUMERATOR=1,o.RMS_WINDOW_TIME_DENOMINATOR=20,o.MAX_SAMPLES_PER_WINDOW=o.MAX_SAMP_FREQ*o.RMS_WINDOW_TIME_NUMERATOR/o.RMS_WINDOW_TIME_DENOMINATOR+1,r.EQ=function(a,b){return Math.abs(a)>Math.abs(b)?Math.abs(a-b)<=1e-6*Math.abs(a):Math.abs(a-b)<=1e-6*Math.abs(b)},r.NEQ=function(a,b){return!r.EQ(a,b)},s.NUMTOCENTRIES=100,s.MAXFRAMESIZE=2880;var aa={};aa.t1HB=[1,1,1,0],aa.t2HB=[1,2,1,3,1,1,3,2,0],aa.t3HB=[3,2,1,1,1,1,3,2,0],aa.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],aa.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],aa.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],aa.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],aa.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],aa.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],aa.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],aa.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],aa.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],aa.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],aa.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],aa.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],aa.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],aa.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],aa.t1l=[1,4,3,5],aa.t2l=[1,4,7,4,5,7,6,7,8],aa.t3l=[2,3,7,4,4,7,6,7,8],aa.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],aa.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],aa.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],aa.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],aa.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],aa.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],aa.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],aa.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],aa.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],
aa.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],aa.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],aa.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],aa.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],aa.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],aa.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],aa.ht=[new t(0,0,null,null),new t(2,0,aa.t1HB,aa.t1l),new t(3,0,aa.t2HB,aa.t2l),new t(3,0,aa.t3HB,aa.t3l),new t(0,0,null,null),new t(4,0,aa.t5HB,aa.t5l),new t(4,0,aa.t6HB,aa.t6l),new t(6,0,aa.t7HB,aa.t7l),new t(6,0,aa.t8HB,aa.t8l),new t(6,0,aa.t9HB,aa.t9l),new t(8,0,aa.t10HB,aa.t10l),new t(8,0,aa.t11HB,aa.t11l),new t(8,0,aa.t12HB,aa.t12l),new t(16,0,aa.t13HB,aa.t13l),new t(0,0,null,aa.t16_5l),new t(16,0,aa.t15HB,aa.t15l),new t(1,1,aa.t16HB,aa.t16l),new t(2,3,aa.t16HB,aa.t16l),new t(3,7,aa.t16HB,aa.t16l),new t(4,15,aa.t16HB,aa.t16l),new t(6,63,aa.t16HB,aa.t16l),new t(8,255,aa.t16HB,aa.t16l),new t(10,1023,aa.t16HB,aa.t16l),new t(13,8191,aa.t16HB,aa.t16l),new t(4,15,aa.t24HB,aa.t24l),new t(5,31,aa.t24HB,aa.t24l),new t(6,63,aa.t24HB,aa.t24l),new t(7,127,aa.t24HB,aa.t24l),new t(8,255,aa.t24HB,aa.t24l),new t(9,511,aa.t24HB,aa.t24l),new t(11,2047,aa.t24HB,aa.t24l),new t(13,8191,aa.t24HB,aa.t24l),new t(0,0,aa.t32HB,aa.t32l),new t(0,0,aa.t33HB,aa.t33l)],aa.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],aa.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],aa.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],aa.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],aa.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],aa.scfsi_band=[0,6,11,16,21],C.Q_MAX=257,C.Q_MAX2=116,C.LARGE_BITS=1e5,C.IXMAX_VAL=8206;var ba={};ba.SFBMAX=3*I.SBMAX_s,I.ENCDELAY=576,I.POSTDELAY=1152,I.MDCTDELAY=48,I.FFTOFFSET=224+I.MDCTDELAY,I.DECDELAY=528,I.SBLIMIT=32,I.CBANDS=64,I.SBPSY_l=21,I.SBPSY_s=12,I.SBMAX_l=22,I.SBMAX_s=13,I.PSFB21=6,I.PSFB12=6,I.BLKSIZE=1024,I.HBLKSIZE=I.BLKSIZE/2+1,I.BLKSIZE_s=256,I.HBLKSIZE_s=I.BLKSIZE_s/2+1,I.NORM_TYPE=0,I.START_TYPE=1,I.SHORT_TYPE=2,I.STOP_TYPE=3,I.MPG_MD_LR_LR=0,I.MPG_MD_LR_I=1,I.MPG_MD_MS_LR=2,I.MPG_MD_MS_I=3,I.fircoef=[-0.1039435,-0.1892065,5*-.0432472,-0.155915,3.898045e-17,.0467745*5,.50455,.756825,.187098*5],N.MFSIZE=3456+I.ENCDELAY-I.MDCTDELAY,N.MAX_HEADER_BUF=256,N.MAX_BITS_PER_CHANNEL=4095,N.MAX_BITS_PER_GRANULE=7680,N.BPC=320,W.RIFF=X("RIFF"),W.WAVE=X("WAVE"),W.fmt_=X("fmt "),W.data=X("data"),W.readHeader=function(a){var b=new W,c=a.getUint32(0,!1);if(W.RIFF==c){a.getUint32(4,!0);if(W.WAVE==a.getUint32(8,!1)&&W.fmt_==a.getUint32(12,!1)){var d=a.getUint32(16,!0),e=20;switch(d){case 16:case 18:b.channels=a.getUint16(e+2,!0),b.sampleRate=a.getUint32(e+4,!0);break;default:throw"extended fmt chunk not implemented"}e+=d;for(var f=W.data,g=0;f!=c&&(c=a.getUint32(e,!1),g=a.getUint32(e+4,!0),f!=c);)e+=g+8;return b.dataLen=g,b.dataOffset=e+8,b}}},ba.SFBMAX=3*I.SBMAX_s,this.Mp3Encoder=V,this.WavHeader=W}a.exports=c}).call(b,c(14).Buffer)},function(a,b,c){},function(a,b,c){"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===e.call(a)},g=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b=d.call(a,"constructor"),c=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!c)return!1;var f;for(f in a);return"undefined"==typeof f||d.call(a,f)};a.exports=function h(){var a,b,c,d,e,i,j=arguments[0],k=1,l=arguments.length,m=!1;for("boolean"==typeof j?(m=j,j=arguments[1]||{},k=2):("object"!=typeof j&&"function"!=typeof j||null==j)&&(j={});l>k;++k)if(a=arguments[k],null!=a)for(b in a)c=j[b],d=a[b],j!==d&&(m&&d&&(g(d)||(e=f(d)))?(e?(e=!1,i=c&&f(c)?c:[]):i=c&&g(c)?c:{},j[b]=h(m,i,d)):"undefined"!=typeof d&&(j[b]=d));return j}},function(a,b,c){function d(){if(!h){h=!0;for(var a,b=g.length;b;){a=g,g=[];for(var c=-1;++c<b;)a[c]();b=g.length}h=!1}}function e(){}var f=a.exports={},g=[],h=!1;f.nextTick=function(a){g.push(a),h||setTimeout(d,0)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=e,f.addListener=e,f.once=e,f.off=e,f.removeListener=e,f.removeAllListeners=e,f.emit=e,f.binding=function(a){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(a){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(a,b,c){a.exports=function(){throw new Error("define cannot be used indirect")}},function(a,b,c){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b,c){(function(a,d){function e(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}function f(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(b){return this instanceof a?(this.length=0,this.parent=void 0,"number"==typeof b?g(this,b):"string"==typeof b?h(this,b,arguments.length>1?arguments[1]:"utf8"):i(this,b)):arguments.length>1?new a(b,arguments[1]):new a(b)}function g(b,c){if(b=p(b,0>c?0:0|q(c)),!a.TYPED_ARRAY_SUPPORT)for(var d=0;c>d;d++)b[d]=0;return b}function h(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|s(b,c);return a=p(a,d),a.write(b,c),a}function i(b,c){if(a.isBuffer(c))return j(b,c);if(Y(c))return k(b,c);if(null==c)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(c.buffer instanceof ArrayBuffer)return l(b,c);if(c instanceof ArrayBuffer)return m(b,c)}return c.length?n(b,c):o(b,c)}function j(a,b){var c=0|q(b.length);return a=p(a,c),b.copy(a,0,0,c),a}function k(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function m(b,c){return a.TYPED_ARRAY_SUPPORT?(c.byteLength,b=a._augment(new Uint8Array(c))):b=l(b,new Uint8Array(c)),b}function n(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function o(a,b){var c,d=0;"Buffer"===b.type&&Y(b.data)&&(c=b.data,d=0|q(c.length)),a=p(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function p(b,c){a.TYPED_ARRAY_SUPPORT?(b=a._augment(new Uint8Array(c)),b.__proto__=a.prototype):(b.length=c,b._isBuffer=!0);var d=0!==c&&c<=a.poolSize>>>1;return d&&(b.parent=Z),b}function q(a){if(a>=f())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f().toString(16)+" bytes");return 0|a}function r(b,c){if(!(this instanceof r))return new r(b,c);var d=new a(b,c);return delete d.parent,d}function s(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return R(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return U(a).length;default:if(d)return R(a).length;b=(""+b).toLowerCase(),d=!0}}function t(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function v(a,b,c,d){return V(R(b,a.length-c),a,c,d)}function w(a,b,c,d){return V(S(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return V(U(b),a,c,d)}function z(a,b,c,d){return V(T(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?W.fromByteArray(a):W.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if($>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=$));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=Q(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(b,c,d,e,f,g){if(!a.isBuffer(b))throw new TypeError("buffer must be a Buffer instance");if(c>f||g>c)throw new RangeError("value is out of bounds");if(d+e>b.length)throw new RangeError("index out of range")}function J(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function M(a,b,c,d,e){return e||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,e){return e||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(a,b,c,d,52,8),c+8}function O(a){if(a=P(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function P(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Q(a){return 16>a?"0"+a.toString(16):a.toString(16)}function R(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function S(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function T(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function U(a){return W.toByteArray(O(a))}function V(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var W=c(17),X=c(16),Y=c(15);b.Buffer=a,b.SlowBuffer=r,b.INSPECT_MAX_BYTES=50,a.poolSize=8192;var Z={};a.TYPED_ARRAY_SUPPORT=void 0!==d.TYPED_ARRAY_SUPPORT?d.TYPED_ARRAY_SUPPORT:e(),a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array),a.isBuffer=function(a){return!(null==a||!a._isBuffer)},a.compare=function(b,c){if(!a.isBuffer(b)||!a.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;for(var d=b.length,e=c.length,f=0,g=Math.min(d,e);g>f&&b[f]===c[f];)++f;return f!==g&&(d=b[f],e=c[f]),e>d?-1:d>e?1:0},a.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(b,c){if(!Y(b))throw new TypeError("list argument must be an Array of Buffers.");if(0===b.length)return new a(0);var d;if(void 0===c)for(c=0,d=0;d<b.length;d++)c+=b[d].length;var e=new a(c),f=0;for(d=0;d<b.length;d++){var g=b[d];g.copy(e,f),f+=g.length}return e},a.byteLength=s,a.prototype.length=void 0,a.prototype.parent=void 0,a.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?B(this,0,a):t.apply(this,arguments)},a.prototype.equals=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===a.compare(this,b)},a.prototype.inspect=function(){var a="",c=b.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... ")),"<Buffer "+a+">"},a.prototype.compare=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:a.compare(this,b)},a.prototype.indexOf=function(b,c){function d(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(c>2147483647?c=2147483647:-2147483648>c&&(c=-2147483648),c>>=0,0===this.length)return-1;if(c>=this.length)return-1;if(0>c&&(c=Math.max(this.length+c,0)),"string"==typeof b)return 0===b.length?-1:String.prototype.indexOf.call(this,b,c);if(a.isBuffer(b))return d(this,b,c);if("number"==typeof b)return a.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,b,c):d(this,[b],c);throw new TypeError("val must be string, number or Buffer")},a.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},a.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},a.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;a.prototype.slice=function(b,c){var d=this.length;b=~~b,c=void 0===c?d:~~c,0>b?(b+=d,0>b&&(b=0)):b>d&&(b=d),0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d),b>c&&(c=b);var e;if(a.TYPED_ARRAY_SUPPORT)e=a._augment(this.subarray(b,c));else{var f=c-b;e=new a(f,void 0);for(var g=0;f>g;g++)e[g]=this[g+b]}return e.length&&(e.parent=this.parent||this),e},a.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},a.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},a.prototype.readUInt8=function(a,b){return b||H(a,1,this.length),this[a]},a.prototype.readUInt16LE=function(a,b){return b||H(a,2,this.length),this[a]|this[a+1]<<8},a.prototype.readUInt16BE=function(a,b){return b||H(a,2,this.length),this[a]<<8|this[a+1]},a.prototype.readUInt32LE=function(a,b){return b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},a.prototype.readUInt32BE=function(a,b){return b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},a.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},a.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},a.prototype.readInt8=function(a,b){return b||H(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},a.prototype.readInt16LE=function(a,b){b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt16BE=function(a,b){b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt32LE=function(a,b){return b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},a.prototype.readInt32BE=function(a,b){return b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},a.prototype.readFloatLE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!0,23,4)},a.prototype.readFloatBE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!1,23,4)},a.prototype.readDoubleLE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!0,52,8)},a.prototype.readDoubleBE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!1,52,8)},a.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},a.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},a.prototype.writeUInt8=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,1,255,0),a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),this[c]=255&b,c+1},a.prototype.writeUInt16LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):J(this,b,c,!0),c+2},a.prototype.writeUInt16BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):J(this,b,c,!1),c+2},a.prototype.writeUInt32LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=255&b):K(this,b,c,!0),c+4},a.prototype.writeUInt32BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):K(this,b,c,!1),c+4},a.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},a.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},a.prototype.writeInt8=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,1,127,-128),a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),0>b&&(b=255+b+1),this[c]=255&b,c+1},a.prototype.writeInt16LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):J(this,b,c,!0),c+2},a.prototype.writeInt16BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):J(this,b,c,!1),c+2},a.prototype.writeInt32LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):K(this,b,c,!0),c+4},a.prototype.writeInt32BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,2147483647,-2147483648),0>b&&(b=4294967295+b+1),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):K(this,b,c,!1),c+4},a.prototype.writeFloatLE=function(a,b,c){return M(this,a,b,!0,c)},a.prototype.writeFloatBE=function(a,b,c){return M(this,a,b,!1,c)},a.prototype.writeDoubleLE=function(a,b,c){return N(this,a,b,!0,c)},a.prototype.writeDoubleBE=function(a,b,c){return N(this,a,b,!1,c)},a.prototype.copy=function(b,c,d,e){if(d||(d=0),e||0===e||(e=this.length),c>=b.length&&(c=b.length),c||(c=0),e>0&&d>e&&(e=d),e===d)return 0;if(0===b.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),b.length-c<e-d&&(e=b.length-c+d);var f,g=e-d;if(this===b&&c>d&&e>c)for(f=g-1;f>=0;f--)b[f+c]=this[f+d];else if(1e3>g||!a.TYPED_ARRAY_SUPPORT)for(f=0;g>f;f++)b[f+c]=this[f+d];else b._set(this.subarray(d,d+g),c);return g},a.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=R(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},a.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(a.TYPED_ARRAY_SUPPORT)return new a(this).buffer;for(var b=new Uint8Array(this.length),c=0,d=b.length;d>c;c+=1)b[c]=this[c];return b.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var _=a.prototype;a._augment=function(b){return b.constructor=a,b._isBuffer=!0,b._set=b.set,b.get=_.get,b.set=_.set,b.write=_.write,b.toString=_.toString,b.toLocaleString=_.toString,b.toJSON=_.toJSON,b.equals=_.equals,b.compare=_.compare,b.indexOf=_.indexOf,b.copy=_.copy,b.slice=_.slice,b.readUIntLE=_.readUIntLE,b.readUIntBE=_.readUIntBE,b.readUInt8=_.readUInt8,b.readUInt16LE=_.readUInt16LE,b.readUInt16BE=_.readUInt16BE,b.readUInt32LE=_.readUInt32LE,b.readUInt32BE=_.readUInt32BE,b.readIntLE=_.readIntLE,b.readIntBE=_.readIntBE,b.readInt8=_.readInt8,b.readInt16LE=_.readInt16LE,b.readInt16BE=_.readInt16BE,b.readInt32LE=_.readInt32LE,b.readInt32BE=_.readInt32BE,b.readFloatLE=_.readFloatLE,b.readFloatBE=_.readFloatBE,b.readDoubleLE=_.readDoubleLE,b.readDoubleBE=_.readDoubleBE,b.writeUInt8=_.writeUInt8,b.writeUIntLE=_.writeUIntLE,b.writeUIntBE=_.writeUIntBE,b.writeUInt16LE=_.writeUInt16LE,b.writeUInt16BE=_.writeUInt16BE,b.writeUInt32LE=_.writeUInt32LE,b.writeUInt32BE=_.writeUInt32BE,b.writeIntLE=_.writeIntLE,b.writeIntBE=_.writeIntBE,b.writeInt8=_.writeInt8,b.writeInt16LE=_.writeInt16LE,b.writeInt16BE=_.writeInt16BE,b.writeInt32LE=_.writeInt32LE,b.writeInt32BE=_.writeInt32BE,b.writeFloatLE=_.writeFloatLE,b.writeFloatBE=_.writeFloatBE,b.writeDoubleLE=_.writeDoubleLE,b.writeDoubleBE=_.writeDoubleBE,b.fill=_.fill,b.inspect=_.inspect,b.toArrayBuffer=_.toArrayBuffer,b};var aa=/[^+\/0-9A-Za-z-_]/g}).call(b,c(14).Buffer,function(){return this}())},function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;a.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},function(a,b,c){b.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},b.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}(b)}])})},{}],3:[function(b,c,d){!function(b){function c(){this._events={},this._conf&&e.call(this,this._conf)}function e(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function f(a){this._events={},this.newListener=!1,e.call(this,a)}function g(a,b,c,d){if(!c)return[];var e,f,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(e=0,f=c._listeners.length;f>e;e++)a&&a.push(c._listeners[e]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(g(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(g(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(g(a,b,c[h],n))),m=m.concat(g(a,b,c[h],d))):m=h===p?m.concat(g(a,b,c[h],d+2)):m.concat(g(a,b,c[h],d)));return m}m=m.concat(g(a,b,c[o],d+1))}if(i=c["*"],i&&g(a,b,i,d+1),j=c["**"])if(n>d){j._listeners&&g(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?g(a,b,j[h],d+2):h===o?g(a,b,j[h],d+1):(k={},k[h]=j[h],g(a,b,{"**":k},d+1)))}else j._listeners?g(a,b,j,n):j["*"]&&j["*"]._listeners&&g(a,b,j["*"],n);return m}function h(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,f=a.shift();f;){
if(e[f]||(e[f]={}),e=e[f],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(i(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var g=j;"undefined"!=typeof this._events.maxListeners&&(g=this._events.maxListeners),g>0&&e._listeners.length>g&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}f=a.shift()}return!0}var i=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=10;f.prototype.delimiter=".",f.prototype.setMaxListeners=function(a){this._events||c.call(this),this._events.maxListeners=a,this._conf||(this._conf={}),this._conf.maxListeners=a},f.prototype.event="",f.prototype.once=function(a,b){return this.many(a,1,b),this},f.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},f.prototype.emit=function(){this._events||c.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(e=0,b=this._all.length;b>e;e++)this.event=a,this._all[e].apply(this,d)}if("error"===a&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var f;if(this.wildcard){f=[];var h="string"==typeof a?a.split(this.delimiter):a.slice();g.call(this,f,h,this.listenerTree,0)}else f=this._events[a];if("function"==typeof f){if(this.event=a,1===arguments.length)f.call(this);else if(arguments.length>1)switch(arguments.length){case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];f.apply(this,d)}return!0}if(f){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(var i=f.slice(),e=0,b=i.length;b>e;e++)this.event=a,i[e].apply(this,d);return i.length>0||!!this._all}return!!this._all},f.prototype.on=function(a,b){if("function"==typeof a)return this.onAny(a),this;if("function"!=typeof b)throw new Error("on only accepts instances of Function");if(this._events||c.call(this),this.emit("newListener",a,b),this.wildcard)return h.call(this,a,b),this;if(this._events[a]){if("function"==typeof this._events[a])this._events[a]=[this._events[a],b];else if(i(this._events[a])&&(this._events[a].push(b),!this._events[a].warned)){var d=j;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[a].length>d&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}}else this._events[a]=b;return this},f.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},f.prototype.addListener=f.prototype.on,f.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,d=[];if(this.wildcard){var e="string"==typeof a?a.split(this.delimiter):a.slice();d=g.call(this,null,e,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],d.push({_listeners:c})}for(var f=0;f<d.length;f++){var h=d[f];if(c=h._listeners,i(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?h._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete h._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete h._listeners:delete this._events[a])}return this},f.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},f.prototype.removeListener=f.prototype.off,f.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||c.call(this),this;if(this.wildcard)for(var b="string"==typeof a?a.split(this.delimiter):a.slice(),d=g.call(this,null,b,this.listenerTree,0),e=0;e<d.length;e++){var f=d[e];f._listeners=null}else{if(!this._events[a])return this;this._events[a]=null}return this},f.prototype.listeners=function(a){if(this.wildcard){var b=[],d="string"==typeof a?a.split(this.delimiter):a.slice();return g.call(this,b,d,this.listenerTree,0),b}return this._events||c.call(this),this._events[a]||(this._events[a]=[]),i(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},f.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof a&&a.amd?a(function(){return f}):"object"==typeof d?d.EventEmitter2=f:window.EventEmitter2=f}()},{}],4:[function(a,b,c){var d=a("fast-diff"),e=a("./is"),f=a("./op"),g=String.fromCharCode(0),h=function(a){e.array(a)?this.ops=a:e.object(a)&&e.array(a.ops)?this.ops=a.ops:this.ops=[]};h.prototype.insert=function(a,b){var c={};return 0===a.length?this:(c.insert=a,e.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c))},h.prototype["delete"]=function(a){return 0>=a?this:this.push({"delete":a})},h.prototype.retain=function(a,b){if(0>=a)return this;var c={retain:a};return e.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c)},h.prototype.push=function(a){var b=this.ops.length,c=this.ops[b-1];if(a=f.clone(a),e.object(c)){if(e.number(a["delete"])&&e.number(c["delete"]))return this.ops[b-1]={"delete":c["delete"]+a["delete"]},this;if(e.number(c["delete"])&&null!=a.insert&&(b-=1,c=this.ops[b-1],!e.object(c)))return this.ops.unshift(a),this;if(e.equal(a.attributes,c.attributes)){if(e.string(a.insert)&&e.string(c.insert))return this.ops[b-1]={insert:c.insert+a.insert},e.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this;if(e.number(a.retain)&&e.number(c.retain))return this.ops[b-1]={retain:c.retain+a.retain},e.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this}}return b===this.ops.length?this.ops.push(a):this.ops.splice(b,0,a),this},h.prototype.chop=function(){var a=this.ops[this.ops.length-1];return a&&a.retain&&!a.attributes&&this.ops.pop(),this},h.prototype.length=function(){return this.ops.reduce(function(a,b){return a+f.length(b)},0)},h.prototype.slice=function(a,b){a=a||0,e.number(b)||(b=1/0);for(var c=new h,d=f.iterator(this.ops),g=0;b>g&&d.hasNext();){var i;a>g?i=d.next(a-g):(i=d.next(b-g),c.push(i)),g+=f.length(i)}return c},h.prototype.compose=function(a){for(var b=f.iterator(this.ops),c=f.iterator(a.ops),d=new h;b.hasNext()||c.hasNext();)if("insert"===c.peekType())d.push(c.next());else if("delete"===b.peekType())d.push(b.next());else{var g=Math.min(b.peekLength(),c.peekLength()),i=b.next(g),j=c.next(g);if(e.number(j.retain)){var k={};e.number(i.retain)?k.retain=g:k.insert=i.insert;var l=f.attributes.compose(i.attributes,j.attributes,e.number(i.retain));l&&(k.attributes=l),d.push(k)}else e.number(j["delete"])&&e.number(i.retain)&&d.push(j)}return d.chop()},h.prototype.diff=function(a){var b=new h;if(this.ops===a.ops)return b;var c=[this.ops,a.ops].map(function(b){return b.map(function(c){if(null!=c.insert)return e.string(c.insert)?c.insert:g;var d=b===a.ops?"on":"with";throw new Error("diff() called "+d+" non-document")}).join("")}),i=d(c[0],c[1]),j=f.iterator(this.ops),k=f.iterator(a.ops);return i.forEach(function(a){for(var c=a[1].length;c>0;){var g=0;switch(a[0]){case d.INSERT:g=Math.min(k.peekLength(),c),b.push(k.next(g));break;case d.DELETE:g=Math.min(c,j.peekLength()),j.next(g),b["delete"](g);break;case d.EQUAL:g=Math.min(j.peekLength(),k.peekLength(),c);var h=j.next(g),i=k.next(g);e.equal(h.insert,i.insert)?b.retain(g,f.attributes.diff(h.attributes,i.attributes)):b.push(i)["delete"](g)}c-=g}}),b.chop()},h.prototype.transform=function(a,b){if(b=!!b,e.number(a))return this.transformPosition(a,b);for(var c=f.iterator(this.ops),d=f.iterator(a.ops),g=new h;c.hasNext()||d.hasNext();)if("insert"!==c.peekType()||!b&&"insert"===d.peekType())if("insert"===d.peekType())g.push(d.next());else{var i=Math.min(c.peekLength(),d.peekLength()),j=c.next(i),k=d.next(i);if(j["delete"])continue;k["delete"]?g.push(k):g.retain(i,f.attributes.transform(j.attributes,k.attributes,b))}else g.retain(f.length(c.next()));return g.chop()},h.prototype.transformPosition=function(a,b){b=!!b;for(var c=f.iterator(this.ops),d=0;c.hasNext()&&a>=d;){var e=c.peekLength(),g=c.peekType();c.next(),"delete"!==g?("insert"===g&&(a>d||!b)&&(a+=e),d+=e):a-=Math.min(e,a-d)}return a},b.exports=h},{"./is":5,"./op":6,"fast-diff":7}],5:[function(a,b,c){b.exports={equal:function(a,b){if(a===b)return!0;if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(!this.object(a)||!this.object(b))return!1;if(Object.keys(a).length!=Object.keys(b).length)return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0},array:function(a){return Array.isArray(a)},number:function(a){return"number"==typeof a?!0:"object"==typeof a&&"[object Number]"===Object.prototype.toString.call(a)?!0:!1},object:function(a){return a?"function"==typeof a||"object"==typeof a:!1},string:function(a){return"string"==typeof a?!0:"object"==typeof a&&"[object String]"===Object.prototype.toString.call(a)?!0:!1}}},{}],6:[function(a,b,c){function d(a){this.ops=a,this.index=0,this.offset=0}var e=a("./is"),f={attributes:{clone:function(a,b){return e.object(a)?Object.keys(a).reduce(function(c,d){return void 0===a[d]||null===a[d]&&!b||(c[d]=a[d]),c},{}):{}},compose:function(a,b,c){e.object(a)||(a={}),e.object(b)||(b={});var d=this.clone(b,c);for(var f in a)void 0!==a[f]&&void 0===b[f]&&(d[f]=a[f]);return Object.keys(d).length>0?d:void 0},diff:function(a,b){e.object(a)||(a={}),e.object(b)||(b={});var c=Object.keys(a).concat(Object.keys(b)).reduce(function(c,d){return a[d]!==b[d]&&(c[d]=void 0===b[d]?null:b[d]),c},{});return Object.keys(c).length>0?c:void 0},transform:function(a,b,c){if(!e.object(a))return b;if(e.object(b)){if(!c)return b;var d=Object.keys(b).reduce(function(c,d){return void 0===a[d]&&(c[d]=b[d]),c},{});return Object.keys(d).length>0?d:void 0}}},clone:function(a){var b=this.attributes.clone(a);return e.object(b.attributes)&&(b.attributes=this.attributes.clone(b.attributes,!0)),b},iterator:function(a){return new d(a)},length:function(a){return e.number(a["delete"])?a["delete"]:e.number(a.retain)?a.retain:e.string(a.insert)?a.insert.length:1}};d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(a){a||(a=1/0);var b=this.ops[this.index];if(b){var c=this.offset,d=f.length(b);if(a>=d-c?(a=d-c,this.index+=1,this.offset=0):this.offset+=a,e.number(b["delete"]))return{"delete":a};var g={};return b.attributes&&(g.attributes=b.attributes),e.number(b.retain)?g.retain=a:e.string(b.insert)?g.insert=b.insert.substr(c,a):g.insert=b.insert,g}return{retain:1/0}},d.prototype.peekLength=function(){return this.ops[this.index]?f.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?e.number(this.ops[this.index]["delete"])?"delete":e.number(this.ops[this.index].retain)?"retain":"insert":"retain"},b.exports=f},{"./is":5}],7:[function(a,b,c){function d(a,b){if(a==b)return a?[[n,a]]:[];var c=h(a,b),d=a.substring(0,c);a=a.substring(c),b=b.substring(c),c=i(a,b);var f=a.substring(a.length-c);a=a.substring(0,a.length-c),b=b.substring(0,b.length-c);var g=e(a,b);return d&&g.unshift([n,d]),f&&g.push([n,f]),k(g),g}function e(a,b){var c;if(!a)return[[m,b]];if(!b)return[[l,a]];var e=a.length>b.length?a:b,g=a.length>b.length?b:a,h=e.indexOf(g);if(-1!=h)return c=[[m,e.substring(0,h)],[n,g],[m,e.substring(h+g.length)]],a.length>b.length&&(c[0][0]=c[2][0]=l),c;if(1==g.length)return[[l,a],[m,b]];var i=j(a,b);if(i){var k=i[0],o=i[1],p=i[2],q=i[3],r=i[4],s=d(k,p),t=d(o,q);return s.concat([[n,r]],t)}return f(a,b)}function f(a,b){for(var c=a.length,d=b.length,e=Math.ceil((c+d)/2),f=e,h=2*e,i=new Array(h),j=new Array(h),k=0;h>k;k++)i[k]=-1,j[k]=-1;i[f+1]=0,j[f+1]=0;for(var n=c-d,o=n%2!=0,p=0,q=0,r=0,s=0,t=0;e>t;t++){for(var u=-t+p;t-q>=u;u+=2){var v,w=f+u;v=u==-t||u!=t&&i[w-1]<i[w+1]?i[w+1]:i[w-1]+1;for(var x=v-u;c>v&&d>x&&a.charAt(v)==b.charAt(x);)v++,x++;if(i[w]=v,v>c)q+=2;else if(x>d)p+=2;else if(o){var y=f+n-u;if(y>=0&&h>y&&-1!=j[y]){var z=c-j[y];if(v>=z)return g(a,b,v,x)}}}for(var A=-t+r;t-s>=A;A+=2){var z,y=f+A;z=A==-t||A!=t&&j[y-1]<j[y+1]?j[y+1]:j[y-1]+1;for(var B=z-A;c>z&&d>B&&a.charAt(c-z-1)==b.charAt(d-B-1);)z++,B++;if(j[y]=z,z>c)s+=2;else if(B>d)r+=2;else if(!o){var w=f+n-A;if(w>=0&&h>w&&-1!=i[w]){var v=i[w],x=f+v-w;if(z=c-z,v>=z)return g(a,b,v,x)}}}}return[[l,a],[m,b]]}function g(a,b,c,e){var f=a.substring(0,c),g=b.substring(0,e),h=a.substring(c),i=b.substring(e),j=d(f,g),k=d(h,i);return j.concat(k)}function h(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function i(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function j(a,b){function c(a,b,c){for(var d,e,f,g,j=a.substring(c,c+Math.floor(a.length/4)),k=-1,l="";-1!=(k=b.indexOf(j,k+1));){var m=h(a.substring(c),b.substring(k)),n=i(a.substring(0,c),b.substring(0,k));l.length<n+m&&(l=b.substring(k-n,k)+b.substring(k,k+m),d=a.substring(0,c-n),e=a.substring(c+m),f=b.substring(0,k-n),g=b.substring(k+m))}return 2*l.length>=a.length?[d,e,f,g,l]:null}var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||2*e.length<d.length)return null;var f,g=c(d,e,Math.ceil(d.length/4)),j=c(d,e,Math.ceil(d.length/2));if(!g&&!j)return null;f=j?g&&g[4].length>j[4].length?g:j:g;var k,l,m,n;a.length>b.length?(k=f[0],l=f[1],m=f[2],n=f[3]):(m=f[0],n=f[1],k=f[2],l=f[3]);var o=f[4];return[k,l,m,n,o]}function k(a){a.push([n,""]);for(var b,c=0,d=0,e=0,f="",g="";c<a.length;)switch(a[c][0]){case m:e++,g+=a[c][1],c++;break;case l:d++,f+=a[c][1],c++;break;case n:d+e>1?(0!==d&&0!==e&&(b=h(g,f),0!==b&&(c-d-e>0&&a[c-d-e-1][0]==n?a[c-d-e-1][1]+=g.substring(0,b):(a.splice(0,0,[n,g.substring(0,b)]),c++),g=g.substring(b),f=f.substring(b)),b=i(g,f),0!==b&&(a[c][1]=g.substring(g.length-b)+a[c][1],g=g.substring(0,g.length-b),f=f.substring(0,f.length-b))),0===d?a.splice(c-e,d+e,[m,g]):0===e?a.splice(c-d,d+e,[l,f]):a.splice(c-d-e,d+e,[l,f],[m,g]),c=c-d-e+(d?1:0)+(e?1:0)+1):0!==c&&a[c-1][0]==n?(a[c-1][1]+=a[c][1],a.splice(c,1)):c++,e=0,d=0,f="",g=""}""===a[a.length-1][1]&&a.pop();var j=!1;for(c=1;c<a.length-1;)a[c-1][0]==n&&a[c+1][0]==n&&(a[c][1].substring(a[c][1].length-a[c-1][1].length)==a[c-1][1]?(a[c][1]=a[c-1][1]+a[c][1].substring(0,a[c][1].length-a[c-1][1].length),a[c+1][1]=a[c-1][1]+a[c+1][1],a.splice(c-1,1),j=!0):a[c][1].substring(0,a[c+1][1].length)==a[c+1][1]&&(a[c-1][1]+=a[c+1][1],a[c][1]=a[c][1].substring(a[c+1][1].length)+a[c+1][1],a.splice(c+1,1),j=!0)),c++;j&&k(a)}var l=-1,m=1,n=0,o=d;o.INSERT=m,o.DELETE=l,o.EQUAL=n,b.exports=o},{}],8:[function(a,b,c){b.exports={version:"0.20.0"}},{}],9:[function(a,b,c){var d,e,f,g,h,i,j,k;j=a("lodash"),d=a("rich-text/lib/delta"),k=a("../lib/dom"),f=a("./format"),g=a("./line"),h=a("../lib/linked-list"),i=a("./normalizer"),e=function(){function a(a,b){this.root=a,null==b&&(b={}),this.normalizer=new i,this.formats={},j.each(b.formats,j.bind(this.addFormat,this)),this.setHTML(this.root.innerHTML)}return a.prototype.addFormat=function(a,b){return j.isObject(b)||(b=f.FORMATS[a]),null!=this.formats[a]&&console.warn("Overwriting format",a,this.formats[a]),this.formats[a]=new f(b),this.normalizer.addFormat(b)},a.prototype.appendLine=function(a){return this.insertLineBefore(a,null)},a.prototype.findLeafAt=function(a,b){var c,d,e;return e=this.findLineAt(a),c=e[0],d=e[1],null!=c?c.findLeafAt(d,b):[void 0,d]},a.prototype.findLine=function(a){for(var b;null!=a&&null==k.BLOCK_TAGS[a.tagName];)a=a.parentNode;return b=null!=a?k(a).data(g.DATA_KEY):void 0,(null!=b?b.node:void 0)===a?b:void 0},a.prototype.findLineAt=function(a){var b,c;if(!(this.lines.length>0))return[void 0,a];if(c=this.toDelta().length(),a===c)return[this.lines.last,this.lines.last.length];if(a>c)return[void 0,a-c];for(b=this.lines.first;null!=b;){if(a<b.length)return[b,a];a-=b.length,b=b.next}return[void 0,a]},a.prototype.getHTML=function(){return this.root.innerHTML.replace(/\>\s+\</g,">&nbsp;<")},a.prototype.insertLineBefore=function(a,b){var c;return c=new g(this,a),null!=b?(k(a.parentNode).isElement()||this.root.insertBefore(a,b.node),this.lines.insertAfter(b.prev,c)):(k(a.parentNode).isElement()||this.root.appendChild(a),this.lines.append(c)),c},a.prototype.mergeLines=function(a,b){return b.length>1&&(1===a.length&&k(a.leaves.last.node).remove(),j.each(k(b.node).childNodes(),function(b){return b.tagName!==k.DEFAULT_BREAK_TAG?a.node.appendChild(b):void 0})),this.removeLine(b),a.rebuild()},a.prototype.optimizeLines=function(){return j.each(this.lines.toArray(),function(a,b){return a.optimize(),!0})},a.prototype.rebuild=function(){var a,b,c;for(b=this.lines.toArray(),a=this.root.firstChild,null!=a&&null!=k.LIST_TAGS[a.tagName]&&(a=a.firstChild),j.each(b,function(b){return function(c,d){for(var e,f;c.node!==a;){if(c.node.parentNode!==b.root&&(null!=(f=c.node.parentNode)?f.parentNode:void 0)!==b.root)return b.removeLine(c);a=b.normalizer.normalizeLine(a),e=b.insertLineBefore(a,c),a=k(a).nextLineNode(b.root)}return c.outerHTML!==a.outerHTML&&(c.node=b.normalizer.normalizeLine(c.node),c.rebuild()),a=k(a).nextLineNode(b.root)}}(this)),c=[];null!=a;)a=this.normalizer.normalizeLine(a),this.appendLine(a),c.push(a=k(a).nextLineNode(this.root));return c},a.prototype.removeLine=function(a){return null!=a.node.parentNode&&(k.LIST_TAGS[a.node.parentNode.tagName]&&1===a.node.parentNode.childNodes.length?k(a.node.parentNode).remove():k(a.node).remove()),this.lines.remove(a)},a.prototype.setHTML=function(a){return a=i.stripComments(a),a=i.stripWhitespace(a),this.root.innerHTML=a,this.lines=new h,this.rebuild()},a.prototype.splitLine=function(a,b){var c,d,e,f;return b=Math.min(b,a.length-1),f=k(a.node).split(b,!0),c=f[0],d=f[1],a.node=c,a.rebuild(),e=this.insertLineBefore(d,a.next),e.formats=j.clone(a.formats),e.resetContent(),e},a.prototype.toDelta=function(){var a,b;return b=this.lines.toArray(),a=new d,j.each(b,function(b){return j.each(b.delta.ops,function(b){return a.push(b)})}),a},a}(),b.exports=e},{"../lib/dom":18,"../lib/linked-list":19,"./format":11,"./line":13,"./normalizer":14,lodash:1,"rich-text/lib/delta":4}],10:[function(a,b,c){var d,e,f,g,h,i,j;i=a("lodash"),d=a("rich-text/lib/delta"),j=a("../lib/dom"),e=a("./document"),g=a("./line"),h=a("./selection"),f=function(){function a(a,b,c){this.root=a,this.quill=b,this.options=null!=c?c:{},this.root.setAttribute("id",this.options.id),this.doc=new e(this.root,this.options),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.selection=new h(this.doc,this.quill),this.timer=setInterval(i.bind(this.checkUpdate,this),this.options.pollInterval),this.savedRange=null,this.quill.on("selection-change",function(a){return function(b){return a.savedRange=b}}(this)),this.options.readOnly||this.enable()}return a.sources={API:"api",SILENT:"silent",USER:"user"},a.prototype.destroy=function(){return clearInterval(this.timer)},a.prototype.disable=function(){return this.enable(!1)},a.prototype.enable=function(a){return null==a&&(a=!0),this.root.setAttribute("contenteditable",a)},a.prototype.applyDelta=function(b,c){var d;return d=this._update(),d&&(b=d.transform(b,!0),d=b.transform(d,!1)),b.ops.length>0&&(b=this._trackDelta(function(a){return function(){var c;return c=0,i.each(b.ops,function(b){return i.isString(b.insert)?(a._insertAt(c,b.insert,b.attributes),c+=b.insert.length):i.isNumber(b.insert)?(a._insertEmbed(c,b.attributes),c+=1):i.isNumber(b["delete"])?a._deleteAt(c,b["delete"]):i.isNumber(b.retain)?(i.each(b.attributes,function(d,e){return a._formatAt(c,b.retain,e,d)}),c+=b.retain):void 0}),a.selection.shiftAfter(0,0,i.bind(a.doc.optimizeLines,a.doc))}}(this)),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.innerHTML=this.root.innerHTML,b&&c!==a.sources.SILENT&&this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,b,c)),d&&d.ops.length>0&&c!==a.sources.SILENT?this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,d,a.sources.USER):void 0},a.prototype.checkUpdate=function(b){var c;return null==b&&(b="user"),null==this.root.parentNode?clearInterval(this.timer):(c=this._update(),c&&(this.delta=this.delta.compose(c),this.length=this.delta.length(),this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,c,b)),c&&(b=a.sources.SILENT),this.selection.update(b))},a.prototype.focus=function(){return null!=this.selection.range?this.selection.setRange(this.selection.range):this.root.focus()},a.prototype.getBounds=function(a){var b,c,d,e,f,g,h;return this.checkUpdate(),g=this.doc.findLeafAt(a,!0),d=g[0],e=g[1],null==d?null:(c=this.root.parentNode.getBoundingClientRect(),h="left",0===d.length?b=d.node.parentNode.getBoundingClientRect():j.VOID_TAGS[d.node.tagName]?(b=d.node.getBoundingClientRect(),1===e&&(h="right")):(f=document.createRange(),e<d.length?(f.setStart(d.node,e),f.setEnd(d.node,e+1)):(f.setStart(d.node,e-1),f.setEnd(d.node,e),h="right"),b=f.getBoundingClientRect()),{height:b.height,left:b[h]-c.left,top:b.top-c.top})},a.prototype._deleteAt=function(a,b){return 0>=b?void 0:this.selection.shiftAfter(a,-1*b,function(c){return function(){var d,e,f,g,h,i,j;for(j=c.doc.findLineAt(a),f=j[0],i=j[1],d=f,g=f.length-i<=b&&i>0;null!=d&&b>0;)h=d.next,e=Math.min(d.length-i,b),0===i&&b>=d.length?c.doc.removeLine(d):d.deleteText(i,e),b-=e,d=h,i=0;return g&&f.next?c.doc.mergeLines(f,f.next):void 0}}(this))},a.prototype._formatAt=function(a,b,c,d){return this.selection.shiftAfter(a,0,function(e){return function(){var f,g,h,i,j;for(i=e.doc.findLineAt(a),g=i[0],h=i[1],j=[];null!=g&&b>0;)f=Math.min(b,g.length-h-1),g.formatText(h,f,c,d),b-=f,b>0&&g.format(c,d),b-=1,h=0,j.push(g=g.next);return j}}(this))},a.prototype._insertEmbed=function(a,b){return this.selection.shiftAfter(a,1,function(c){return function(){var d,e,f;return f=c.doc.findLineAt(a),d=f[0],e=f[1],d.insertEmbed(e,b)}}(this))},a.prototype._insertAt=function(a,b,c){return null==c&&(c={}),this.selection.shiftAfter(a,b.length,function(d){return function(){var e,f,g,h;return b=b.replace(/\r\n?/g,"\n"),f=b.split("\n"),h=d.doc.findLineAt(a),e=h[0],g=h[1],i.each(f,function(a,b){var h;return null==e||e.length<=g?(b<f.length-1||a.length>0)&&(e=d.doc.appendLine(document.createElement(j.DEFAULT_BLOCK_TAG)),g=0,e.insertText(g,a,c),e.format(c),h=null):(e.insertText(g,a,c),b<f.length-1&&(h=d.doc.splitLine(e,g+a.length),i.each(i.defaults({},c,e.formats),function(a,b){return e.format(b,c[b])}),g=0)),e=h})}}(this))},a.prototype._trackDelta=function(a){var b,c,d,e,f,g,h,j,k,l;g=null!=(k=this.savedRange)?k.start:void 0,a(),c=this.doc.toDelta(),this.savedRange=this.selection.getRange(),d=null!=(l=this.savedRange)?l.start:void 0;try{if(null!=g&&null!=d&&g<=this.delta.length()&&d<=c.length()&&(j=this.delta.slice(g),f=c.slice(d),i.isEqual(j.ops,f.ops)))return h=this.delta.slice(0,g),e=c.slice(0,d),h.diff(e)}catch(m){b=m}return this.delta.diff(c)},a.prototype._update=function(){var a;return this.innerHTML===this.root.innerHTML?!1:(a=this._trackDelta(function(a){return function(){return a.selection.preserve(i.bind(a.doc.rebuild,a.doc)),a.selection.shiftAfter(0,0,i.bind(a.doc.optimizeLines,a.doc))}}(this)),this.innerHTML=this.root.innerHTML,a.ops.length>0?a:!1)},a}(),b.exports=f},{"../lib/dom":18,"./document":9,"./line":13,"./selection":15,lodash:1,"rich-text/lib/delta":4}],11:[function(a,b,c){var d,e,f;e=a("lodash"),f=a("../lib/dom"),d=function(){function a(a){this.config=a}return a.types={LINE:"line",EMBED:"embed"},a.FORMATS={bold:{tag:"B",prepare:"bold"},italic:{tag:"I",prepare:"italic"},underline:{tag:"U",prepare:"underline"},strike:{tag:"S",prepare:"strikeThrough"},color:{style:"color","default":"rgb(0, 0, 0)",prepare:"foreColor"},background:{style:"backgroundColor","default":"rgb(255, 255, 255)",prepare:"backColor"},font:{style:"fontFamily","default":"'Helvetica', 'Arial', sans-serif",prepare:"fontName"},size:{style:"fontSize","default":"13px",prepare:function(a){return document.execCommand("fontSize",!1,f.convertFontSize(a))}},link:{tag:"A",add:function(a,b){return a.setAttribute("href",b),a.setAttribute("target","_blank"),a},remove:function(a){return a.removeAttribute("href"),a},value:function(a){return a.getAttribute("href")}},image:{type:a.types.EMBED,tag:"IMG",attribute:"src"},media:{type:a.types.EMBED,tag:"IFRAME",add:function(a,b){return a.setAttribute("src",b),a.setAttribute("frameborder","0"),a}},record:{type:a.types.EMBED,tag:"IFRAME",add:function(a,b){return a.setAttribute("src",b),a.setAttribute("frameborder","0"),a}},align:{type:a.types.LINE,style:"textAlign","default":"left"},bullet:{type:a.types.LINE,exclude:"list",parentTag:"UL",tag:"LI"},list:{type:a.types.LINE,exclude:"bullet",parentTag:"OL",tag:"LI"}},a.prototype.add=function(b,c){var d,g,h,i,j;return c?this.value(b)===c?b:(e.isString(this.config.parentTag)&&(h=b.parentNode,h.tagName!==this.config.parentTag&&(h=document.createElement(this.config.parentTag),f(b).wrap(h)),b.parentNode.tagName===(null!=(i=b.parentNode.previousSibling)?i.tagName:void 0)&&f(b.parentNode.previousSibling).merge(b.parentNode),b.parentNode.tagName===(null!=(j=b.parentNode.nextSibling)?j.tagName:void 0)&&f(b.parentNode).merge(b.parentNode.nextSibling)),e.isString(this.config.tag)&&b.tagName!==this.config.tag&&(d=document.createElement(this.config.tag),null!=f.VOID_TAGS[d.tagName]?(null!=b.parentNode&&f(b).replace(d),b=d):this.isType(a.types.LINE)?b=f(b).switchTag(this.config.tag).get():(b instanceof Node&&f(b).wrap(d),b=d)),(e.isString(this.config.style)||e.isString(this.config.attribute)||e.isString(this.config["class"]))&&(e.isString(this.config["class"])&&(b=this.remove(b)),f(b).isTextNode()&&(g=document.createElement(f.DEFAULT_INLINE_TAG),f(b).wrap(g),b=g),e.isString(this.config.style)&&c!==this.config["default"]&&(b.style[this.config.style]=c),e.isString(this.config.attribute)&&b.setAttribute(this.config.attribute,c),e.isString(this.config["class"])&&f(b).addClass(this.config["class"]+c)),e.isFunction(this.config.add)&&(b=this.config.add(b,c)),b):this.remove(b)},a.prototype.isType=function(a){return a===this.config.type},a.prototype.match=function(a){var b,c,d,g,h;if(!f(a).isElement())return!1;if(e.isString(this.config.parentTag)&&(null!=(g=a.parentNode)?g.tagName:void 0)!==this.config.parentTag)return!1;if(e.isString(this.config.tag)&&a.tagName!==this.config.tag)return!1;if(e.isString(this.config.style)&&(!a.style[this.config.style]||a.style[this.config.style]===this.config["default"]))return!1;if(e.isString(this.config.attribute)&&!a.hasAttribute(this.config.attribute))return!1;if(e.isString(this.config["class"])){for(h=f(a).classes(),c=0,d=h.length;d>c;c++)if(b=h[c],0===b.indexOf(this.config["class"]))return!0;return!1}return!0},a.prototype.prepare=function(a){return e.isString(this.config.prepare)?document.execCommand(this.config.prepare,!1,a):e.isFunction(this.config.prepare)?this.config.prepare(a):void 0},a.prototype.remove=function(b){var c,d,g,h;if(!this.match(b))return b;if(e.isString(this.config.style)&&(b.style[this.config.style]="",b.getAttribute("style")||b.removeAttribute("style")),e.isString(this.config.attribute)&&b.removeAttribute(this.config.attribute),e.isString(this.config["class"]))for(h=f(b).classes(),d=0,g=h.length;g>d;d++)c=h[d],0===c.indexOf(this.config["class"])&&f(b).removeClass(c);if(e.isString(this.config.tag))if(this.isType(a.types.LINE))e.isString(this.config.parentTag)&&(null!=b.previousSibling&&f(b).splitBefore(b.parentNode.parentNode),null!=b.nextSibling&&f(b.nextSibling).splitBefore(b.parentNode.parentNode)),b=f(b).switchTag(f.DEFAULT_BLOCK_TAG).get();else{if(this.isType(a.types.EMBED))return void f(b).remove();b=f(b).switchTag(f.DEFAULT_INLINE_TAG).get()}return e.isString(this.config.parentTag)&&f(b.parentNode).unwrap(),e.isFunction(this.config.remove)&&(b=this.config.remove(b)),b.tagName!==f.DEFAULT_INLINE_TAG||b.hasAttributes()||(b=f(b).unwrap()),b},a.prototype.value=function(a){var b,c,d,g;if(this.match(a)){if(this.config.value)return this.config.value(a);if(e.isString(this.config.attribute))return a.getAttribute(this.config.attribute)||void 0;if(e.isString(this.config.style))return a.style[this.config.style]||void 0;if(e.isString(this.config["class"])){for(g=f(a).classes(),c=0,d=g.length;d>c;c++)if(b=g[c],0===b.indexOf(this.config["class"]))return b.slice(this.config["class"].length)}else if(e.isString(this.config.tag))return!0}},a}(),b.exports=d},{"../lib/dom":18,lodash:1}],12:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;g=a("lodash"),h=a("../lib/dom"),d=a("./format"),f=a("../lib/linked-list"),e=function(a){function b(a,c){this.node=a,this.formats=g.clone(c),this.text=h(this.node).text(),this.length=this.text.length,h(this.node).data(b.DATA_KEY,this)}return i(b,a),b.DATA_KEY="leaf",b.isLeafNode=function(a){return h(a).isTextNode()||null==a.firstChild},b.prototype.deleteText=function(a,c){var d;if(c>0)return this.text=this.text.slice(0,a)+this.text.slice(a+c),this.length=this.text.length,null!=h.EMBED_TAGS[this.node.tagName]?(d=document.createTextNode(this.text),h(d).data(b.DATA_KEY,this),this.node=h(this.node).replace(d).get()):h(this.node).text(this.text)},b.prototype.insertText=function(a,c){var d;return this.text=this.text.slice(0,a)+c+this.text.slice(a),h(this.node).isTextNode()?h(this.node).text(this.text):(d=document.createTextNode(c),h(d).data(b.DATA_KEY,this),this.node.tagName===h.DEFAULT_BREAK_TAG?this.node=h(this.node).replace(d).get():(this.node.appendChild(d),this.node=d)),this.length=this.text.length},b}(f.Node),b.exports=e},{"../lib/dom":18,"../lib/linked-list":19,"./format":11,lodash:1}],13:[function(a,b,c){var d,e,f,g,h,i,j,k,l=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m={}.hasOwnProperty;j=a("lodash"),d=a("rich-text/lib/delta"),k=a("../lib/dom"),e=a("./format"),f=a("./leaf"),g=a("./line"),h=a("../lib/linked-list"),i=a("./normalizer"),g=function(a){function b(a,c){this.doc=a,this.node=c,this.formats={},this.rebuild(),b.__super__.constructor.call(this,this.node)}return l(b,a),b.DATA_KEY="line",b.prototype.buildLeaves=function(a,b){return j.each(k(a).childNodes(),function(a){return function(c){var d;return c=a.doc.normalizer.normalizeNode(c),d=j.clone(b),j.each(a.doc.formats,function(a,b){return!a.isType(e.types.LINE)&&a.match(c)?d[b]=a.value(c):void 0}),f.isLeafNode(c)?a.leaves.append(new f(c,d)):a.buildLeaves(c,d)}}(this))},b.prototype.deleteText=function(a,b){var c,d,e;if(b>0){for(e=this.findLeafAt(a),d=e[0],a=e[1];null!=d&&b>0;)c=Math.min(b,d.length-a),d.deleteText(a,c),b-=c,d=d.next,a=0;return this.rebuild()}},b.prototype.findLeaf=function(a){return null!=a?k(a).data(f.DATA_KEY):void 0},b.prototype.findLeafAt=function(a,b){var c;if(null==b&&(b=!1),a>=this.length-1)return[this.leaves.last,this.leaves.last.length];for(c=this.leaves.first;null!=c;){if(a<c.length||a===c.length&&b)return[c,a];a-=c.length,
c=c.next}return[this.leaves.last,a-this.leaves.last.length]},b.prototype.format=function(a,b){var c;return j.isObject(a)?c=a:(c={},c[a]=b),j.each(c,function(a){return function(b,c){var d,f;return f=a.doc.formats[c],null!=f?(f.isType(e.types.LINE)&&(f.config.exclude&&a.formats[f.config.exclude]&&(d=a.doc.formats[f.config.exclude],null!=d&&(a.node=d.remove(a.node),delete a.formats[f.config.exclude])),a.node=f.add(a.node,b)),b?a.formats[c]=b:delete a.formats[c]):void 0}}(this)),this.resetContent()},b.prototype.formatText=function(a,b,c,d){var f,g,h,i,j,l,m,n,o,p;if(l=this.findLeafAt(a),g=l[0],h=l[1],f=this.doc.formats[c],null!=f&&f.config.type!==e.types.LINE){for(;null!=g&&b>0;){if(j=g.next,d&&g.formats[c]!==d||!d&&null!=g.formats[c]){if(p=g.node,null!=g.formats[c]){for(k(p).splitBefore(this.node);!f.match(p);)p=p.parentNode;k(p).split(g.length)}h>0&&(m=k(p).split(h),i=m[0],p=m[1]),g.length>h+b&&(n=k(p).split(b),p=n[0],o=n[1]),f.add(p,d)}b-=g.length-h,h=0,g=j}return this.rebuild()}},b.prototype._insert=function(a,b,c){var d,f,g,h,i,l;return i=this.findLeafAt(a),d=i[0],f=i[1],b=j.reduce(c,function(a){return function(b,c,d){var f;return f=a.doc.formats[d],null==f||f.isType(e.types.LINE)||(b=f.add(b,c)),b}}(this),b),l=k(d.node).split(f),h=l[0],g=l[1],g&&(g=k(g).splitBefore(this.node).get()),this.node.insertBefore(b,g),this.rebuild()},b.prototype.insertEmbed=function(a,b){var c,d,f,g,h,i,l,m;return l=this.findLeafAt(a),d=l[0],f=l[1],m=k(d.node).split(f),i=m[0],g=m[1],c=j.find(Object.keys(b),function(a){return function(b){return a.doc.formats[b].isType(e.types.EMBED)}}(this)),h=this.doc.formats[c].add({},b[c]),b=j.clone(b),delete b[c],this._insert(a,h,b)},b.prototype.insertText=function(a,b,c){var d,e,f;return null==c&&(c={}),b.length>0?(f=this.findLeafAt(a),d=f[0],e=f[1],j.isEqual(d.formats,c)?(d.insertText(e,b),this.resetContent()):this._insert(a,document.createTextNode(b),c)):void 0},b.prototype.optimize=function(){return i.optimizeLine(this.node),this.rebuild()},b.prototype.rebuild=function(a){return null==a&&(a=!1),!a&&null!=this.outerHTML&&this.outerHTML===this.node.outerHTML&&j.all(this.leaves.toArray(),function(a){return function(b){return k(b.node).isAncestor(a.node)}}(this))?!1:(this.node=this.doc.normalizer.normalizeNode(this.node),0!==k(this.node).length()||this.node.querySelector(k.DEFAULT_BREAK_TAG)||this.node.appendChild(document.createElement(k.DEFAULT_BREAK_TAG)),this.leaves=new h,this.formats=j.reduce(this.doc.formats,function(a){return function(b,c,d){return c.isType(e.types.LINE)&&(c.match(a.node)?b[d]=c.value(a.node):delete b[d]),b}}(this),this.formats),this.buildLeaves(this.node,{}),this.resetContent(),!0)},b.prototype.resetContent=function(){return k(this.node).data(b.DATA_KEY,this),this.outerHTML=this.node.outerHTML,this.length=1,this.delta=new d,j.each(this.leaves.toArray(),function(a){return function(b){return a.length+=b.length,null!=k.EMBED_TAGS[b.node.tagName]?a.delta.insert(1,b.formats):a.delta.insert(b.text,b.formats)}}(this)),this.delta.insert("\n",this.formats)},b}(h.Node),b.exports=g},{"../lib/dom":18,"../lib/linked-list":19,"./format":11,"./leaf":12,"./line":13,"./normalizer":14,lodash:1,"rich-text/lib/delta":4}],14:[function(a,b,c){var d,e,f,g;e=a("lodash"),g=a("../lib/dom"),f=function(a){return a=a.replace(/(?:^|[-_])(\w)/g,function(a,b){return b?b.toUpperCase():""}),a.charAt(0).toLowerCase()+a.slice(1)},d=function(){function a(){this.whitelist={styles:{},tags:{}},this.whitelist.tags[g.DEFAULT_BREAK_TAG]=!0,this.whitelist.tags[g.DEFAULT_BLOCK_TAG]=!0,this.whitelist.tags[g.DEFAULT_INLINE_TAG]=!0}return a.ALIASES={STRONG:"B",EM:"I",DEL:"S",STRIKE:"S"},a.ATTRIBUTES={color:"color",face:"fontFamily",size:"fontSize"},a.prototype.addFormat=function(a){return null!=a.tag&&(this.whitelist.tags[a.tag]=!0),null!=a.parentTag&&(this.whitelist.tags[a.parentTag]=!0),null!=a.style?this.whitelist.styles[a.style]=!0:void 0},a.prototype.normalizeLine=function(b){return b=a.wrapInline(b),b=a.handleBreaks(b),"LI"===b.tagName&&a.flattenList(b),b=a.pullBlocks(b),b=this.normalizeNode(b),a.unwrapText(b),null!=b&&null!=g.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalizeNode=function(b){return g(b).isTextNode()?b:(e.each(a.ATTRIBUTES,function(a,c){var d;return b.hasAttribute(c)?(d=b.getAttribute(c),"size"===c&&(d=g.convertFontSize(d)),b.style[a]=d,b.removeAttribute(c)):void 0}),"bold"===b.style.fontWeight&&(b.style.fontWeight="",g(b).wrap(document.createElement("b"))),this.whitelistStyles(b),this.whitelistTags(b))},a.prototype.whitelistStyles=function(a){var b,c;return b=g(a).styles(),c=e.omit(b,function(a){return function(b,c){return null==a.whitelist.styles[f(c)]}}(this)),Object.keys(c).length<Object.keys(b).length?Object.keys(c).length>0?g(a).styles(c,!0):a.removeAttribute("style"):void 0},a.prototype.whitelistTags=function(b){return g(b).isElement()?(null!=a.ALIASES[b.tagName]?b=g(b).switchTag(a.ALIASES[b.tagName]).get():null==this.whitelist.tags[b.tagName]&&(b=null!=g.BLOCK_TAGS[b.tagName]?g(b).switchTag(g.DEFAULT_BLOCK_TAG).get():b.hasAttributes()||null==b.firstChild?g(b).switchTag(g.DEFAULT_INLINE_TAG).get():g(b).unwrap()),b):b},a.flattenList=function(a){var b,c,d;return d=a.nextSibling,b=e.map(a.querySelectorAll("li")),b.forEach(function(b){return a.parentNode.insertBefore(b,d),d=b.nextSibling}),c=e.map(a.querySelectorAll(Object.keys(g.LIST_TAGS).join(","))),c.forEach(function(a){return g(a).remove()})},a.handleBreaks=function(a){var b;return b=e.map(a.querySelectorAll(g.DEFAULT_BREAK_TAG)),e.each(b,function(b){return function(b){return null==b.nextSibling||g.isIE(10)&&null==b.previousSibling?void 0:g(b.nextSibling).splitBefore(a.parentNode)}}(this)),a},a.optimizeLine=function(a){var b,c,d,f;for(a.normalize(),b=g(a).length(),d=g(a).descendants(),f=[];d.length>0;)c=d.pop(),null!=(null!=c?c.parentNode:void 0)&&null==g.EMBED_TAGS[c.tagName]&&(c.tagName===g.DEFAULT_BREAK_TAG?0!==b?f.push(g(c).remove()):f.push(void 0):0===g(c).length()?(d.push(c.nextSibling),f.push(g(c).unwrap())):null!=c.previousSibling&&c.tagName===c.previousSibling.tagName&&e.isEqual(g(c).attributes(),g(c.previousSibling).attributes())?(d.push(c.firstChild),f.push(g(c.previousSibling).merge(c))):f.push(void 0));return f},a.pullBlocks=function(b){var c;for(c=b.firstChild;null!=c;){if(null!=g.BLOCK_TAGS[c.tagName]&&"LI"!==c.tagName){g(c).isolate(b.parentNode),null!=g.LIST_TAGS[c.tagName]&&c.firstChild?(g(c.parentNode).unwrap(),null==b.parentNode&&(b=c)):(g(c).unwrap(),a.pullBlocks(b));break}c=c.nextSibling}return b},a.stripComments=function(a){return a.replace(/<!--[\s\S]*?-->/g,"")},a.stripWhitespace=function(a){return a=a.trim(),a=a.replace(/(\r?\n|\r)+/g," "),a=a.replace(/\>\s+\</g,"><")},a.wrapInline=function(a){var b,c;if(null!=g.BLOCK_TAGS[a.tagName])return a;for(b=document.createElement(g.DEFAULT_BLOCK_TAG),a.parentNode.insertBefore(b,a);null!=a&&null==g.BLOCK_TAGS[a.tagName];)c=a.nextSibling,b.appendChild(a),a=c;return b},a.unwrapText=function(a){var b;return b=e.map(a.querySelectorAll(g.DEFAULT_INLINE_TAG)),e.each(b,function(a){return a.hasAttributes()?void 0:g(a).unwrap()})},a}(),b.exports=d},{"../lib/dom":18,lodash:1}],15:[function(a,b,c){var d,e,f,g,h,i;h=a("lodash"),i=a("../lib/dom"),d=a("./leaf"),e=a("./normalizer"),f=a("../lib/range"),g=function(){function a(a,b){this.doc=a,this.emitter=b,this.focus=!1,this.range=new f(0,0),this.nullDelay=!1,this.update("silent")}return a.prototype.checkFocus=function(){return document.activeElement===this.doc.root},a.prototype.getRange=function(a){var b,c,d;return null==a&&(a=!1),this.checkFocus()?(c=this._getNativeRange(),null==c?null:(d=this._positionToIndex(c.startContainer,c.startOffset),b=c.startContainer===c.endContainer&&c.startOffset===c.endOffset?d:this._positionToIndex(c.endContainer,c.endOffset),new f(Math.min(d,b),Math.max(d,b)))):a?this.range:null},a.prototype.preserve=function(a){var b,c,d,e,f,g,h,i,j;return d=this._getNativeRange(),null!=d&&this.checkFocus()?(e=this._encodePosition(d.startContainer,d.startOffset),i=e[0],j=e[1],f=this._encodePosition(d.endContainer,d.endOffset),b=f[0],c=f[1],a(),g=this._decodePosition(i,j),i=g[0],j=g[1],h=this._decodePosition(b,c),b=h[0],c=h[1],this._setNativeRange(i,j,b,c)):a()},a.prototype.setRange=function(a,b){var c,d,e,f,g,h,i;return null!=a?(e=this._indexToPosition(a.start),h=e[0],i=e[1],a.isCollapsed()?(f=[h,i],c=f[0],d=f[1]):(g=this._indexToPosition(a.end),c=g[0],d=g[1]),this._setNativeRange(h,i,c,d)):this._setNativeRange(null),this.update(b)},a.prototype.shiftAfter=function(a,b,c){var d;return d=this.getRange(),c(),null!=d?(d.shift(a,b),this.setRange(d,"silent")):void 0},a.prototype.update=function(a){var b,c,d,e;return c=this.checkFocus(),d=this.getRange(!0),b="silent"!==a&&(!f.compare(d,this.range)||c!==this.focus),e=c?d:null,null!==e||"user"!==a||this.nullDelay?(this.nullDelay=!1,this.range=d,this.focus=c,b?this.emitter.emit(this.emitter.constructor.events.SELECTION_CHANGE,e,a):void 0):this.nullDelay=!0},a.prototype._decodePosition=function(a,b){var c;return i(a).isElement()&&(c=i(a.parentNode).childNodes().indexOf(a),b+=c,a=a.parentNode),[a,b]},a.prototype._encodePosition=function(a,b){for(var c;;){if(i(a).isTextNode()||a.tagName===i.DEFAULT_BREAK_TAG||null!=i.EMBED_TAGS[a.tagName])return[a,b];if(b<a.childNodes.length)a=a.childNodes[b],b=0;else{if(0===a.childNodes.length)return null==this.doc.normalizer.whitelist.tags[a.tagName]&&(c=document.createTextNode(""),a.appendChild(c),a=c),[a,0];if(a=a.lastChild,!i(a).isElement())return[a,i(a).length()];if(a.tagName===i.DEFAULT_BREAK_TAG||null!=i.EMBED_TAGS[a.tagName])return[a,1];b=a.childNodes.length}}},a.prototype._getNativeRange=function(){var a,b;return b=document.getSelection(),(null!=b?b.rangeCount:void 0)>0&&(a=b.getRangeAt(0),i(a.startContainer).isAncestor(this.doc.root,!0)&&(a.startContainer===a.endContainer||i(a.endContainer).isAncestor(this.doc.root,!0)))?a:null},a.prototype._indexToPosition=function(a){var b,c,d;return 0===this.doc.lines.length?[this.doc.root,0]:(d=this.doc.findLeafAt(a,!0),b=d[0],c=d[1],this._decodePosition(b.node,c))},a.prototype._positionToIndex=function(a,b){var c,d,e,f,g,h;if(i.isIE(10)&&"BR"===a.tagName&&1===b&&(b=0),h=this._encodePosition(a,b),d=h[0],b=h[1],f=this.doc.findLine(d),null==f)return 0;for(c=f.findLeaf(d),g=0;null!=f.prev;)f=f.prev,g+=f.length;if(null==c)return g;for(e=0;null!=c.prev;)c=c.prev,e+=c.length;return g+e+b},a.prototype._setNativeRange=function(a,b,c,d){var e,f;if(f=document.getSelection())if(null!=a){if(this.checkFocus()||this.doc.root.focus(),e=this._getNativeRange(),null==e||a!==e.startContainer||b!==e.startOffset||c!==e.endContainer||d!==e.endOffset)return f.removeAllRanges(),e=document.createRange(),e.setStart(a,b),e.setEnd(c,d),f.addRange(e)}else if(f.removeAllRanges(),this.doc.root.blur(),i.isIE(11)&&!i.isIE(9))return document.body.focus()},a}(),b.exports=g},{"../lib/dom":18,"../lib/range":21,"./leaf":12,"./normalizer":14,lodash:1}],16:[function(a,b,c){a("./modules/authorship"),a("./modules/image-tooltip"),a("./modules/media-tooltip"),a("./modules/record-tooltip"),a("./modules/keyboard"),a("./modules/link-tooltip"),a("./modules/multi-cursor"),a("./modules/paste-manager"),a("./modules/toolbar"),a("./modules/tooltip"),a("./modules/undo-manager"),b.exports=a("./quill")},{"./modules/authorship":22,"./modules/image-tooltip":23,"./modules/keyboard":24,"./modules/link-tooltip":25,"./modules/media-tooltip":26,"./modules/multi-cursor":27,"./modules/paste-manager":28,"./modules/record-tooltip":29,"./modules/toolbar":30,"./modules/tooltip":31,"./modules/undo-manager":32,"./quill":33}],17:[function(a,b,c){var d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;f=a("./dom"),e=a("./picker"),d=function(a){function b(){b.__super__.constructor.apply(this,arguments),f(this.container).addClass("ql-color-picker")}return g(b,a),b.prototype.buildItem=function(a,c,d){var e;return e=b.__super__.buildItem.call(this,a,c,d),e.style.backgroundColor=c.value,e},b}(e),b.exports=d},{"./dom":18,"./picker":20}],18:[function(a,b,c){var d,e,f,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;f=a("lodash"),h=null,e=function(){function a(a){this.node=a,this.trigger=i(this.trigger,this)}return a.prototype.addClass=function(a){return this.hasClass(a)?void 0:(null!=this.node.classList?this.node.classList.add(a):null!=this.node.className&&(this.node.className=(this.node.className+" "+a).trim()),this)},a.prototype.attributes=function(a){var b,c,d,e,g,h;if(a)return f.each(a,function(a){return function(b,c){return a.node.setAttribute(c,b)}}(this)),this;if(null==this.node.attributes)return{};for(a={},g=this.node.attributes,c=d=0,e=g.length;e>d;c=++d)h=g[c],b=this.node.attributes[c],a[b.name]=b.value;return a},a.prototype.child=function(a){var b,c;for(b=this.node.firstChild,c=g(b).length();null!=b&&!(c>a);)a-=c,b=b.nextSibling,c=g(b).length();return null==b&&(b=this.node.lastChild,a=g(b).length()),[b,a]},a.prototype.childNodes=function(){return f.map(this.node.childNodes)},a.prototype.classes=function(){return this.node.className.split(/\s+/)},a.prototype.data=function(a,b){var c;return null!=b?(null==this.node["ql-data"]&&(this.node["ql-data"]={}),this.node["ql-data"][a]=b,this):null!=(c=this.node["ql-data"])?c[a]:void 0},a.prototype.descendants=function(){return f.map(this.node.getElementsByTagName("*"))},a.prototype.get=function(){return this.node},a.prototype.hasClass=function(a){return null!=this.node.classList?this.node.classList.contains(a):null!=this.node.className?this.classes().indexOf(a)>-1:!1},a.prototype.isAncestor=function(a,b){var c;if(null==b&&(b=!1),a===this.node)return b;for(c=this.node;c;){if(c===a)return!0;c=c.parentNode}return!1},a.prototype.isElement=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===g.ELEMENT_NODE},a.prototype.isTextNode=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===g.TEXT_NODE},a.prototype.isolate=function(a){return null!=this.node.nextSibling&&g(this.node.nextSibling).splitBefore(a),this.splitBefore(a),this},a.prototype.length=function(){var a;return null==this.node?0:(a=this.text().length,this.isElement()&&(a+=this.node.querySelectorAll(Object.keys(g.EMBED_TAGS).join(",")).length),a)},a.prototype.merge=function(a){var b;return b=g(a),this.isElement()?(b.moveChildren(this.node),this.normalize()):this.text(this.text()+b.text()),b.remove(),this},a.prototype.moveChildren=function(a){return f.each(this.childNodes(),function(b){return a.appendChild(b)}),this},a.prototype.nextLineNode=function(a){var b;return b=this.node.nextSibling,null==b&&this.node.parentNode!==a&&(b=this.node.parentNode.nextSibling),null!=b&&null!=g.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalize=function(){var a,b,c,d;for(b=this.node.firstChild;null!=b;)d=b.nextSibling,a=g(b),null!=d&&g(d).isTextNode()&&(0===a.text().length?a.remove():a.isTextNode()&&(c=d.nextSibling,a.merge(d),d=c)),b=d;return this},a.prototype.on=function(a,b){return this.node.addEventListener(a,function(c){return function(d){var e,f;return e=!h||"keydown"!==a&&"keyup"!==a?d:h,f=b.call(c.node,e),f||(d.preventDefault(),d.stopPropagation()),f}}(this)),this},a.prototype.remove=function(){var a;return null!=(a=this.node.parentNode)&&a.removeChild(this.node),this.node=null,null},a.prototype.removeClass=function(a){var b;if(this.hasClass(a))return null!=this.node.classList?this.node.classList.remove(a):null!=this.node.className&&(b=this.classes(),b.splice(b.indexOf(a),1),this.node.className=b.join(" ")),this.node.getAttribute("class")||this.node.removeAttribute("class"),this},a.prototype.replace=function(a){return this.node.parentNode.replaceChild(a,this.node),this.node=a,this},a.prototype.splitBefore=function(a,b){var c,d,e,f;if(null==b&&(b=!1),this.node===a||this.node.parentNode===a)return this;if(null!=this.node.previousSibling||b){for(e=this.node.parentNode,d=e.cloneNode(!1),e.parentNode.insertBefore(d,e.nextSibling),f=this.node;null!=f;)c=f.nextSibling,d.appendChild(f),f=c;return g(d).splitBefore(a)}return g(this.node.parentNode).splitBefore(a)},a.prototype.split=function(a,b){var c,d,e,f,h,i,j,k,l,m;if(null==b&&(b=!1),j=this.length(),a=Math.max(0,a),a=Math.min(a,j),!b&&0===a)return[this.node.previousSibling,this.node,!1];if(!b&&a===j)return[this.node,this.node.nextSibling,!1];if(this.node.nodeType===g.TEXT_NODE)return c=this.node.splitText(a),[this.node,c,!0];for(h=this.node,m=this.node.cloneNode(!1),this.node.parentNode.insertBefore(m,h.nextSibling),k=this.child(a),d=k[0],a=k[1],l=g(d).split(a),e=l[0],f=l[1];null!==f;)i=f.nextSibling,m.appendChild(f),f=i;return[h,m,!0]},a.prototype.styles=function(a,b){var c,d;return null==b&&(b=!1),a?(b||(a=f.defaults(a,this.styles())),d=f.map(a,function(a,b){return b+": "+a}).join("; ")+";",this.node.setAttribute("style",d),this):(d=this.node.getAttribute("style")||"",c=f.reduce(d.split(";"),function(a,b){var c,d,e;return d=b.split(":"),c=d[0],e=d[1],c&&e&&(c=c.trim(),e=e.trim(),a[c.toLowerCase()]=e),a},{}))},a.prototype.switchTag=function(a){var b,c;return a=a.toUpperCase(),this.node.tagName===a?this:(c=document.createElement(a),b=this.attributes(),null==g.VOID_TAGS[a]&&this.moveChildren(c),this.replace(c),this.node=c,this.attributes(b))},a.prototype.text=function(a){if(null!=a){switch(this.node.nodeType){case g.ELEMENT_NODE:this.node.textContent=a;break;case g.TEXT_NODE:this.node.data=a}return this}switch(this.node.nodeType){case g.ELEMENT_NODE:return this.node.tagName===g.DEFAULT_BREAK_TAG?"":null!=g.EMBED_TAGS[this.node.tagName]?g.EMBED_TEXT:null!=this.node.textContent?this.node.textContent:"";case g.TEXT_NODE:return this.node.data||"";default:return""}},a.prototype.textNodes=function(){var a,b,c;for(c=document.createTreeWalker(this.node,NodeFilter.SHOW_TEXT,null,!1),b=[];a=c.nextNode();)b.push(a);return b},a.prototype.toggleClass=function(a,b){return null==b&&(b=!this.hasClass(a)),b?this.addClass(a):this.removeClass(a),this},a.prototype.trigger=function(a,b){var c,d,e;return null==b&&(b={}),["keypress","keydown","keyup"].indexOf(a)<0?(c=document.createEvent("Event"),c.initEvent(a,b.bubbles,b.cancelable)):(c=document.createEvent("KeyboardEvent"),h=f.clone(b),f.isNumber(b.key)?h.which=b.key:f.isString(b.key)?h.which=b.key.toUpperCase().charCodeAt(0):h.which=0,g.isIE(10)?(e=[],b.altKey&&e.push("Alt"),b.ctrlKey&&e.push("Control"),b.metaKey&&e.push("Meta"),b.shiftKey&&e.push("Shift"),c.initKeyboardEvent(a,b.bubbles,b.cancelable,window,0,0,e.join(" "),null,null)):(d=f.isFunction(c.initKeyboardEvent)?"initKeyboardEvent":"initKeyEvent",c[d](a,b.bubbles,b.cancelable,window,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,0))),this.node.dispatchEvent(c),h=null,this},a.prototype.unwrap=function(){var a,b;return b=this.node.firstChild,a=this.node.nextSibling,f.each(this.childNodes(),function(b){return function(c){return b.node.parentNode.insertBefore(c,a)}}(this)),this.remove(),b},a.prototype.wrap=function(a){var b;for(null!=this.node.parentNode&&this.node.parentNode.insertBefore(a,this.node),b=a;null!=b.firstChild;)b=a.firstChild;return b.appendChild(this.node),this},a}(),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype["default"]=function(){return this.node.querySelector("option[selected]")},b.prototype.option=function(a,b){var c,d,e,g,h,i;if(null==b&&(b=!0),i=f.isElement(a)?a.value:a){for(i=i.replace(/[^\w]+/g,""),h=this.node.children,d=e=0,g=h.length;g>e;d=++e)if(c=h[d],c.value.replace(/[^\w]+/g,"")===i){this.node.selectedIndex=d;break}}else this.node.selectedIndex=-1;return b&&this.trigger("change"),this},b.prototype.reset=function(a){var b;return null==a&&(a=!0),b=this["default"](),null!=b?b.selected=!0:this.node.selectedIndex=0,a&&this.trigger("change"),this},b.prototype.value=function(){return this.node.selectedIndex>-1?this.node.options[this.node.selectedIndex].value:""},b}(e),g=function(a){return"SELECT"===(null!=a?a.tagName:void 0)?new d(a):new e(a)},g=f.extend(g,{ELEMENT_NODE:1,NOBREAK_SPACE:"&nbsp;",TEXT_NODE:3,ZERO_WIDTH_NOBREAK_SPACE:"\ufeff",DEFAULT_BLOCK_TAG:"DIV",DEFAULT_BREAK_TAG:"BR",DEFAULT_INLINE_TAG:"SPAN",EMBED_TEXT:"!",FONT_SIZES:{"10px":1,"13px":2,"16px":3,"18px":4,"24px":5,"32px":6,"48px":7},KEYS:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},BLOCK_TAGS:{ADDRESS:"ADDRESS",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",BLOCKQUOTE:"BLOCKQUOTE",CANVAS:"CANVAS",DD:"DD",DIV:"DIV",DL:"DL",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FOOTER:"FOOTER",FORM:"FORM",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEADER:"HEADER",HGROUP:"HGROUP",LI:"LI",OL:"OL",OUTPUT:"OUTPUT",P:"P",PRE:"PRE",SECTION:"SECTION",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TR:"TR",UL:"UL",VIDEO:"VIDEO"},EMBED_TAGS:{IMG:"IMG",IFRAME:"IFRAME"},LINE_TAGS:{DIV:"DIV",LI:"LI",IFRAME:"IFRAME"},LIST_TAGS:{OL:"OL",UL:"UL"},VOID_TAGS:{AREA:"AREA",BASE:"BASE",BR:"BR",COL:"COL",COMMAND:"COMMAND",EMBED:"EMBED",HR:"HR",IMG:"IMG",INPUT:"INPUT",KEYGEN:"KEYGEN",LINK:"LINK",META:"META",PARAM:"PARAM",SOURCE:"SOURCE",TRACK:"TRACK",WBR:"WBR"},convertFontSize:function(a){var b,c,d,e;f.isString(a)&&a.indexOf("px")>-1?(d=Object.keys(g.FONT_SIZES),e=f.values(g.FONT_SIZES)):(e=Object.keys(g.FONT_SIZES),d=f.values(g.FONT_SIZES));for(b in d)if(c=d[b],parseInt(a)<=parseInt(c))return e[b];return f.last(e)},isIE:function(a){var b;return b=document.documentMode,b&&a>=b},isIOS:function(){return/iPhone|iPad/i.test(navigator.userAgent)},isMac:function(){return/Mac/i.test(navigator.platform)}}),b.exports=g},{lodash:1}],19:[function(a,b,c){var d,e;e=function(){function a(a){this.data=a,this.prev=this.next=null}return a}(),d=function(){function a(){this.length=0,this.first=this.last=null}return a.Node=e,a.prototype.append=function(a){return null!=this.first?(a.next=null,this.last.next=a):this.first=a,a.prev=this.last,this.last=a,this.length+=1},a.prototype.insertAfter=function(a,b){return b.prev=a,null!=a?(b.next=a.next,null!=a.next&&(a.next.prev=b),a.next=b,a===this.last&&(this.last=b)):(b.next=this.first,this.first.prev=b,this.first=b),this.length+=1},a.prototype.remove=function(a){return this.length>1?(null!=a.prev&&(a.prev.next=a.next),null!=a.next&&(a.next.prev=a.prev),a===this.first&&(this.first=a.next),a===this.last&&(this.last=a.prev)):this.first=this.last=null,a.prev=a.next=null,this.length-=1},a.prototype.toArray=function(){var a,b;for(a=[],b=this.first;null!=b;)a.push(b),b=b.next;return a},a}(),b.exports=d},{}],20:[function(a,b,c){var d,e,f;e=a("lodash"),f=a("./dom"),d=function(){function a(a){this.select=a,this.container=document.createElement("span"),this.buildPicker(),f(this.container).addClass("ql-picker"),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),f(document).on("click",function(a){return function(){return a.close(),!0}}(this)),f(this.label).on("click",function(a){return function(){return e.defer(function(){return f(a.container).toggleClass("ql-expanded")}),!1}}(this)),f(this.select).on("change",function(a){return function(){var b,c;return a.select.selectedIndex>-1&&(b=a.container.querySelectorAll(".ql-picker-item")[a.select.selectedIndex],c=a.select.options[a.select.selectedIndex]),a.selectItem(b,!1),f(a.label).toggleClass("ql-active",c!==f(a.select)["default"]())}}(this))}return a.TEMPLATE='<span class="ql-picker-label"></span><span class="ql-picker-options"></span>',a.prototype.buildItem=function(a,b,c){var d;return d=document.createElement("span"),d.setAttribute("data-value",b.getAttribute("value")),f(d).addClass("ql-picker-item").text(f(b).text()).on("click",function(a){return function(){return a.selectItem(d,!0),a.close()}}(this)),this.select.selectedIndex===c&&this.selectItem(d,!1),d},a.prototype.buildPicker=function(){var b;return e.each(f(this.select).attributes(),function(a){return function(b,c){return a.container.setAttribute(c,b)}}(this)),this.container.innerHTML=a.TEMPLATE,this.label=this.container.querySelector(".ql-picker-label"),b=this.container.querySelector(".ql-picker-options"),e.each(this.select.options,function(a){return function(c,d){var e;return e=a.buildItem(b,c,d),b.appendChild(e)}}(this))},a.prototype.close=function(){return f(this.container).removeClass("ql-expanded")},a.prototype.selectItem=function(a,b){var c,d;return c=this.container.querySelector(".ql-selected"),null!=c&&f(c).removeClass("ql-selected"),null!=a?(d=a.getAttribute("data-value"),f(a).addClass("ql-selected"),f(this.label).text(f(a).text()),f(this.select).option(d,b),this.label.setAttribute("data-value",d)):(this.label.innerHTML="&nbsp;",this.label.removeAttribute("data-value"))},a}(),b.exports=d},{"./dom":18,lodash:1}],21:[function(a,b,c){var d,e;e=a("lodash"),d=function(){function a(a,b){this.start=a,this.end=b}return a.compare=function(a,b){return a===b?!0:null==a||null==b?!1:a.equals(b)},a.prototype.equals=function(a){return null==a?!1:this.start===a.start&&this.end===a.end},a.prototype.shift=function(a,b){var c;return c=e.map([this.start,this.end],function(c){return a>c?c:b>=0?c+b:Math.max(a,c+b)}),this.start=c[0],this.end=c[1],c},a.prototype.isCollapsed=function(){return this.start===this.end},a}(),b.exports=d},{lodash:1}],22:[function(a,b,c){var d,e,f,g,h;f=a("../quill"),g=f.require("lodash"),h=f.require("dom"),e=f.require("delta"),d=function(){function a(a,b){this.quill=a,this.options=b,null!=this.options.button&&this.attachButton(this.options.button),this.options.enabled&&this.enable(),this.quill.addFormat("author",{"class":"author-"}),null!=this.options.authorId&&(this.quill.on(this.quill.constructor.events.PRE_EVENT,function(a){return function(b,c,d){var h,i;return b===a.quill.constructor.events.TEXT_CHANGE&&"user"===d?(h=new e,i={author:a.options.authorId},g.each(c.ops,function(b){return null==b["delete"]?null!=b.insert||null!=b.retain&&null!=b.attributes?(b.attributes||(b.attributes={}),b.attributes.author=a.options.authorId,h.retain(b.retain||b.insert.length||1,i)):h.retain(b.retain):void 0}),a.quill.updateContents(h,f.sources.SILENT)):void 0}}(this)),this.addAuthor(this.options.authorId,this.options.color))}return a.DEFAULTS={authorId:null,color:"transparent",enabled:!1},a.prototype.addAuthor=function(a,b){var c;return c={},c[".authorship .author-"+a]={"background-color":""+b},this.quill.theme.addStyles(c)},a.prototype.attachButton=function(a){var b;return b=h(a),b.on("click",function(a){return function(){return b.toggleClass("ql-on"),a.enable($dom.hasClass("ql-on"))}}(this))},a.prototype.enable=function(a){return null==a&&(a=!0),h(this.quill.root).toggleClass("authorship",a)},a.prototype.disable=function(){return this.enable(!1)},a}(),f.registerModule("authorship",d),b.exports=d},{"../quill":33}],23:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;f=a("../quill"),h=a("./tooltip"),i=f.require("lodash"),j=f.require("dom"),d=f.require("delta"),g=f.require("range"),e=function(a){function b(a,c){this.quill=a,this.options=c,this.options=i.defaults(this.options,h.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),this.preview=this.container.querySelector(".preview"),this.textbox=this.container.querySelector(".input"),j(this.container).addClass("ql-image-tooltip"),this.initListeners()}return k(b,a),b.DEFAULTS={template:'<input class="input" type="textbox"> <div class="preview"> <span>Preview</span> </div> <a href="javascript:;" class="cancel">Cancel</a> <a href="javascript:;" class="insert">Insert</a>'},b.prototype.initListeners=function(){return j(this.quill.root).on("focus",i.bind(this.hide,this)),j(this.container.querySelector(".insert")).on("click",i.bind(this.insertImage,this)),j(this.container.querySelector(".cancel")).on("click",i.bind(this.hide,this)),j(this.textbox).on("input",i.bind(this._preview,this)),this.initTextbox(this.textbox,this.insertImage,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("image",i.bind(a._onToolbar,a))}}(this))},b.prototype.insertImage=function(){var a,b;return b=this._normalizeURL(this.textbox.value),null==this.range&&(this.range=new g(0,0)),this.range&&(this.preview.innerHTML="<span>Preview</span>",this.textbox.value="",a=this.range.end,this.quill.insertEmbed(a,"image",b,"user"),this.quill.setSelection(a+1,a+1)),this.hide()},b.prototype._onToolbar=function(a,b){return b?(this.textbox.value||(this.textbox.value="http://"),this.show(),this.textbox.focus(),i.defer(function(a){return function(){return a.textbox.setSelectionRange(a.textbox.value.length,a.textbox.value.length)}}(this))):(this.quill.deleteText(a,"user"),this.toolbar.setActive("image",!1))},b.prototype._preview=function(){var a;if(this._matchImageURL(this.textbox.value))return"IMG"===this.preview.firstChild.tagName?this.preview.firstChild.setAttribute("src",this.textbox.value):(a=document.createElement("img"),a.setAttribute("src",this.textbox.value),this.preview.replaceChild(a,this.preview.firstChild))},b.prototype._matchImageURL=function(a){return/^https?:\/\/.+\.(jpe?g|gif|png)$/.test(a)},b.prototype._normalizeURL=function(a){return/^https?:\/\//.test(a)||(a="http://"+a),a},b}(h),f.registerModule("image-tooltip",e),b.exports=e},{"../quill":33,"./tooltip":31}],24:[function(a,b,c){var d,e,f,g,h;f=a("../quill"),g=f.require("lodash"),h=f.require("dom"),d=f.require("delta"),e=function(){function a(a,b){this.quill=a,this.hotkeys={},this._initListeners(),this._initHotkeys(),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b}}(this))}return a.hotkeys={BOLD:{key:"B",metaKey:!0},INDENT:{key:h.KEYS.TAB},ITALIC:{key:"I",metaKey:!0},OUTDENT:{key:h.KEYS.TAB,shiftKey:!0},UNDERLINE:{key:"U",metaKey:!0}},a.prototype.addHotkey=function(a,b){return Array.isArray(a)||(a=[a]),g.each(a,function(a){return function(c){var d,e;return c=g.isObject(c)?g.clone(c):{key:c},c.callback=b,e=g.isNumber(c.key)?c.key:c.key.toUpperCase().charCodeAt(0),null==(d=a.hotkeys)[e]&&(d[e]=[]),a.hotkeys[e].push(c)}}(this))},a.prototype.toggleFormat=function(a,b){var c,d;return c=a.isCollapsed()?this.quill.getContents(Math.max(0,a.start-1),a.end):this.quill.getContents(a),d=0===c.ops.length||!g.all(c.ops,function(a){var c;return null!=(c=a.attributes)?c[b]:void 0}),a.isCollapsed()?this.quill.prepareFormat(b,d,f.sources.USER):this.quill.formatText(a,b,d,f.sources.USER),null!=this.toolbar?this.toolbar.setActive(b,d):void 0},a.prototype._initEnter=function(){var a;return a=[{key:h.KEYS.ENTER},{key:h.KEYS.ENTER,shiftKey:!0}],this.addHotkey(a,function(a){return function(b,c){var e,h,i,j,k,l;return null==b?!0:(k=a.quill.editor.doc.findLineAt(b.start),i=k[0],j=k[1],l=i.findLeafAt(j),h=l[0],j=l[1],e=(new d).retain(b.start).insert("\n",i.formats)["delete"](b.end-b.start),a.quill.updateContents(e,f.sources.USER),g.each(h.formats,function(b,c){a.quill.prepareFormat(c,b),null!=a.toolbar&&a.toolbar.setActive(c,b)}),!1)}}(this))},a.prototype._initDeletes=function(){return this.addHotkey([h.KEYS.DELETE,h.KEYS.BACKSPACE],function(a){return function(b,c){var d,e,g,i;return null!=b&&a.quill.getLength()>0&&(b.start!==b.end?a.quill.deleteText(b.start,b.end,f.sources.USER):c.key===h.KEYS.BACKSPACE?(i=a.quill.editor.doc.findLineAt(b.start),e=i[0],g=i[1],0===g&&(e.formats.bullet||e.formats.list)?(d=e.formats.bullet?"bullet":"list",a.quill.formatLine(b.start,b.start,d,!1)):b.start>0&&a.quill.deleteText(b.start-1,b.start,f.sources.USER)):b.start<a.quill.getLength()-1&&a.quill.deleteText(b.start,b.start+1,f.sources.USER)),!1}}(this))},a.prototype._initHotkeys=function(){return this.addHotkey(a.hotkeys.INDENT,function(a){
return function(b){return a._onTab(b,!1),!1}}(this)),this.addHotkey(a.hotkeys.OUTDENT,function(a){return function(a){return!1}}(this)),g.each(["bold","italic","underline"],function(b){return function(c){return b.addHotkey(a.hotkeys[c.toUpperCase()],function(a){return b.quill.editor.doc.formats[c]&&b.toggleFormat(a,c),!1})}}(this)),this._initDeletes(),this._initEnter()},a.prototype._initListeners=function(){return h(this.quill.root).on("keydown",function(a){return function(b){var c;return c=!1,g.each(a.hotkeys[b.which],function(d){var e;return e=h.isMac()?b.metaKey:b.metaKey||b.ctrlKey,!!d.metaKey==!!e&&!!d.shiftKey==!!b.shiftKey&&!!d.altKey==!!b.altKey?(c=d.callback(a.quill.getSelection(),d,b)===!1||c,!0):void 0}),!c}}(this))},a.prototype._onTab=function(a,b){var c;return null==b&&(b=!1),c=(new d).retain(a.start).insert("	")["delete"](a.end-a.start).retain(this.quill.getLength()-a.end),this.quill.updateContents(c,f.sources.USER),this.quill.setSelection(a.start+1,a.start+1)},a}(),f.registerModule("keyboard",e),b.exports=e},{"../quill":33}],25:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;e=a("../quill"),f=a("./tooltip"),g=e.require("lodash"),h=e.require("dom"),d=function(a){function b(a,c){this.quill=a,this.options=c,this.options=g.defaults(this.options,f.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),h(this.container).addClass("ql-link-tooltip"),this.textbox=this.container.querySelector(".input"),this.link=this.container.querySelector(".url"),this.initListeners()}return i(b,a),b.DEFAULTS={maxLength:50,template:'<span class="title">Visit URL:&nbsp;</span> <a href="#" class="url" target="_blank" href="about:blank"></a> <input class="input" type="text"> <span>&nbsp;&#45;&nbsp;</span> <a href="javascript:;" class="change">Change</a> <a href="javascript:;" class="remove">Remove</a> <a href="javascript:;" class="done">Done</a>'},b.hotkeys={LINK:{key:"K",metaKey:!0}},b.prototype.initListeners=function(){return this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){var c;if(null!=b&&b.isCollapsed())return c=a._findAnchor(b),c?(a.setMode(c.href,!1),a.show(c)):a.container.style.left!==f.HIDE_MARGIN?(a.range=null,a.hide()):void 0}}(this)),h(this.container.querySelector(".done")).on("click",g.bind(this.saveLink,this)),h(this.container.querySelector(".remove")).on("click",function(a){return function(){return a.removeLink(a.range)}}(this)),h(this.container.querySelector(".change")).on("click",function(a){return function(){return a.setMode(a.link.href,!0)}}(this)),this.initTextbox(this.textbox,this.saveLink,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("link",g.bind(a._onToolbar,a))}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(c){return c.addHotkey(b.hotkeys.LINK,g.bind(a._onKeyboard,a))}}(this))},b.prototype.saveLink=function(){var a,b,c;return c=this._normalizeURL(this.textbox.value),null!=this.range&&(b=this.range.end,this.range.isCollapsed()?(a=this._findAnchor(this.range),null!=a&&(a.href=c)):this.quill.formatText(this.range,"link",c,"user"),this.quill.setSelection(b,b)),this.setMode(c,!1)},b.prototype.removeLink=function(a){return a.isCollapsed()&&(a=this._expandRange(a)),this.hide(),this.quill.formatText(a,"link",!1,"user"),null!=this.toolbar?this.toolbar.setActive("link",!1):void 0},b.prototype.setMode=function(a,b){var c;return null==b&&(b=!1),b?(this.textbox.value=a,g.defer(function(b){return function(){return b.textbox.focus(),b.textbox.setSelectionRange(0,a.length)}}(this))):(this.link.href=a,a=this.link.href,c=a.length>this.options.maxLength?a.slice(0,this.options.maxLength)+"...":a,h(this.link).text(c)),h(this.container).toggleClass("editing",b)},b.prototype._findAnchor=function(a){var b,c,d,e;for(e=this.quill.editor.doc.findLeafAt(a.start,!0),b=e[0],d=e[1],null!=b&&(c=b.node);null!=c&&c!==this.quill.root;){if("A"===c.tagName)return c;c=c.parentNode}return null},b.prototype._expandRange=function(a){var b,c,d,e,f;return e=this.quill.editor.doc.findLeafAt(a.start,!0),c=e[0],d=e[1],f=a.start-d,b=f+c.length,{start:f,end:b}},b.prototype._onToolbar=function(a,b){return this._toggle(a,b)},b.prototype._onKeyboard=function(){var a;return a=this.quill.getSelection(),this._toggle(a,!this._findAnchor(a))},b.prototype._toggle=function(a,b){var c;if(a)return b?a.isCollapsed()?void 0:(this.setMode(this._suggestURL(a),!0),c=this.quill.editor.selection._getNativeRange(),this.show(c)):this.removeLink(a)},b.prototype._normalizeURL=function(a){return/^(https?:\/\/|mailto:)/.test(a)||(a="http://"+a),a},b.prototype._suggestURL=function(a){var b;return b=this.quill.getText(a),this._normalizeURL(b)},b}(f),e.registerModule("link-tooltip",d),b.exports=d},{"../quill":33,"./tooltip":31}],26:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;f=a("../quill"),h=a("./tooltip"),i=f.require("lodash"),j=f.require("dom"),d=f.require("delta"),g=f.require("range"),e=function(a){function b(a,c){this.quill=a,this.options=c,this.options=i.defaults(this.options,h.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),this.preview=this.container.querySelector(".preview"),this.textbox=this.container.querySelector(".input"),j(this.container).addClass("ql-media-tooltip"),this.request=new XMLHttpRequest,this.embedUrl=null,this.initListeners()}return k(b,a),b.DEFAULTS={template:'<input class="input" type="textbox"> <div class="preview"> <span>Preview</span> </div> <a href="javascript:;" class="cancel">Cancel</a> <a href="javascript:;" class="insert">Insert</a>'},b.NOEMBED_URL="//noembed.com/embed",b.prototype.initListeners=function(){return j(this.container.querySelector(".insert")).on("click",i.bind(this.insertVideo,this)),j(this.container.querySelector(".cancel")).on("click",i.bind(this.hide,this)),j(this.textbox).on("input",i.bind(this._getOEmbed,this)),this.initTextbox(this.textbox,this.insertVideo,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return b.initFormat("media",i.bind(a._onToolbar,a))}}(this))},b.prototype.insertVideo=function(){var a;if(this.embedUrl)return null==this.range&&(this.range=new g(0,0)),this.range&&(this.preview.innerHTML="<span>Preview</span>",this.textbox.value="",a=this.range.end,this.quill.insertEmbed(a,"media",this.embedUrl,"user"),this.quill.setSelection(a+1,a+1)),this.embedUrl=null,this.hide()},b.prototype._onToolbar=function(a,b){return b?(this.textbox.value||(this.textbox.value="http://"),this.show(),this.textbox.focus(),i.defer(function(a){return function(){return a.textbox.setSelectionRange(a.textbox.value.length,a.textbox.value.length)}}(this))):this.quill.deleteText(a,"user")},b.prototype._preview=function(){var a;if(this.embedUrl)return"IFRAME"===this.preview.firstChild.tagName?this.preview.firstChild.setAttribute("src",this.embedUrl):(a=document.createElement("iframe"),a.setAttribute("src",this.embedUrl),a.setAttribute("frameborder","0"),this.preview.replaceChild(a,this.preview.firstChild))},b.prototype._normalizeURL=function(a){return/^https?:\/\//.test(a)||(a="http://"+a),a},b.prototype._getOEmbed=function(){var a;return a=this._normalizeURL(this.textbox.value),a=window.encodeURIComponent(a),this.request.abort(),this.request.open("GET",b.NOEMBED_URL+"?url="+a,!0),this.request.onreadystatechange=function(a){return function(b){var c;if(4===a.request.readyState&&200===a.request.status)try{return c=JSON.parse(a.request.responseText),a.embedUrl=a._getEmbedUrlFromHTML(c.html||""),a._preview()}catch(d){}}}(this),this.request.send(null)},b.prototype._getEmbedUrlFromHTML=function(a){var b,c;return b=/<iframe.*src="([^"']*)".*>.*<\/iframe>/g,c=b.exec(a),c[1]},b}(h),f.registerModule("media-tooltip",e),b.exports=e},{"../quill":33,"./tooltip":31}],27:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;f=a("../quill"),d=a("eventemitter2").EventEmitter2,g=f.require("lodash"),h=f.require("dom"),e=function(a){function b(a,b){this.quill=a,this.options=b,this.cursors={},this.container=this.quill.addContainer("ql-multi-cursor",!0),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,g.bind(this._applyDelta,this))}return i(b,a),b.DEFAULTS={template:'<span class="cursor-flag"> <span class="cursor-name"></span> </span> <span class="cursor-caret"></span>',timeout:2500},b.events={CURSOR_ADDED:"cursor-addded",CURSOR_MOVED:"cursor-moved",CURSOR_REMOVED:"cursor-removed"},b.prototype.clearCursors=function(){return g.each(Object.keys(this.cursors),g.bind(this.removeCursor,this)),this.cursors={}},b.prototype.moveCursor=function(a,b){var c;return c=this.cursors[a],c.index=b,h(c.elem).removeClass("hidden"),clearTimeout(c.timer),c.timer=setTimeout(function(a){return function(){return h(c.elem).addClass("hidden"),c.timer=null}}(this),this.options.timeout),this._updateCursor(c),c},b.prototype.removeCursor=function(a){var c;return c=this.cursors[a],this.emit(b.events.CURSOR_REMOVED,c),null!=c&&c.elem.parentNode.removeChild(c.elem),delete this.cursors[a]},b.prototype.setCursor=function(a,c,d,e){var f;return null==this.cursors[a]&&(this.cursors[a]=f={userId:a,index:c,color:e,elem:this._buildCursor(d,e)},this.emit(b.events.CURSOR_ADDED,f)),g.defer(function(b){return function(){return b.moveCursor(a,c)}}(this)),this.cursors[a]},b.prototype.shiftCursors=function(a,b,c){return null==c&&(c=null),g.each(this.cursors,function(d){return function(e,f){var g;if(e)return g=Math.max(b,a-e.index),e.userId===c?d.moveCursor(c,e.index+g):e.index>a?e.index+=g:void 0}}(this))},b.prototype.update=function(){return g.each(this.cursors,function(a){return function(b,c){return null!=b?(a._updateCursor(b),!0):void 0}}(this))},b.prototype._applyDelta=function(a){var b;return b=0,g.each(a.ops,function(a){return function(c){var d,e;return d=0,null!=c.insert?(d=c.insert.length||1,a.shiftCursors(b,d,null!=(e=c.attributes)?e.author:void 0)):null!=c["delete"]?a.shiftCursors(b,-1*c["delete"],null):null!=c.retain&&(a.shiftCursors(b,0,null),d=c.retain),b+=d}}(this)),this.update()},b.prototype._buildCursor=function(a,b){var c,d,e,f;return c=document.createElement("span"),h(c).addClass("cursor"),c.innerHTML=this.options.template,e=c.querySelector(".cursor-flag"),f=c.querySelector(".cursor-name"),h(f).text(a),d=c.querySelector(".cursor-caret"),d.style.backgroundColor=f.style.backgroundColor=b,this.container.appendChild(c),c},b.prototype._updateCursor=function(a){var c,d;return c=this.quill.getBounds(a.index),null==c?this.removeCursor(a.userId):(a.elem.style.top=c.top+this.quill.container.scrollTop+"px",a.elem.style.left=c.left+"px",a.elem.style.height=c.height+"px",d=a.elem.querySelector(".cursor-flag"),h(a.elem).toggleClass("top",parseInt(a.elem.style.top)<=d.offsetHeight).toggleClass("left",parseInt(a.elem.style.left)<=d.offsetWidth).toggleClass("right",this.quill.root.offsetWidth-parseInt(a.elem.style.left)<=d.offsetWidth),this.emit(b.events.CURSOR_MOVED,a))},b}(d),f.registerModule("multi-cursor",e),b.exports=e},{"../quill":33,eventemitter2:3}],28:[function(a,b,c){var d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};g=a("../quill"),e=a("../core/document"),h=g.require("lodash"),i=g.require("dom"),d=g.require("delta"),f=function(){function a(b,c){var d;this.quill=b,this._onConvert=j(this._onConvert,this),this.container=this.quill.addContainer("ql-paste-manager"),this.container.setAttribute("contenteditable",!0),this.container.setAttribute("tabindex","-1"),i(this.quill.root).on("paste",h.bind(this._paste,this)),this.options=h.defaults(c,a.DEFAULTS),null==(d=this.options).onConvert&&(d.onConvert=this._onConvert)}return a.DEFAULTS={onConvert:null},a.prototype._onConvert=function(a){var b,c,f;return c=new e(a,this.quill.options),b=c.toDelta(),f=b.length(),0===f?b:b.compose((new d).retain(f-1)["delete"](1))},a.prototype._paste=function(){var a,b;return a=this.quill.getLength(),b=this.quill.getSelection(),null!=b?(this.container.focus(),h.defer(function(a){return function(){var c,d,e,f,g,h,i;return c=a.options.onConvert(a.container),d=c.length(),d>0&&(b.start>0&&c.ops.unshift({retain:b.start}),c["delete"](b.end-b.start),a.quill.updateContents(c,"user")),a.quill.setSelection(b.start+d,b.start+d),h=a.quill.editor.doc.findLineAt(b.start+d),e=h[0],g=h[1],f=e.node.getBoundingClientRect().bottom,i=document.documentElement.clientHeight,f>i&&e.node.scrollIntoView(!1),a.container.innerHTML=""}}(this))):void 0},a}(),g.registerModule("paste-manager",f),b.exports=f},{"../core/document":9,"../quill":33}],29:[function(a,b,c){var d,e,f,g,h,i,j,k,l=function(a,b){return function(){return a.apply(b,arguments)}},m=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n={}.hasOwnProperty;f=a("../quill"),i=a("./tooltip"),e=a("../../bower_components/microm/dist/microm"),j=f.require("lodash"),k=f.require("dom"),d=f.require("delta"),g=f.require("range"),h=function(a){function b(a,c){this.quill=a,this.options=c,this.updateCurrentTime=l(this.updateCurrentTime,this),this.options=j.defaults(this.options,i.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),this.timer=this.container.querySelector(".record-time-counter"),this.is_record=!1,k(this.container).addClass("ql-record-tooltip"),this.microm||(this.microm=new e),this.initListeners()}return m(b,a),b.DEFAULTS={template:'<div  class="record-tooltip-player"> <div class="record-tooltip-player-controls"> <div class="record-tooltip-player-micro"> <i class="fa fa-microphone-slash record-micro"></i> </div> <div class="box"> <input type="file" name="file-5[]" id="file-5" class="inputfile inputfile-4" data-multiple-caption="{count} files selected" accept="audio/*"/> <label for="file-5"> <figure> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17"> <path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"/> </svg> </figure> </label> </div> </div> <div class="record-controls"> <a role="button" class="record-play fa fa-play"></a> <a role="button" class="record-delete fa fa-remove"></a> </div> <div class="record-time-counter">00:00:00</div> </div> <a href="javascript:;" class="cancel">Cancel</a> <a href="javascript:;" class="insert">Insert</a>'},b.prototype.initListeners=function(){return this.initJs(),this.quill.on("record_data_register",j.bind(this.moduleResult,this)),k(this.container.querySelector(".insert")).on("click",j.bind(this.sendBlob,this)),k(this.container.querySelector(".cancel")).on("click",j.bind(this.hide,this)),k(this.container.querySelector(".record-play")).on("click",j.bind(this.play,this)),k(this.container.querySelector(".record-delete")).on("click",j.bind(this["delete"],this)),k(this.container.querySelector(".record-micro")).on("click",j.bind(this.start,this)),this.quill.onModuleLoad("toolbar",function(a){return function(b){return b.initFormat("record",j.bind(a._onToolbar,a))}}(this))},b.prototype.startRecording=function(){return this.deleteError(),this.microm.record().then(function(a){return function(){return a.is_record=!0,a.quill.emit("record_voice","record start"),setTimeout(a.updateCurrentTime,1e3)}}(this))["catch"](function(a){return function(){return a.quill.emit("record_voice","record error")}}(this))},b.prototype.stopRecording=function(){return this.is_record=!1,this.microm.stop().then(function(a){return function(b){return a.quill.emit("record_voice","record stop")}}(this))},b.prototype.sendBlob=function(){return this.microm.getMp3().then(function(a){return function(b){var c;return k(a.container.querySelector(".record-tooltip-player")).addClass("record-data-sending"),c={audio:b.blob,type:"wav"},a.quill.emit("record_data",b.blob),a.hide()}}(this))},b.prototype.moduleResult=function(a){return k(this.container.querySelector(".record-tooltip-player")).removeClass("record-data-sending"),"error"===a?k(this.container.querySelector(".record-tooltip-player")).addClass("record-data-sending-error"):this.hide()},b.prototype.play=function(){return this.microm.player?this.microm.play():void 0},b.prototype.hide=function(){return this.resetTimer(),this.deleteError(),b.__super__.hide.apply(this,arguments)},b.prototype.generateKey=function(){var a,b;return a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c,d;return c=(a+16*Math.random())%16|0,a=Math.floor(a/16),(null!=(d="x"===b)?d:{r:3&c|8}).toString(16)})},b.prototype.updateCurrentTime=function(){var a,b,c,d,e;return this.is_record&&(c=this.timer.innerText,d=c.split(":"),a=new Date,a.setHours(d[0]),a.setMinutes(d[1]),a.setSeconds(d[2]),b=new Date(a.valueOf()+1e3),e=b.toTimeString().split(" ")[0],this.timer.innerText=e),this.is_record?setTimeout(this.updateCurrentTime,1e3):void 0},b.prototype.start=function(){return k(this.container.querySelector(".record-micro")).hasClass("start-animation")?(k(this.container.querySelector(".record-micro")).removeClass("start-animation"),this.container.querySelector(".record-play").style.display="inline",this.container.querySelector(".record-delete").style.display="inline",this.stopRecording()):(k(this.container.querySelector(".record-micro")).addClass("start-animation"),this.container.querySelector(".record-play").style.display="none",this.container.querySelector(".record-delete").style.display="none",this.startRecording())},b.prototype["delete"]=function(){return this.microm=new e,this.resetTimer()},b.prototype.resetTimer=function(){return this.timer?this.timer.innerText="00:00:00":void 0},b.prototype.deleteError=function(){return k(this.container.querySelector(".record-tooltip-player")).hasClass("record-data-sending-error")?k(this.container.querySelector(".record-tooltip-player")).removeClass("record-data-sending-error"):void 0},b.prototype._onToolbar=function(a,b){return this.show()},b.prototype.initJs=function(){var a,b,c,d,e,f,g;for(c=document.querySelectorAll(".inputfile"),g=[],a=0,f=c.length;f>a;a++)b=c[a],d=b.nextElementSibling,e=d.innerHTML,b.addEventListener("change",function(a){return function(b){var c;return c=new FileReader,c.onload=function(){var d,e,f;return f=c.result,e=b.target.value.split("\\").pop(),d={audio:f,type:filename.split(".").pop()},a.quill.emit("record_data",d)},c.readAsBinaryString(b.target.files[0])}}(this)),b.addEventListener("focus",function(a){return b.classList.add("has-focus")}),g.push(b.addEventListener("blur",function(a){return b.classList.remove("has-focus")}));return g},b}(i),f.registerModule("record-tooltip",h),b.exports=h},{"../../bower_components/microm/dist/microm":2,"../quill":33,"./tooltip":31}],30:[function(a,b,c){var d,e,f,g;d=a("../quill"),f=d.require("lodash"),g=d.require("dom"),e=function(){function a(b,c){if(this.quill=b,this.options=c,(f.isString(this.options)||f.isElement(this.options))&&(this.options={container:this.options}),null==this.options.container)throw new Error("container required for toolbar",this.options);this.container=f.isString(this.options.container)?document.querySelector(this.options.container):this.options.container,this.inputs={},this.preventUpdate=!1,this.triggering=!1,f.each(this.quill.options.formats,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,f.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(d.events.FORMAT_INIT,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,f.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(d.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?a.updateActive(b):void 0}}(this)),this.quill.on(d.events.TEXT_CHANGE,function(a){return function(){return a.updateActive()}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(b){return b.addHotkey([g.KEYS.BACKSPACE,g.KEYS.DELETE],function(){return f.defer(f.bind(a.updateActive,a))})}}(this)),g(this.container).addClass("ql-toolbar"),g.isIOS()&&g(this.container).addClass("ios")}return a.DEFAULTS={container:null},a.formats={LINE:{align:"align",bullet:"bullet",list:"list"},SELECT:{align:"align",background:"background",color:"color",font:"font",size:"size"},TOGGLE:{bold:"bold",bullet:"bullet",image:"image",italic:"italic",link:"link",list:"list",strike:"strike",underline:"underline",media:"media",record:"record"},TOOLTIP:{image:"image",link:"link",media:"media",record:"record"}},a.prototype.initFormat=function(b,c){var d,e,f;return f=".ql-"+b,null!=a.formats.SELECT[b]?(f="select"+f,d="change"):d="click",e=this.container.querySelector(f),null!=e?(this.inputs[b]=e,g(e).on(d,function(a){return function(){var b,f;return f="change"===d?g(e).value():!g(e).hasClass("ql-active"),a.preventUpdate=!0,a.quill.focus(),b=a.quill.getSelection(),null!=b&&c(b,f),a.preventUpdate=!1,!0}}(this))):void 0},a.prototype.setActive=function(a,b){var c,d,e,f;return"image"===a&&(b=!1),d=this.inputs[a],null!=d?(c=g(d),"SELECT"===d.tagName?(this.triggering=!0,f=c.value(d),null==b&&(b=null!=(e=c["default"]())?e.value:void 0),Array.isArray(b)&&(b=""),b!==f&&(null!=b?c.option(b):c.reset()),this.triggering=!1):c.toggleClass("ql-active",b||!1)):void 0},a.prototype.updateActive=function(a,b){var c;return null==b&&(b=null),a||(a=this.quill.getSelection()),null==a||this.preventUpdate?void 0:(c=this._getActive(a),f.each(this.inputs,function(a){return function(d,e){return(!Array.isArray(b)||b.indexOf(e)>-1)&&a.setActive(e,c[e]),!0}}(this)))},a.prototype._applyFormat=function(b,c,d){return this.triggering?void 0:(c.isCollapsed()?this.quill.prepareFormat(b,d,"user"):null!=a.formats.LINE[b]?this.quill.formatLine(c,b,d,"user"):this.quill.formatText(c,b,d,"user"),f.defer(function(a){return function(){return a.updateActive(c,["bullet","list"]),a.setActive(b,d)}}(this)))},a.prototype._getActive=function(a){var b,c;return b=this._getLeafActive(a),c=this._getLineActive(a),f.defaults({},b,c)},a.prototype._getLeafActive=function(a){var b,c,d,e,g;return a.isCollapsed()?(g=this.quill.editor.doc.findLineAt(a.start),d=g[0],e=g[1],b=0===e?this.quill.getContents(a.start,a.end+1):this.quill.getContents(a.start-1,a.end)):b=this.quill.getContents(a),c=f.map(b.ops,"attributes"),this._intersectFormats(c)},a.prototype._getLineActive=function(a){var b,c,d,e,g,h;for(c=[],g=this.quill.editor.doc.findLineAt(a.start),b=g[0],e=g[1],h=this.quill.editor.doc.findLineAt(a.end),d=h[0],e=h[1],null!=d&&d===b&&(d=d.next);null!=b&&b!==d;)c.push(f.clone(b.formats)),b=b.next;return this._intersectFormats(c)},a.prototype._intersectFormats=function(b){return f.reduce(b.slice(1),function(b,c){var d,e,g,h,i;return null==c&&(c={}),d=Object.keys(b),g=null!=c?Object.keys(c):{},h=f.intersection(d,g),i=f.difference(d,g),e=f.difference(g,d),f.each(h,function(d){if(null!=a.formats.SELECT[d])if(Array.isArray(b[d])){if(b[d].indexOf(c[d])<0)return b[d].push(c[d])}else if(b[d]!==c[d])return b[d]=[b[d],c[d]]}),f.each(i,function(c){return null!=a.formats.TOGGLE[c]?delete b[c]:null==a.formats.SELECT[c]||Array.isArray(b[c])?void 0:b[c]=[b[c]]}),f.each(e,function(d){return null!=a.formats.SELECT[d]?b[d]=[c[d]]:void 0}),b},b[0]||{})},a}(),d.registerModule("toolbar",e),b.exports=e},{"../quill":33}],31:[function(a,b,c){var d,e,f,g;d=a("../quill"),f=d.require("lodash"),g=d.require("dom"),e=function(){function a(b,c){this.quill=b,this.options=c,this.container=this.quill.addContainer("ql-tooltip"),this.container.innerHTML=this.options.template,this.hide(),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(b){return function(c,d){return b.container.style.left!==a.HIDE_MARGIN?(b.range=null,b.hide()):void 0}}(this))}return a.DEFAULTS={offset:10,template:""},a.HIDE_MARGIN="-10000px",a.prototype.initTextbox=function(a,b,c){return g(a).on("keydown",function(a){return function(d){switch(d.which){case g.KEYS.ENTER:return d.preventDefault(),b.call(a);case g.KEYS.ESCAPE:return d.preventDefault(),c.call(a);default:return!0}}}(this))},a.prototype.hide=function(){return this.container.style.left=a.HIDE_MARGIN,this.range&&this.quill.setSelection(this.range),this.range=null},a.prototype.position=function(a){var b,c,d,e,f,g,h;return null!=a?(g=a.getBoundingClientRect(),f=this.quill.container.getBoundingClientRect(),d=g.left-f.left,e=g.top-f.top,c=g.bottom-f.bottom,b=d+g.width/2-this.container.offsetWidth/2,h=e+g.height+this.options.offset,h+this.container.offsetHeight>this.quill.container.offsetHeight&&(h=e-this.container.offsetHeight-this.options.offset),b=Math.max(0,Math.min(b,this.quill.container.offsetWidth-this.container.offsetWidth)),h=Math.max(0,Math.min(h,this.quill.container.offsetHeight-this.container.offsetHeight))):(b=this.quill.container.offsetWidth/2-this.container.offsetWidth/2,h=this.quill.container.offsetHeight/2-this.container.offsetHeight/2),h+=this.quill.container.scrollTop,[b,h]},a.prototype.show=function(a){var b,c,d;return this.range=this.quill.getSelection(),c=this.position(a),b=c[0],d=c[1],this.container.style.left=b+"px",this.container.style.top=d+"px",this.container.focus()},a}(),d.registerModule("tooltip",e),b.exports=e},{"../quill":33}],32:[function(a,b,c){var d,e,f,g;e=a("../quill"),g=e.require("lodash"),d=e.require("delta"),f=function(){function a(a,b){this.quill=a,this.options=null!=b?b:{},this.lastRecorded=0,this.ignoreChange=!1,this.clear(),this.initListeners()}return a.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1},a.hotkeys={UNDO:{key:"Z",metaKey:!0},REDO:{key:"Z",metaKey:!0,shiftKey:!0}},a.prototype.initListeners=function(){return this.quill.onModuleLoad("keyboard",function(b){return function(c){var d;return c.addHotkey(a.hotkeys.UNDO,function(){return b.quill.editor.checkUpdate(),b.undo(),!1}),d=[a.hotkeys.REDO],navigator.platform.indexOf("Win")>-1&&d.push({key:"Y",metaKey:!0}),c.addHotkey(d,function(){return b.quill.editor.checkUpdate(),b.redo(),!1})}}(this)),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(a){return function(b,c){return a.ignoreChange?void 0:(a.options.userOnly&&c!==e.sources.USER?a._transform(b):a.record(b,a.oldDelta),a.oldDelta=a.quill.getContents())}}(this))},a.prototype.clear=function(){return this.stack={undo:[],redo:[]},this.oldDelta=this.quill.getContents()},a.prototype.record=function(a,b){var c,d,e,f;if(a.ops.length>0){this.stack.redo=[];try{if(f=this.quill.getContents().diff(this.oldDelta),e=(new Date).getTime(),this.lastRecorded+this.options.delay>e&&this.stack.undo.length>0?(c=this.stack.undo.pop(),f=f.compose(c.undo),a=c.redo.compose(a)):this.lastRecorded=e,this.stack.undo.push({redo:a,undo:f}),this.stack.undo.length>this.options.maxStack)return this.stack.undo.unshift()}catch(g){return d=g,console.warn("Could not record change... clearing undo stack."),this.clear()}}},a.prototype.redo=function(){return this._change("redo","undo")},a.prototype.undo=function(){return this._change("undo","redo")},a.prototype._getLastChangeIndex=function(a){var b,c;return c=0,b=0,g.each(a.ops,function(a){return null!=a.insert?c=Math.max(b+(a.insert.length||1),c):null!=a["delete"]?c=Math.max(b,c):null!=a.retain?(null!=a.attributes&&(c=Math.max(b+a.retain,c)),b+=a.retain):void 0}),c},a.prototype._change=function(a,b){var c,d;return this.stack[a].length>0?(c=this.stack[a].pop(),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(c[a],e.sources.USER),this.ignoreChange=!1,d=this._getLastChangeIndex(c[a]),this.quill.setSelection(d,d),this.oldDelta=this.quill.getContents(),this.stack[b].push(c)):void 0},a.prototype._transform=function(a){var b,c,d,e,f,g,h,i;for(this.oldDelta=a.transform(this.oldDelta,!0),g=this.stack.undo,c=0,e=g.length;e>c;c++)b=g[c],b.undo=a.transform(b.undo,!0),b.redo=a.transform(b.redo,!0);for(h=this.stack.redo,i=[],d=0,f=h.length;f>d;d++)b=h[d],b.undo=a.transform(b.undo,!0),i.push(b.redo=a.transform(b.redo,!0));return i},a}(),e.registerModule("undo-manager",f),b.exports=f},{"../quill":33}],33:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p={}.hasOwnProperty,q=[].slice;l=a("lodash"),n=a("../package.json"),d=a("rich-text/lib/delta"),g=a("eventemitter2").EventEmitter2,m=a("./lib/dom"),e=a("./core/document"),f=a("./core/editor"),h=a("./core/format"),i=a("./core/normalizer"),k=a("./lib/range"),j=function(a){function b(a,c){var d,e,g;if(this.container=a,null==c&&(c={}),l.isString(this.container)&&(this.container=document.querySelector(this.container)),null==this.container)throw new Error("Invalid Quill container");if(e=l.defaults(c.modules||{},b.DEFAULTS.modules),d=this.container.innerHTML,this.container.innerHTML="",this.options=l.defaults(c,b.DEFAULTS),this.options.modules=e,this.options.id=this.id="ql-editor-"+(b.editors.length+1),this.modules={},this.root=this.addContainer("ql-editor"),this.editor=new f(this.root,this,this.options),b.editors.push(this),this.setHTML(d,b.sources.SILENT),g=b.themes[this.options.theme],null==g)throw new Error("Cannot load "+this.options.theme+" theme. Are you sure you registered it?");this.theme=new g(this,this.options),l.each(this.options.modules,function(a){return function(b,c){return a.addModule(c,b)}}(this))}return o(b,a),b.version=n.version,b.editors=[],b.modules=[],b.themes=[],b.DEFAULTS={formats:["align","bold","italic","strike","underline","color","background","font","size","link","image","bullet","list","media","record"],modules:{keyboard:!0,"paste-manager":!0,"undo-manager":!0},pollInterval:100,readOnly:!1,styles:{},theme:"base"},b.events={FORMAT_INIT:"format-init",MODULE_INIT:"module-init",POST_EVENT:"post-event",PRE_EVENT:"pre-event",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources=f.sources,b.registerModule=function(a,c){return null!=b.modules[a]&&console.warn("Overwriting "+a+" module"),b.modules[a]=c},b.registerTheme=function(a,c){return null!=b.themes[a]&&console.warn("Overwriting "+a+" theme"),b.themes[a]=c},b.require=function(a){switch(a){case"lodash":return l;case"delta":return d;case"format":return h;case"normalizer":return i;case"dom":return m;case"document":return e;case"range":return k;default:return null}},b.prototype.destroy=function(){var a;return a=this.getHTML(),l.each(this.modules,function(a,b){return l.isFunction(a.destroy)?a.destroy():void 0}),this.editor.destroy(),this.removeAllListeners(),b.editors.splice(l.indexOf(b.editors,this),1),this.container.innerHTML=a},b.prototype.addContainer=function(a,b){var c,d;return null==b&&(b=!1),d=b?this.root:null,c=document.createElement("div"),m(c).addClass(a),this.container.insertBefore(c,d),c},b.prototype.addFormat=function(a,c){return this.editor.doc.addFormat(a,c),this.emit(b.events.FORMAT_INIT,a)},b.prototype.addModule=function(a,c){var d;if(d=b.modules[a],null==d)throw new Error("Cannot load "+a+" module. Are you sure you registered it?");return c===!0&&(c={}),c=l.defaults(c,this.theme.constructor.OPTIONS[a]||{},d.DEFAULTS||{}),this.modules[a]=new d(this,c),this.emit(b.events.MODULE_INIT,a,this.modules[a]),this.modules[a]},b.prototype.deleteText=function(a,c,e){var f,g,h;return null==e&&(e=b.sources.API),h=this._buildParams(a,c,{},e),a=h[0],c=h[1],g=h[2],e=h[3],c>a?(f=(new d).retain(a)["delete"](c-a),this.editor.applyDelta(f,e)):void 0},b.prototype.emit=function(){var a,c;return c=arguments[0],a=2<=arguments.length?q.call(arguments,1):[],b.__super__.emit.apply(this,[b.events.PRE_EVENT,c].concat(q.call(a))),b.__super__.emit.apply(this,[c].concat(q.call(a))),
b.__super__.emit.apply(this,[b.events.POST_EVENT,c].concat(q.call(a)))},b.prototype.focus=function(){return this.editor.focus()},b.prototype.formatLine=function(a,b,c,d,e){var f,g,h,i,j;return i=this._buildParams(a,b,c,d,e),a=i[0],b=i[1],f=i[2],e=i[3],j=this.editor.doc.findLineAt(b),g=j[0],h=j[1],null!=g&&(b+=g.length-h),this.formatText(a,b,f,e)},b.prototype.formatText=function(a,b,c,e,f){var g,h,i;return i=this._buildParams(a,b,c,e,f),a=i[0],b=i[1],h=i[2],f=i[3],h=l.reduce(h,function(a){return function(b,c,d){var e;return e=a.editor.doc.formats[d],c&&c!==e.config["default"]||(b[d]=null),b}}(this),h),g=(new d).retain(a).retain(b-a,h),this.editor.applyDelta(g,f)},b.prototype.getBounds=function(a){return this.editor.getBounds(a)},b.prototype.getContents=function(a,b){return null==a&&(a=0),null==b&&(b=null),l.isObject(a)&&(b=a.end,a=a.start),this.editor.delta.slice(a,b)},b.prototype.getHTML=function(){return this.editor.doc.getHTML()},b.prototype.getLength=function(){return this.editor.length},b.prototype.getModule=function(a){return this.modules[a]},b.prototype.getSelection=function(){return this.editor.checkUpdate(),this.editor.selection.getRange()},b.prototype.getText=function(a,b){return null==a&&(a=0),null==b&&(b=null),l.map(this.getContents(a,b).ops,function(a){return l.isString(a.insert)?a.insert:""}).join("")},b.prototype.insertEmbed=function(a,b,c,e){var f,g,h,i;return i=this._buildParams(a,0,b,c,e),a=i[0],g=i[1],h=i[2],e=i[3],f=(new d).retain(a).insert(1,h),this.editor.applyDelta(f,e)},b.prototype.insertText=function(a,b,c,e,f){var g,h,i,j;return j=this._buildParams(a,0,c,e,f),a=j[0],h=j[1],i=j[2],f=j[3],b.length>0?(g=(new d).retain(a).insert(b,i),this.editor.applyDelta(g,f)):void 0},b.prototype.onModuleLoad=function(a,c){return this.modules[a]?c(this.modules[a]):this.on(b.events.MODULE_INIT,function(b,d){return b===a?c(d):void 0})},b.prototype.prepareFormat=function(a,c,d){var e,f;return null==d&&(d=b.sources.API),e=this.editor.doc.formats[a],null!=e&&(f=this.getSelection(),null!=f?f.isCollapsed():void 0)?e.isType(h.types.LINE)?this.formatLine(f,a,c,d):e.prepare(c):void 0},b.prototype.setContents=function(a,c){var e;return null==c&&(c=b.sources.API),a=new d(Array.isArray(a)?a.slice():a.ops.slice()),e=l.last(a.slice(a.length()-1).ops),a["delete"](this.getLength()-1),null!=e&&l.isString(e.insert)&&"\n"===l.last(e.insert)&&a["delete"](1),this.updateContents(a,c)},b.prototype.setHTML=function(a,c){return null==c&&(c=b.sources.API),a.trim()||(a="<"+m.DEFAULT_BLOCK_TAG+"><"+m.DEFAULT_BREAK_TAG+"></"+m.DEFAULT_BLOCK_TAG+">"),this.editor.doc.setHTML(a),this.editor.checkUpdate(c)},b.prototype.setSelection=function(a,c,d){var e;return null==d&&(d=b.sources.API),l.isNumber(a)&&l.isNumber(c)?e=new k(a,c):(e=a,d=c||d),this.editor.selection.setRange(e,d)},b.prototype.setText=function(a,c){var e;return null==c&&(c=b.sources.API),e=(new d).insert(a),this.setContents(e,c)},b.prototype.updateContents=function(a,c){return null==c&&(c=b.sources.API),Array.isArray(a)&&(a={ops:a}),this.editor.applyDelta(a,c)},b.prototype._buildParams=function(){var a,c;return c=1<=arguments.length?q.call(arguments,0):[],l.isObject(c[0])&&c.splice(0,1,c[0].start,c[0].end),l.isString(c[2])&&(a={},a[c[2]]=c[3],c.splice(2,2,a)),null==c[3]&&(c[3]=b.sources.API),c},b}(g),j.registerTheme("base",a("./themes/base")),j.registerTheme("snow",a("./themes/snow")),b.exports=j},{"../package.json":8,"./core/document":9,"./core/editor":10,"./core/format":11,"./core/normalizer":14,"./lib/dom":18,"./lib/range":21,"./themes/base":35,"./themes/snow":36,eventemitter2:3,lodash:1,"rich-text/lib/delta":4}],34:[function(a,b,c){b.exports='.ql-image-tooltip{padding:10px;width:300px}.ql-image-tooltip:after{clear:both;content:"";display:table}.ql-image-tooltip a{border:1px solid #000;box-sizing:border-box;display:inline-block;float:left;padding:5px;text-align:center;width:50%}.ql-image-tooltip img{bottom:0;left:0;margin:auto;max-height:100%;max-width:100%;position:absolute;right:0;top:0}.ql-image-tooltip .input{box-sizing:border-box;width:100%}.ql-image-tooltip .preview{margin:10px 0;position:relative;border:1px dashed #000;height:200px}.ql-image-tooltip .preview span{display:inline-block;position:absolute;text-align:center;top:40%;width:100%}.ql-link-tooltip{padding:5px 10px}.ql-link-tooltip input.input{width:170px}.ql-link-tooltip a.done,.ql-link-tooltip input.input{display:none}.ql-link-tooltip a.change{margin-right:4px}.ql-link-tooltip.editing a.done,.ql-link-tooltip.editing input.input{display:inline-block}.ql-link-tooltip.editing a.change,.ql-link-tooltip.editing a.remove,.ql-link-tooltip.editing a.url{display:none}.ql-media-tooltip{padding:10px;width:300px}.ql-media-tooltip:after{clear:both;content:"";display:table}.ql-media-tooltip a{border:1px solid #000;box-sizing:border-box;display:inline-block;float:left;padding:5px;text-align:center;width:50%}.ql-media-tooltip iframe{bottom:0;left:0;margin:auto;max-height:100%;max-width:100%;position:absolute;right:0;top:0}.ql-media-tooltip .input{box-sizing:border-box;width:100%}.ql-media-tooltip .preview{margin:10px 0;position:relative;border:1px dashed #000;height:200px}.ql-media-tooltip .preview span{display:inline-block;position:absolute;text-align:center;top:40%;width:100%}.ql-multi-cursor{position:absolute;left:0;top:0;z-index:1000}.ql-multi-cursor .cursor{margin-left:-1px;position:absolute}.ql-multi-cursor .cursor-flag{bottom:100%;position:absolute;white-space:nowrap}.ql-multi-cursor .cursor-name{display:inline-block;color:#fff;padding:2px 8px}.ql-multi-cursor .cursor-caret{height:100%;position:absolute;width:2px}.ql-multi-cursor .cursor.hidden .cursor-flag{display:none}.ql-multi-cursor .cursor.top .cursor-flag{bottom:auto;top:100%}.ql-multi-cursor .cursor.right .cursor-flag{right:-2px}.ql-paste-manager{left:-100000px;position:absolute;top:50%}.ql-toolbar{box-sizing:border-box}.ql-tooltip{background-color:#fff;border:1px solid #000;box-sizing:border-box;position:absolute;top:0;white-space:nowrap;z-index:2000}.ql-tooltip a{cursor:pointer;text-decoration:none}.ql-container{box-sizing:border-box;cursor:text;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;line-height:1.42;margin:0;overflow-x:hidden;overflow-y:auto;padding:12px 15px;position:relative}.ql-editor{box-sizing:border-box;min-height:100%;outline:0;tab-size:4;white-space:pre-wrap}.ql-editor div{margin:0;padding:0}.ql-editor a{text-decoration:underline}.ql-editor b{font-weight:700}.ql-editor i{font-style:italic}.ql-editor s{text-decoration:line-through}.ql-editor u{text-decoration:underline}.ql-editor a,.ql-editor b,.ql-editor i,.ql-editor s,.ql-editor span,.ql-editor u{background-color:inherit}.ql-editor img{max-width:100%}.ql-editor blockquote,.ql-editor ol,.ql-editor ul{margin:0 0 0 2em;padding:0}.ql-editor ol{list-style-type:decimal}.ql-editor ul{list-style-type:disc}.ql-editor iframe{max-width:100%}.ql-editor.ql-ie-10 br,.ql-editor.ql-ie-9 br{display:none}'},{}],35:[function(a,b,c){var d,e,f,g;e=a("lodash"),g=a("../../lib/dom"),f=a("./base.styl"),d=function(){function a(b,c){var d;this.quill=b,this.options=c,g(this.quill.container).addClass("ql-container"),this.options.styles&&this.addStyles(f+a.objToCss(this.options.styles)),g.isIE(10)&&(d=g.isIE(9)?"9":"10",g(this.quill.root).addClass("ql-ie-"+d))}return a.OPTIONS={},a.objToCss=function(a){return e.map(a,function(a,b){var c;return c=e.map(a,function(a,b){return b+": "+a+";"}).join(" "),b+" { "+c+" }"}).join("\n")},a.prototype.addStyles=function(b){var c;return e.isObject(b)&&(b=a.objToCss(b)),c=document.createElement("style"),c.type="text/css",c.appendChild(document.createTextNode(b)),document.head.appendChild(c)},a}(),b.exports=d},{"../../lib/dom":18,"./base.styl":34,lodash:1}],36:[function(a,b,c){var d,e,f,g,h,i,j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;h=a("lodash"),e=a("../../lib/color-picker"),d=a("../base"),i=a("../../lib/dom"),f=a("../../lib/picker"),g=function(a){function b(a,c){this.quill=a,this.options=c,b.__super__.constructor.apply(this,arguments),i(this.quill.container).addClass("ql-snow"),this.pickers=[],this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?h.invoke(a.pickers,"close"):void 0}}(this)),this.quill.onModuleLoad("multi-cursor",h.bind(this.extendMultiCursor,this)),this.quill.onModuleLoad("toolbar",h.bind(this.extendToolbar,this))}return j(b,a),b.COLORS=["#000000","#e60000","#ff9900","#ffff00","#008A00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],b.OPTIONS={"multi-cursor":{template:'<span class="cursor-flag"> <span class="cursor-triangle top"></span> <span class="cursor-name"></span> <span class="cursor-triangle bottom"></span> </span> <span class="cursor-caret"></span>'}},b.prototype.extendMultiCursor=function(a){return a.on(a.constructor.events.CURSOR_ADDED,function(a){var b,c;return b=a.elem.querySelector(".cursor-triangle.bottom"),c=a.elem.querySelector(".cursor-triangle.top"),b.style.borderTopColor=c.style.borderBottomColor=a.color})},b.prototype.extendToolbar=function(a){return i(a.container).addClass("ql-snow"),h.each(["color","background","font","size","align"],function(b){return function(c){var d,g;if(g=a.container.querySelector(".ql-"+c),null!=g){switch(c){case"font":case"size":case"align":d=new f(g);break;case"color":case"background":d=new e(g),h.each(d.container.querySelectorAll(".ql-picker-item"),function(a,b){return 7>b?i(a).addClass("ql-primary-color"):void 0})}return null!=d?b.pickers.push(d):void 0}}}(this)),h.each(i(a.container).textNodes(),function(a){return 0===i(a).text().trim().length?i(a).remove():void 0})},b}(d),b.exports=g},{"../../lib/color-picker":17,"../../lib/dom":18,"../../lib/picker":20,"../base":35,lodash:1}]},{},[16])(16)});